{"version":3,"file":"alei.user.js","mappings":"0DAAA,SAASA,EAASC,GACd,IAAIC,EAAS,EAMb,QAJMC,MAAMC,OAAOH,KAAiB,MAARA,GAAuB,KAAPA,KACxCC,EAAS,GAGNA,CACX,CAEA,SAASG,EAAWJ,GAChB,MAAO,eAAeK,SAASL,EACnC,CAEA,SAASM,EAAQN,GACb,MAAO,KAAKK,SAASL,EACzB,CAyDA,SAASO,EAAcP,GACnB,IAAIQ,EAAQ,EAcZ,MAZI,KAAKH,SAASL,KACdQ,EAAQ,GAGR,MAAMH,SAASL,KACfQ,EAAQ,GAGR,UAAUH,SAASL,KACnBQ,EAAQ,GAGLA,CACX,CA4EA,SAASC,EAAKC,EAAGC,EAAGC,GAChB,IAAIC,EAyDJ,OAvDAH,EAAIP,OAAOO,GACXE,EAAIT,OAAOS,GAEF,KAALD,IACAE,EAASH,EAAIE,GAGR,KAALD,IACAE,EAASH,EAAIE,GAGR,KAALD,IACAE,EAASH,EAAIE,GAGR,KAALD,IACAE,EAASH,EAAIE,GAGR,KAALD,IACAE,EAASH,EAAIE,GAGR,KAALD,IACAE,EAASH,GAAKE,GAGT,KAALD,IACAE,EAASC,KAAKC,IAAIL,GAAKE,GAGlB,KAALD,IACAE,EAASC,KAAKE,IAAIN,GAAKE,GAGlB,KAALD,IACAE,EAASC,KAAKG,MAAMP,EAAGE,IAGlB,KAALD,IAEIE,EADAD,EACSE,KAAKI,MAAMJ,KAAKK,SAAWT,GAE3BI,KAAKK,SAAWT,GAIxB,KAALC,IACAE,EAASC,KAAKM,MAAMV,EAAIE,GAAKA,GAGxB,KAALD,IACAE,EAASC,KAAKI,MAAMR,EAAIE,GAAKA,GAG1BC,CACX,CA2FO,SAASQ,EAAMrB,EAAKsB,GACZ,IAAPtB,IACAA,EAAM,KAGI,KAAVA,EAAI,KACJA,EAAM,IAAMA,GA3SpB,SAAuBA,GACnB,IAAIuB,EAAM,GAEV,IAAK,IAAIC,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IACxBzB,EAASC,EAAIwB,IACbD,GAAOvB,EAAIwB,GACU,GAAdD,EAAIE,SACXzB,EAAI0B,OAAOF,EAAID,EAAIE,OAAQF,EAAIE,OAAQF,GACvCC,GAAMD,EAAIE,OAAS,EACnBF,EAAM,IAII,GAAdA,EAAIE,QACJzB,EAAI0B,OAAO1B,EAAIyB,OAASF,EAAIE,OAAQF,EAAIE,OAAQF,EAExD,CA+RII,CADA3B,EAlTJ,SAAeA,GACX,OAAOA,EAAI4B,WAAW,IAAK,IAAIC,MAAM,GACzC,CAgTUA,CAAM7B,IAnChB,SAAiBA,EAAK8B,GAClB,IAAK,IAAIN,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IAC5B,IAAK,IAAIO,EAAI,EAAGA,EAAID,EAAIL,OAAQM,IACxB/B,EAAIwB,IAAMM,EAAIC,GAAGC,OACjBhC,EAAIwB,GAAKM,EAAIC,GAAGE,GAIhC,CA8BIC,CAAQlC,EAAK,CACT,CACIgC,KAAM,IACNC,GAAIE,OAAOrB,KAAKsB,KAGpB,CACIJ,KAAM,IACNC,GAAIE,OAAOb,EAAK,KAGpB,CACIU,KAAM,IACNC,GAAIE,OAAOb,EAAK,KAGpB,CACIU,KAAM,IACNC,GAAIE,OAAOb,EAAK,KAGpB,CACIU,KAAM,IACNC,GAAIE,OAAOb,EAAK,KAGpB,CACIU,KAAM,IACNC,GAAIE,OAAOb,EAAK,OAIxB,KA5DJ,SAAyBtB,GACrB,IAAK,IAAIwB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IACd,KAAVxB,EAAIwB,IAA2B,KAAdxB,EAAIwB,EAAI,IACzBxB,EAAI0B,OAAOF,EAAG,EAAG,IAG7B,CAuDQa,CAAgBrC,GArDxB,SAAsBA,GAClB,IAAK,IAAIwB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IACV,KAAdxB,EAAIwB,EAAI,IAA2B,KAAdxB,EAAIwB,EAAI,IAC7BxB,EAAI0B,OAAOF,EAAG,EAAG,IAAK,IAGlC,CAgDQc,CAAatC,GAjUrB,SAA0BA,GACtB,IAAK,IAAIwB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IAC5BxB,EAAIwB,GAAK,CACLe,IAAKvC,EAAIwB,GAGrB,CA4TQgB,CAAiBxC,GA1TzB,SAA2BA,GACvB,IAAIQ,EAAQ,EAEZ,IAAK,IAAIgB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IACV,KAAdxB,EAAIwB,GAAGe,KACP/B,IAGc,KAAdR,EAAIwB,GAAGe,KACP/B,IAGJR,EAAIwB,GAAGiB,WAAajC,CAE5B,CA6SQkC,CAAkB1C,GA3S1B,SAA0BA,GACtB,IAAK,IAAIwB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IACxBlB,EAAQN,EAAIwB,GAAGe,OACfvC,EAAI0B,OAAOF,EAAG,GACdA,IAGZ,CAqSQmB,CAAiB3C,GAjRzB,SAA8BA,GAC1B,IAAK,IAAIwB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IAC5B,GAAIpB,EAAWJ,EAAIwB,GAAGe,KAAM,CACxB,IAAI/B,EAAQD,EAAcP,EAAIwB,GAAGe,KAEjCvC,EAAIwB,GAAGjB,cAAgBC,EAEnBR,EAAIwB,EAAI,GAAGiB,YAAczC,EAAIwB,GAAGiB,aAChCzC,EAAIwB,EAAI,GAAGjB,cAAgBC,KAG1BR,EAAIwB,EAAI,GAAGjB,eAAkBP,EAAIwB,EAAI,GAAGjB,cAAgBP,EAAIwB,GAAGjB,eAAiBP,EAAIwB,EAAI,GAAGiB,YAAczC,EAAIwB,GAAGiB,cACjHzC,EAAIwB,EAAI,GAAGjB,cAAgBC,EAEnC,CAER,CAkQQoC,CAAqB5C,GAhQ7B,SAAsBA,GAClB,IAAK,IAAIwB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IAC5BxB,EAAIwB,GAAGhB,MAA4B,GAApBR,EAAIwB,GAAGiB,WAAkBzC,EAAIwB,GAAGjB,aAEvD,CA6PQsC,CAAa7C,GAtNrB,SAAuBA,GACnB,IAAI8C,EAtCR,SAAmB9C,GACf,IAAI8C,EAAS,GAEb,IAAK,IAAItB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IAC5BsB,EAAOC,KAAK/C,EAAIwB,GAAGhB,OAGvB,OAAOsC,CACX,CA8BiBE,CAAUhD,GACnB8B,EA7BR,SAAwBgB,GACpB,IAAIhB,EAAM,GACNtB,EAAQ,EAEZsC,EAAOG,MAAK,CAACvC,EAAGC,IACLA,EAAID,IAGfoB,EAAIiB,KAAK,CACLf,KAAMc,EAAO,GACbb,GAAIzB,IAGR,IAAK,IAAIgB,EAAI,EAAGA,EAAIsB,EAAOrB,OAAQD,IAC3BsB,EAAOtB,IAAMsB,EAAOtB,EAAI,IACxBhB,IAGJsB,EAAIiB,KAAK,CACLf,KAAMc,EAAOtB,GACbS,GAAIzB,IAIZ,OAAOsB,CACX,CAIcoB,CAAeJ,GAEzB,IAAK,IAAItB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IAC5B,IAAK,IAAIO,EAAI,EAAGA,EAAID,EAAIL,OAAQM,IACxB/B,EAAIwB,GAAGhB,OAASsB,EAAIC,GAAGC,OACvBhC,EAAIwB,GAAGhB,MAAQsB,EAAIC,GAAGE,GAItC,CA4MQkB,CAAcnD,GAjItB,SAAcA,GACV,IAAIoD,EAbR,SAAqBpD,GACjB,IAAIQ,EAAQ,EAEZ,IAAK,IAAIgB,EAAI,EAAGA,EAAIxB,EAAIyB,OAAQD,IACxBxB,EAAIwB,GAAGhB,MAAQA,IACfA,EAAQR,EAAIwB,GAAGhB,OAIvB,OAAOA,CACX,CAGmB6C,CAAYrD,GAE3B,IAAK,IAAIQ,EAAQ,EAAGA,GAAS4C,EAAU5C,IAAS,CAC5C,IAAIgB,EAAI,EACJ8B,EAAO,EAEX,KAAOA,GAAM,CACTA,EAAO,EAEP,IACI7B,EACA8B,EAFAC,EAAS,GAGTC,GAAS,EAEb,KAAOjC,EAAIxB,EAAIyB,OAAQD,IACnB,GAAIxB,EAAIwB,GAAGhB,OAASA,EAChBgD,EAAOT,KAAK/C,EAAIwB,KAEF,GAAViC,IACAA,EAAQjC,QAET,GAAqB,GAAjBgC,EAAO/B,OAAa,CAC3B6B,EAAO,EACP,KACJ,CAKJ,GAFA7B,EAAS+B,EAAO/B,OAEZA,EAAQ,CACR,KAAwB,GAAjB+B,EAAO/B,QACV+B,EAAO9B,OAAO,EAAG,EAAG,CAChBa,IAAK9B,EAAK+C,EAAO,GAAGjB,IAAKiB,EAAO,GAAGjB,IAAKiB,EAAO,GAAGjB,OAI1DgB,EAAYvD,EAAIyD,GAAOjD,MAEvBR,EAAI0B,OAAO+B,EAAOhC,EAAQ+B,EAAO,IACjChC,GAAMC,EAAS,EAEfzB,EAAIyD,GAAS,CACTlB,IAAKvC,EAAIyD,GAAOlB,IAChB/B,MAAO+C,EAAY,EAE3B,CACJ,CACJ,CACJ,CAiFQG,CAAK1D,EACT,CAAE,MACE,MAAO,OACX,CAEA,OAAOG,OAAOA,OAAOH,EAAI,GAAGuC,KAAKoB,QAAQ,IAC7C,C,mBCrXIC,yBAA2B,CAAC,EAGhC,SAASC,oBAAoBC,GAE5B,IAAIC,EAAeH,yBAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,yBAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,oBAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,qBAG/CK,EAAOD,OACf,CCrBAJ,oBAAoBO,EAAI,CAACH,EAASI,KACjC,IAAI,IAAIC,KAAOD,EACXR,oBAAoBU,EAAEF,EAAYC,KAAST,oBAAoBU,EAAEN,EAASK,IAC5EE,OAAOC,eAAeR,EAASK,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDT,oBAAoBU,EAAI,CAACK,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,G,+FCElF,IAAII,OAASC,aACTC,SACJ,IACIC,QACAD,UAAW,EACXF,OAA0B,mBAAI,CAClC,CAAE,MAAOI,GAAIF,UAAW,CAAK,CAQ7B,SAASG,IAAIC,GACT,OAAOC,SAASC,eAAeF,EACnC,CACA,SAASG,OAAOC,GACZ,OAAOH,SAASI,cAAcD,EAClC,CAXIR,UAA4C,GAA/BF,OAA0B,mBAEvCY,sCAWJ,IAAIC,aAAeN,SAASO,gBACxBC,YAAcR,SAASS,YACvBC,UAAY,CAAC,EACbC,+BAAgC,EAChCC,wBAEJ,MAAMC,KAAO,EACPC,MAAQ,EACRC,OAAS,EACTC,MAAQ,EAGRC,WAAa,OACbC,SAAW,QACXC,UAAY,QACZC,YAAc,QACdC,WAAa,QACbC,UAAY,QAElB,SAASC,YAAYzC,EAAK0C,EAAcC,GAEpC,YAAYjD,IADFkD,aAAa5C,GACO0C,EACvBC,EAAKC,aAAa5C,GAC7B,CAEyCN,MAArCkD,aAAgC,oBAChCA,aAAmC,qBAAIA,aAAgC,kBACvEA,aAAaC,WAAW,sBAG5B,IAAIC,aAAe,CACfC,eAAoBN,YAAY,uBAA0B,QAAUO,GAAQA,IAC5EC,oBAAoBR,YAAY,oBAA0B,QAAUO,GAAQA,EAAM,OAClFE,WAAoBT,YAAY,iBAAqB,cAAeO,GAAQA,IAC5EG,SAAoBV,YAAY,gBAA6B,EAAOW,UACpEC,eAAoBZ,YAAY,uBAA6B,GAAQO,GAAgB,SAARA,IAC7EM,eAAoBb,YAAY,qBAA6B,GAAQO,GAAgB,SAARA,IAC7EO,mBAAoBd,YAAY,2BAA6B,GAAQO,GAAgB,SAARA,IAC7EQ,WAAoBf,YAAY,iBAA6B,GAAQO,GAAgB,SAARA,IAC7ES,QAAoBhB,YAAY,gBAA6B,GAAQO,GAAgB,SAARA,IAC7EU,WAAoBjB,YAAY,mBAA6B,GAAQO,GAAgB,SAARA,IAC7EW,oBAAoBlB,YAAY,4BAA6B,GAAQO,GAAgB,SAARA,IAC7EY,WAAoBnB,YAAY,mBAA6B,GAAQO,GAAgB,SAARA,IAC7Ea,kBAAoBpB,YAAY,0BAA6B,GAAQO,GAAgB,SAARA,IAC7Ec,mBAAoBrB,YAAY,2BAA6B,GAAQO,GAAgB,SAARA,KAIjF,SAASe,aAAa/D,EAAKgE,GACvB,IACIpB,aAAa5C,GAAOgE,CACxB,CAAE,MAAOjD,GACLkD,QAAQ,8FAA+FC,UACvGC,QAAQC,MAAMrD,EAClB,CACJ,CATAJ,OAAOmC,aAAeA,aAWtB,IAAIuB,eAAiB,CACjB,EAAG,GAAG7B,gBAAgBL,aACtB,EAAG,GAAGI,kBAAkBJ,aACxB,EAAG,GAAGI,mBAAmBJ,cAG7B,SAASmC,QAAQC,EAAOC,GAChBD,IAAUrC,MACViC,QAAQM,KAAK,mBAAmBD,KAChCP,QAAQ,8BAA+B,YACjCM,GAASzB,aAAaK,UAC5BgB,QAAQO,IAAI,IAAInC,kBAAkB8B,eAAeE,QAAYC,IACrE,CACAF,QAAQvC,KAAM,kBAId,IAAI4C,cAAgBhE,OAAOiE,WACvBC,QAAUlE,OAAOmE,KACjBC,WAEAC,cAAgB,KAChBC,gBAAkB,GAEtB,SAASC,mBAEL,SAASC,EAAInF,EAAKoF,EAAMC,EAAMC,GAC1BC,WAAWA,WAAWpI,QAAU,CAAC6C,EAAKoF,EAAMC,EAAM,GAAIC,EAC1D,CAEAH,EAAI,SAAU,OAAQ,aAAc,QACpCA,EAAI,OAAQ,QAAS,WAAY,QACjCA,EAAI,OAAQ,QAAS,WAAY,QAEjCA,EAAI,OAAQ,QAAS,KAAM,KAC3BA,EAAI,WAAY,QAAS,UAAW,KACpCA,EAAI,UAAW,OAAQ,qBAAsB,WAC7CA,EAAI,aAAc,OAAQ,eAAgB,UAC1CA,EAAI,OAAQ,SAAU,mBAAoB,SAC1CA,EAAI,SAAU,YAAa,YAAa,SAExCI,WAAW,GAAK,CAAC,MAAO,SAAU,OAAQ,cAAe,KAGzD,IAAI,IAAIrI,EAAI,EAAGA,EAAIqI,WAAWpI,OAAQD,IAAK,CACvC,IAAIsI,EAAQD,WAAWrI,GACnB8C,EAAMwF,EAAM,GACZnE,EAAWmE,EAAM,GAEV,cAAPxF,GAAqC,UAAZqB,IACzBS,wBAA0B5E,EAElC,CACA0E,UAAU,cAAgB,IAAI6D,MAC9B7D,UAAU,eAAe,GAAK,eAC9BA,UAAU,cAAc,YAAc,OAC1C,CAEA,SAAS8D,eAEL,IAAIC,EAAO/D,UAAiB,MAC5B+D,EAAc,QAAI,kBAClBA,EAAc,QAAI,mBAClBA,EAAmB,aAAI,iBACvBA,EAAoB,cAAI,gBACxBA,EAAwB,kBAAI,mBAC5BA,EAAmB,aAAI,gBACvBA,EAAkB,YAAI,gBACtBA,EAAkB,YAAI,iBACtBA,EAAkB,YAAI,iBACtBA,EAAqB,eAAI,oBACzBA,EAAqB,eAAI,oBACzBA,EAAqB,eAAI,oBACzBA,EAAoB,cAAI,qCACxBA,EAAY,MAAI,eAChBA,EAAqB,eAAI,aACzBA,EAAgB,UAAI,iBACpBA,EAAe,SAAI,aACnBA,EAAoB,cAAI,oBACxBA,EAAkB,YAAI,yBACtBA,EAAkC,4BAAI,qBACtCA,EAAmC,6BAAI,sBACvCA,EAAiC,2BAAI,oBACrCA,EAAwB,kBAAI,kBAC5BA,EAAwB,kBAAI,kBAC5BA,EAAwB,kBAAI,kBAC5BA,EAAwB,kBAAI,kBAC5BA,EAAwB,kBAAI,kBAC5BA,EAAwB,kBAAI,kBAC5BA,EAAuC,iCAAI,qBAC3CA,EAAqC,+BAAI,mBACzCA,EAAkC,4BAAI,kBACtCA,EAAkC,4BAAI,kBACtCA,EAAwB,kBAAI,iBAC5BA,EAAwB,kBAAI,iBAC5BA,EAAwB,kBAAI,iBAC5BA,EAAwB,kBAAI,iBAC5BA,EAAwB,kBAAI,iBAC5BA,EAAwB,kBAAI,iBAC5BA,EAAuB,iBAAI,iBAC3BA,EAAuB,iBAAI,iBAC3BA,EAAuB,iBAAI,iBAC3BA,EAAuB,iBAAI,kBAC3BA,EAAqB,eAAI,oBACzBA,EAAqB,eAAI,oBACzBA,EAAoB,cAAI,mBACxBA,EAAoB,cAAI,mBACxBA,EAAoB,cAAI,mBACxBA,EAAoB,cAAI,mBACxBA,EAAuB,iBAAI,sBAC3BA,EAAuB,iBAAI,sBAC3BA,EAAuB,iBAAI,sBAC3BA,EAAgB,UAAI,wBACpBA,EAAoB,cAAI,mBACxBA,EAAoB,cAAI,mBACxBA,EAAkB,YAAI,gBACtBA,EAAqB,eAAI,mBACzBA,EAA6B,uBAAI,6BACjCA,EAA8B,wBAAI,8BAClCA,EAA4B,sBAAI,4BAChCA,EAAmB,aAAI,0BACvBA,EAAmB,aAAI,0BACvBA,EAAmB,aAAI,0BACvBA,EAAmB,aAAI,0BACvBA,EAAmB,aAAI,0BACvBA,EAAmB,aAAI,2BACvBA,EAAkC,4BAAI,6BACtCA,EAAgC,0BAAI,2BACpCA,EAA6B,uBAAI,0BACjCA,EAA6B,uBAAI,0BACjCA,EAAmB,aAAI,yBACvBA,EAAmB,aAAI,yBACvBA,EAAmB,aAAI,yBACvBA,EAAmB,aAAI,yBACvBA,EAAmB,aAAI,yBACvBA,EAAmB,aAAI,yBACvBA,EAAkB,YAAI,yBACtBA,EAAkB,YAAI,yBACtBA,EAAkB,YAAI,yBACtBA,EAAkB,YAAI,0BACtBA,EAA0B,oBAAI,kBAC9BA,EAA4B,sBAAI,oBAChCA,EAA+B,yBAAI,0BACnCA,EAAmB,aAAI,iBACvBA,EAAmB,aAAI,iBACvBA,EAAkB,YAAI,qBACtBA,EAAiC,2BAAI,oBACrCA,EAAkC,4BAAI,qBACtCA,EAAiC,2BAAI,oBACrCA,EAAmC,6BAAI,oBACvCA,EAAiC,2BAAI,aACrCA,EAA0C,oCAAI,6BAC9CA,EAAkB,YAAI,gBACtBA,EAAkB,YAAI,gBACtBA,EAAiB,WAAI,gBACrBA,EAAiB,WAAI,gBACrBA,EAAkB,YAAI,gBACtBA,EAAqB,eAAI,0BACzBA,EAAsB,gBAAI,sBAC1BA,EAAe,SAAI,2BACnBA,EAA2C,qCAAI,iBAC/CA,EAA4B,sBAAI,sCAChCA,EAAe,SAAI,6BACnBA,EAA2B,qBAAI,2BAC/BA,EAAe,SAAI,wBACnBA,EAAyB,mBAAI,iBAC7BA,EAAoB,cAAI,uBACxBA,EAAsC,gCAAI,iBAC1CA,EAAoB,cAAI,oBACxBA,EAAgB,UAAI,cACpBA,EAAwB,kBAAI,gBAC5BA,EAAc,QAAI,aAClB,IAAIC,EAAS,CACTC,MAAO,CACH,QACA,CAAC,QAAS,QAAS,GACnB,CAAC,QAAS,QAAS,GACnB,CAAC,QAAS,cAAe,GACzB,CAAC,UAAW,UAAW,GACvB,CAAC,OAAQ,OAAQ,IAErBC,aAAc,CACV,kBACA,CAAC,UAAW,UAAW,GACvB,CAAC,OAAQ,OAAQ,GACjB,CAAC,QAAS,cAAe,GACzB,CAAC,QAAS,QAAS,GACnB,CAAC,QAAS,QAAS,IAEvBC,WAAY,CACR,iBACA,CAAC,UAAW,UAAW,GACvB,CAAC,OAAQ,OAAQ,GACjB,CAAC,QAAS,cAAe,GACzB,CAAC,QAAS,QAAS,GACnB,CAAC,QAAS,QAAS,IAEvBC,OAAQ,CACJ,SACA,CAAC,UAAW,UAAW,GACvB,CAAC,OAAQ,OAAQ,GACjB,CAAC,QAAS,cAAe,GACzB,CAAC,QAAS,QAAS,GACnB,CAAC,QAAS,QAAS,IAEvBC,MAAO,CACH,YACA,CAAC,UAAW,UAAW,GACvB,CAAC,OAAQ,OAAQ,GACjB,CAAC,QAAS,cAAe,GACzB,CAAC,QAAS,QAAS,IAEvBC,QAAS,CACL,UACA,CAAC,UAAW,UAAW,GACvB,CAAC,OAAQ,OAAQ,GACjB,CAAC,QAAS,cAAe,GACzB,CAAC,QAAS,QAAS,IAEvBC,QAAS,CACL,UACA,CAAC,QAAS,cAAe,GACzB,CAAC,UAAW,UAAW,GACvB,CAAC,QAAS,QAAS,KAG3B,IAAK,IAAIC,KAASlG,OAAOmG,QAAQT,GAAS,CACtC,IAAIU,EAAYF,EAAM,GAClBG,EAAaH,EAAM,GACnBI,EAAWD,EAAW,GAE1B,IAAK,IAAIrJ,EAAI,EAAGA,EAAIqJ,EAAWpJ,OAAQD,IAAK,CACxC,IAAIuJ,EAAQF,EAAWrJ,GACvB,IAAK,IAAIO,EAAI,EAAGA,GAAKgJ,EAAM,GAAIhJ,IAC3BkI,EAAK,GAAGW,KAAaG,EAAM,KAAKhJ,KAAO,GAAG+I,OAAcC,EAAM,MAAMhJ,GAE5E,CACJ,CACJ,CAEA,SAASiJ,qBAEL,IAAIC,EAAK/E,UAAwB,aACjC+E,EAAqB,iBAAI,qBACzBA,EAAS,KAAI,OACbA,EAAW,OAAI,SACfA,EAAU,MAAI,QACdA,EAAkB,cAAI,gBACtBA,EAAY,QAAI,UAChBA,EAAuB,mBAAI,qBAC3BA,EAAQ,IAAI,MACZA,EAAU,MAAI,QAEdA,EAAW,OAAI,SACfA,EAAe,WAAI,iBACnBA,EAAY,QAAI,UAChBA,EAAU,MAAI,YACdA,EAAiB,aAAI,kBACrBA,EAAY,QAAI,SACpB,CAEA,SAASC,eAEL,IAAI,IAAIC,EAAK,EAAGA,EAAKnF,YAAYvE,OAAQ0J,IAAM,CAC3C,IAAIC,EAAapF,YAAYmF,GAC7B,IAAK,IAAIE,EAAK,EAAGA,EAAKD,EAAWE,MAAM7J,OAAQ4J,IAAM,CACjD,IAAIE,EAAOH,EAAWE,MAAMD,GAC5B,OAAOE,EAAKC,cACR,IAAK,OACDD,EAAKE,MAAMC,YAAY,UAAW,QAClC,MACJ,IAAK,WACDH,EAAKE,MAAMC,YAAY,QAAStE,aAAaC,gBAC7C,MACJ,IAAK,OACDkE,EAAKE,MAAMC,YAAY,YAAa,GACpCH,EAAKE,MAAMC,YAAY,cAAe,GACtC,MACJ,IAAK,OACDH,EAAKE,MAAMC,YAAY,QAAS,QAChC,MACJ,IAAK,gBACDH,EAAKE,MAAMC,YAAY,YAAatE,aAAaG,qBACjD,MACJ,IAAK,WACDgE,EAAKE,MAAMC,YAAY,SAAU,8BAK7C,CACJ,CACApG,IAAI,SAASmG,MAAMC,YAAY,mBAAoB,OAAOtE,aAAaI,eACvE,IAAImE,EAAMC,MACVC,SAASC,YACTD,SAASF,EACb,CAEA,SAASI,cAEL,IAAIC,EAAY,CACZ,CAAC,GAAI,YACL,CAAC,GAAI,WACL,CAAC,GAAI,WACL,CAAC,GAAI,mCACL,CAAC,GAAI,8BACL,CAAC,GAAI,oBAEL,CAAC,GAAI,yBACL,CAAC,GAAI,mBAEL,CAAC,IAAK,cACN,CAAC,IAAK,cACN,CAAC,IAAK,YACN,CAAC,IAAK,WACN,CAAC,IAAK,aAEN,CAAC,IAAK,qBAEN,CAAC,IAAK,mBACN,CAAC,IAAK,mBACN,CAAC,IAAK,iBACN,CAAC,IAAK,gBACN,CAAC,IAAK,kBAEN,CAAC,IAAK,WACN,CAAC,IAAK,uBACN,CAAC,IAAK,mBACN,CAAC,IAAK,kBACN,CAAC,IAAK,UACN,CAAC,IAAK,QACN,CAAC,IAAK,OACN,CAAC,IAAK,SACN,CAAC,IAAK,4BAEN,CAAC,IAAK,sBACN,CAAC,IAAK,SACN,CAAC,IAAK,qBACN,CAAC,IAAK,iBAEN,CAAC,IAAK,0BACN,CAAC,IAAK,eAEN,CAAC,IAAK,mBAEN,CAAC,IAAK,iBACN,CAAC,IAAK,mBACN,CAAC,IAAK,mCACN,CAAC,IAAK,oBACN,CAAC,IAAK,oBACN,CAAC,IAAK,0BACN,CAAC,IAAK,eACN,CAAC,IAAK,4BACN,CAAC,IAAK,6BACN,CAAC,IAAK,eACN,CAAC,IAAK,eACN,CAAC,IAAK,iCACN,CAAC,IAAK,kCACN,CAAC,IAAK,sBACN,CAAC,IAAK,+BACN,CAAC,IAAK,gBACN,CAAC,IAAK,4CACN,CAAC,IAAK,sBACN,CAAC,IAAK,wBACN,CAAC,IAAK,WACN,CAAC,IAAK,6BACN,CAAC,IAAK,4BACN,CAAC,IAAK,gBACN,CAAC,IAAK,kBACN,CAAC,IAAK,wBACN,CAAC,IAAK,uBACN,CAAC,IAAK,yBACN,CAAC,IAAK,uBACN,CAAC,IAAK,yBACN,CAAC,IAAK,2BACN,CAAC,IAAK,gBACN,CAAC,IAAK,2BACN,CAAC,IAAK,2BACN,CAAC,IAAK,mBACN,CAAC,IAAK,cACN,CAAC,IAAK,uBACN,CAAC,IAAK,6BACN,CAAC,IAAK,kBACN,CAAC,IAAK,kBAEV,IAAI,IAAIC,EAAK,EAAGA,EAAKD,EAAUvK,OAAQwK,IAAM,CACzC,IAAIC,EAASF,EAAUC,GAAI,GACvBE,EAAeD,EAAOE,WAAWC,SAAS,EAAG,KAC7CvB,EAAWkB,EAAUC,GAAI,GACzBK,EAAM,4DAA8DH,EAAe,OACvFjG,UAAgB,KAAEgG,GAAUK,sBAAsBD,EAAKxB,GACvD0B,eAAeN,GAAU,IAAIO,MAC7BD,eAAeN,GAAQI,IAAM,kBAAoBH,EAAe,MACpE,CAEA,IAAIO,EAAMlI,OAAOmI,KAAKzG,UAAgB,MACtCwG,EAAMA,EAAIE,KAAI5M,GAAO0H,SAAS1H,KAE9B6M,eADa/L,KAAKgM,OAAOJ,GAAO,EAEpC,CAEA,SAASH,sBAAsBD,EAAKxB,GAChC,MAAO,+BAAkCwB,EAAM,kMAAqMxB,CACxP,CAEAiC,eAAeF,eAAeG,GAC1B,IAAI7H,SAEA,YADAoD,QAAQ,yGAA0G,WAItH,IAAI0E,GAAkB,EAClBC,EAAa,GAEjBH,eAAeI,EAAY5H,GACvB,IACI+G,EAAM,4DADS/G,EAAG6G,WAAWC,SAAS,EAAG,KAC0C,OAEjE,YADDe,GAAGC,eAAe,CAAEC,IAAKhB,IAAOiB,OAAMlI,GAAKoD,QAAQC,MAAMrD,MAClEmI,QAIZtH,UAAgB,KAAEX,GAAMgH,sBAAsBD,EAAK,iBAAiB/G,KACpE2H,EAAWnK,KAAKwC,IAJZ0H,GAAkB,CAK1B,CACAF,eAAeU,EAAalI,GACxB,IAAImI,EAAW,GACf,IAAK,IAAIlM,EAAI,EAAGA,EAjBG,EAiBiBA,IAChCkM,EAAS3K,KAAKoK,EAAY5H,EAAK/D,UAE7BmM,QAAQC,IAAIF,EACtB,CACA,IAAIG,EAASb,EACb,KAAMC,SACIQ,EAAaI,GACnBA,GAzBmB,EA2BpBX,EAAWzL,OAAS,IACnB8G,QAAQ,mBAAmB2E,EAAWzL,yGAA0G,WAChJmH,QAAQvC,KAAM,uBAAuB6G,KAE7C,CAEA,SAASY,WAEL7I,OAAOiE,WAAa,CAAC6E,EAAGC,KACpB,GAAID,GAAKE,IACJ,OAAOhF,cAAc8E,EAAGC,GADd/I,OAAOiJ,sBAAsBD,IACZ,EAEpC,IAAIE,EAAgBlJ,OAAOmJ,aACvBC,EAAe,CAAC,EAEpBpJ,OAAOmJ,aAAe,SAASE,EAAY,WAAYC,EAAgB,GAAIC,EAAW,MAEnDxK,MAA3BqK,EAAaC,KACbD,EAAaC,GAAa,oBAC1B1F,QAAQvC,KAAM,0BAA0BiI,MAG5C,IAAIG,EAAMxJ,OAAOiE,WACjBjE,OAAOiE,WAAa,CAAC6E,EAAGC,KACpB/I,OAAOiE,WAAauF,EACpBxJ,OAAOyJ,cAAgB,CAACC,EAAKC,EAAIJ,EAAW,QACxCvJ,OAAOyJ,cAAgBG,mBAEvBH,cAAcC,EAAKC,EAAIJ,GAAUM,MAAK,KAClCT,EAAaC,GAAaS,WAAWC,SAAS,GAChD,EAENjB,GAAG,EAEPI,EAAcG,EAAWC,EAAeC,GACxCO,WAAWC,UAAYX,EAAaC,EACxC,CACJ,CAEA,SAASW,iBAEL,IAAIC,EAAQhJ,UAAyB,cACjCiJ,EAAW,CACX,CAAC,SAAU,kBAAmB,mWAElC,IAAI,IAAI3N,EAAI,EAAGA,EAAI2N,EAAS1N,OAAQD,IAAK,CACrC,IAAI4N,EAAUD,EAAS3N,GACnB6N,EAAQD,EAAQ,GAChBzF,EAAOyF,EAAQ,GACfE,EAAQF,EAAQ,GACpBF,EAAMG,GAAS,aAAaC,4DAAgE3F,QAAWA,IACvG4F,aAAaF,GAAS,IAAI5C,MAC1B8C,aAAaF,GAAO/C,IAAMgD,CAC9B,CACJ,CAEA,SAASE,aAEL,IAAIC,EAAO,CACP,CAAC,UAAW,uBAAwB,uyFAExC,IAAI,IAAIjO,EAAI,EAAGA,EAAIiO,EAAKhO,OAAQD,IAAK,CACjC,IAAIkO,EAAMD,EAAKjO,GACXmO,EAAYD,EAAI,GAChBE,EAAWF,EAAI,GACfG,EAAYH,EAAI,GACpBxJ,UAAqB,UAAEyJ,GAAa,aAAaE,uEAA+ED,MAChIE,SAASH,GAAa,IAAIlD,MAC1BqD,SAASH,GAAWrD,IAAMuD,CAC9B,CACJ,CAEA,SAASE,eAEL9K,OAAO+K,WAAaC,cACpB,IAAIC,EAAS,CACT,CAAC,SAAU,SAAU,u+IAEzB,IAAI,IAAI1O,EAAI,EAAGA,EAAI0O,EAAOzO,OAAQD,IAAK,CACnC,IAAI2O,EAAQD,EAAO1O,GACf4O,EAAcD,EAAM,GACpBE,EAAaF,EAAM,GACnBG,EAAcH,EAAM,GACxBjK,UAAuB,YAAEkK,GAAeC,EACxCL,WAAWI,GAAe,IAAI3D,MAC9BuD,WAAWI,GAAa9D,IAAMgE,EAC9BL,cAAcG,GAAeJ,WAAWI,GACxCG,uBAAuBH,IAAe,CAC1C,CACAnL,OAAOuL,YAAcN,CACzB,CAEA,SAASO,gBAGL,IAAIC,EAAQzL,OAAO0L,mBACnB1L,OAAO0L,mBAAqB,SAASC,EAAIC,GACrC,MAAU,WAAND,GAA4C5M,MAAzB8M,EAAQD,EAAIE,GAAG1B,QAErB,SAANuB,GAA0C5M,MAAzB8M,EAAQD,EAAIE,GAAG1B,OADhC,QAAUwB,EAAIE,GAAG1B,MAGdqB,EAAME,EAAIC,EAC5B,EACA,IAAIC,EAAU,CACVE,OAAQ,CAACtQ,GAAI,GAAIC,GAAI,GAAIsQ,EAAG,GAAIC,EAAG,IACnCC,OAAQ,CAACzQ,GAAI,GAAIC,GAAI,GAAIsQ,EAAG,GAAIC,EAAG,KAEvC,IAAK,IAAI5M,KAAOwM,EAAS,CACrB,IAAIM,EAAMN,EAAQxM,GAClB+M,KAAK,QAAU/M,GAAO8M,EAAI1Q,EAC1B4Q,KAAK,QAAUhN,GAAO8M,EAAIzQ,EAC1B4Q,KAAK,QAAUjN,GAAO8M,EAAIH,EAC1BO,KAAK,QAAUlN,GAAO8M,EAAIF,CAC9B,CACJ,CAEA,SAASO,iBAGLC,WAAW,IAAK,qDAAsD,MAAO,yBAC7EA,WAAW,IAAK,2CAA4C,MAAO,UACnEA,WAAW,IAAK,4GAA6G,SAAU,MAC3I,CAEA,SAASC,gBAELnC,aACAP,iBACAc,eACA0B,gBACJ,CAEA,SAASG,gBACL,IAAIC,EAAWvM,IAAI,aACfwM,EAASD,EAASE,SAGtBD,EAAO,IAAIxJ,MAAQ,iBACnBwJ,EAAO,IAAIE,aAAa,UAAW,4EAGnC,IAAIC,EAAcJ,EAASK,YAAYJ,EAAOA,EAAOrQ,OAAS,IAAK0Q,UASnE,SAASC,EAAatJ,EAAMuJ,EAAcC,GACtC,IAAIC,EAAS/M,SAASgN,cAAc,SACpCD,EAAOP,aAAa,QAAS,aAC7BO,EAAOP,aAAa,OAAQ,UAC5BO,EAAOP,aAAa,QAASlJ,GAC7ByJ,EAAOP,aAAa,UAAW,qBAAqBK,SACpDpN,OAAOwN,iBAAiBJ,GAAgBC,EAExC,IAAII,EAAMlN,SAASgN,cAAc,OACjCE,EAAIV,aAAa,QAAS,KAE1BH,EAASc,YAAYJ,GACrBV,EAASc,YAAYD,EACzB,CArBAT,EAAcJ,EAASK,YAAYJ,EAAOA,EAAOrQ,OAAS,IAAK0Q,UAAYF,EAG3EJ,EAASK,YAAYJ,EAAOA,EAAOrQ,OAAS,IAE5CwD,OAAOwN,iBAAmB,CAAC,EAiB3B,IAAIG,EAASpN,SAASgN,cAAc,OACpCI,EAAOZ,aAAa,QAAS,MAC7BH,EAASc,YAAYC,GAGrBR,EAAa,eAAgB,oBAAqBS,WAElDT,EAAa,aAAc,mBAAmB,KAG1C,GAFWU,QAAQ,gCAET,CACN,IAAIC,EAAYvN,SAASgN,cAAc,SAEvCO,EAAUrJ,KAAO,OAEjBqJ,EAAUC,SAAW,WACjB,GAAID,EAAUE,MAAM,GAChB,GAA6C,OAAzCF,EAAUE,MAAM,GAAGtJ,KAAK9H,MAAM,KAAK,GAAa,CAChD,IAAIqR,EAAS,IAAIC,WAEjBD,EAAOE,OAAS,WACZC,UAAUH,EAAOrS,QAEjBkS,EAAUO,QACd,EAEAJ,EAAOK,WAAWR,EAAUE,MAAM,GACtC,MACIO,MAAM,0BAGlB,EAEAT,EAAUU,OACd,KAAO,CACH,IAAIC,EAAMC,OAAO,aAAc,IAEnB,OAARD,GACAL,UAAUK,EAElB,KAEJtB,EAAa,gBAAiB,mBAAoBwB,cAElD/B,EAAS7C,WAAaiD,EAEtBhN,OAAO4O,YAAcvO,IAAI,eACzBuO,YAAYvL,MAAQwL,KACxB,CAEA,SAASC,mBACL,IAAIC,EAAoB,IAAIC,iBAAiB,iBAK7CD,EAAkBE,UAAaC,IAC3B,IAAIC,EAAOD,EAAIC,KACXC,EAAOD,EAAKC,KAChB,GAAY,QAARA,EAAgB,CAChB,IAAIC,EAAYF,EAAKE,UACjBC,EAAaH,EAAKG,UAClBC,EAAaJ,EAAKI,UAELxQ,MAAbsQ,GAA0BA,GAAahL,gBACvCV,QAAQtC,MAAO,gCAAkCiO,GACjDE,eAAeF,GAAaC,EAEpC,CACA,GAAY,OAARH,EAAe,CACf,GAAI/K,cAAgBxI,KAAK4T,OAAOnL,iBAAkB,OAElD,IAAIoL,EAAaP,EAAKO,WACtB/L,QAAQtC,MAAO,8BAAgCqO,GAC/C,IAAK,IAAInT,EAAI,EAAGA,GAAK,GAAIA,IAAK,CAC1B,IAAI+S,EAAY,aAAoB,GAAL/S,EAAS,GAAM,SAAWA,EAAE,IACvDgT,EAAYC,eAAeF,GACdvQ,MAAbwQ,GACJR,EAAkBY,YAAY,CAACP,KAAM,OAAQC,UAAWK,EAAYJ,YAAWC,aACnF,CACJ,GAIJ5L,QAAQtC,MAAO,8BACf0N,EAAkBY,YAAY,CAACP,KAAM,MAAOM,WAAYrL,gBAKxD,IAAIuL,EAAsB5P,OAAO6P,gBACjC7P,OAAO6P,gBAAmBP,IACtBM,EAAoBN,GACpB,IAAIC,EAAYC,eAAeF,GAC/BP,EAAkBY,YAAY,CAACP,KAAM,OAAQE,YAAWC,aAAW,CAE3E,CAEAzH,eAAegI,iBAIX,IAAIC,EAAkB,IAAIf,iBAAiB,eAG3Ce,EAAgBd,UAAaC,IACzB,IAAIC,EAAOD,EAAIC,KACXC,EAAOD,EAAKC,KAEhB,GAAY,SAARA,EAAiB,CACjB,GAAqB,MAAjB/K,cAAuB,OAC3B0L,EAAgBJ,YAAY,CAACP,KAAM,QAAS9O,GAAI+D,gBAChDV,QAAQtC,MAAO,+BACnB,CAEA,GAAY,SAAR+N,EAAiB,CACjB,IAAIM,EAAaP,EAAK7O,GACjBgE,gBAAgBlJ,SAASsU,IAC1BpL,gBAAgBxG,KAAK4R,GACzB/L,QAAQtC,MAAO,mCAAqCqO,EACxD,CAEA,GAAY,SAARN,EAAiB,CACjB,IAAIM,EAAaP,EAAK7O,GACtBgE,gBAAgB7H,OAAO6H,gBAAgB0L,QAAQN,GAAa,GAC5D/L,QAAQtC,MAAO,mCAAqCqO,EACxD,GAIJK,EAAgBJ,YAAY,CAACP,KAAM,UACnCzL,QAAQtC,MAAO,+BACT,IAAIqH,SAAQuH,IACdjM,cAAciM,EAhCO,IAgCmB,IAKxC5L,cAD0B,GAA1BC,gBAAgB9H,OACA,EAEAX,KAAKgM,OAAOvD,iBAAmB,EAEnDX,QAAQtC,MAAO,4BAA8BgD,eAG7CrE,OAAOkQ,iBAAiB,gBAAiBC,IACrCJ,EAAgBJ,YAAY,CAACP,KAAM,QAAS9O,GAAI+D,eAAe,IAGnEyK,kBACJ,CAEA,SAASsB,yBAGL,IAAIC,GAAmB,EACvB,MAAMC,EAAW/P,SAASgN,cAAc,OAClCgD,EAAOhQ,SAASO,gBAEtBwP,EAAS9J,MAAMgK,SAAW,WAC1BF,EAAS9J,MAAMiK,MAAQ,MACvBH,EAAS9J,MAAMkK,IAAM,OACrBJ,EAAS9J,MAAMmK,OAAS,OACxBL,EAAS9J,MAAMoK,OAAS,WAExBvQ,IAAI,YAAYqN,YAAY4C,GAU5BA,EAASJ,iBAAiB,aAAc9P,IACpCiQ,GAAmB,CAAI,IAG3BE,EAAKL,iBAAiB,WAAY9P,IAC9BiQ,GAAmB,EACnBjN,aAAa,uBAAwByN,YAAYC,YAAc,KAAK,IAGxEP,EAAKL,iBAAiB,aAAc9P,IAC5BiQ,GAlBR,SAAyBjQ,GACrB,IAAI2Q,EAAYlV,KAAK4T,IAAIc,EAAKO,YAAc,IAAKjV,KAAKgM,IAAI,IAAK0I,EAAKO,YAAc1Q,EAAE4Q,UACpFH,YAAYrK,MAAMiK,MAAQM,EAAY,KACtCT,EAAS9J,MAAMyK,MAAQF,EAAY,KACnClQ,aAAa2F,MAAMC,YAAY,qBAAsB6J,EAAS9J,MAAMyK,OACpEC,uBACJ,CAY0BC,CAAgB/Q,EAAE,IAG5CkQ,EAAS9J,MAAMyK,MAAQ9O,aAAaC,eACpCvB,aAAa2F,MAAMC,YAAY,qBAAsB6J,EAAS9J,MAAMyK,OACpEjR,OAAOsQ,SAAWA,CACtB,CAEA,SAASc,gBACL,IAAKjP,aAAaO,eAAgB,OAElC,IAAI2O,EAAQpQ,UAAwB,aACpC,IAAK,IAAI1E,KAAK8U,EACVA,EAAM9U,GAAKA,EAAI,IAAM8U,EAAM9U,EAEnC,CAEA,SAAS+U,sBACL,IAAIC,EAAKvR,OAAOwR,kBAChBxR,OAAOwR,kBAAoB,WACvBD,IACA,IAAIE,EAAUpR,IAAI,WACdqR,EAAe,CAACC,KAAM,IAAKC,MAAO,KAAKC,mBAC5B,MAAXJ,IACAC,EAAe7V,KAAKM,MAAMsV,EAAQK,wBAAwBpB,IAAM,KAGpEnQ,SAASO,gBAAgB0F,MAAMC,YAAY,wBAAyB,gBAAgBiL,OAExF,EACAF,oBACAA,mBACJ,CAuBA,SAASO,4BAELtR,OAAO,yCAAyC4N,SAChD5N,OAAO,0CAA0C4N,SAEjD,IAAI2D,EAAU,GACVC,EAAkB,CAClB,EAAG,EAAG,EACN,GAAI,GAAI,GACR,GAAI,IAAK,KAGb,IAAK,IAAIC,KAAiBD,EAAiB,CACvC,IAAIE,EAAWF,EAAgBC,GAE1BA,EAAgB,GAAK,GAAwB,GAAjBA,IAE7BF,GAAW,QAGf,IAAII,EAAU7R,SAASgN,cAAc,KAIjC6E,EAAQrI,UADI,KAAZoI,EACoBA,EAAW,GAEX,IAGxB,IAAIE,EAAY,WACZC,eAAiBH,IACjBE,EAAY,aAGXJ,EAAgB7W,SAASkX,gBAA8B,KAAZH,IAC5CE,EAAY,aAGhBD,EAAQrF,aAAa,QAAS,GAAGsF,cACjCD,EAAQrF,aAAa,QAAS,gBAEd,KAAZoF,EACAC,EAAQrF,aAAa,cAAe,mBAAmBoF,iBAEvDC,EAAQrF,aAAa,cAAe,oCAGxCiF,GAAWI,EAAQlF,SAEvB,CAEAzM,OAAO,yCAAyCyM,UAAY8E,CAChE,CASA,SAASO,6BACL9R,OAAO,yFAAuF4N,SAE9F,IAAIzS,EAAS2E,SAASiS,SAAS,+BAAgCC,WAAY,KAAMC,YAAYC,SAAU,MACvG/W,EAAOgX,cACPhX,EAAOgX,cAAc7I,UAAY,YAEjC,IAAK,IAAI1G,IAAS,CAAC,EAAC,EAAM,MAAO,GAAI,EAAC,EAAO,KAAM,MAAO,CACtD,IAAI+O,EAAU7R,SAASgN,cAAc,KACrC6E,EAAQrI,UAAY1G,EAAM,GAE1B,IAAIgP,EAAY,WACblQ,aAAaU,YAAcQ,EAAM,KAAIgP,EAAY,aAEpDD,EAAQrF,aAAa,QAAS,GAAGsF,cACjCD,EAAQrF,aAAa,QAAS,gBAC9BqF,EAAQrF,aAAa,cAAe,gCAAgC1J,EAAM,OAE1E5C,OAAO,6CAA6C4C,EAAM,4CAA4C6J,UAAYkF,EAAQlF,SAC9H,CAEJ,CAoBA,SAAS2F,gCACL,IAAIC,EAAcrS,OAAO,2CAQrBsS,EAAaxS,SAASgN,cAAc,QACxCwF,EAAWhG,aAAa,QAAS,gBACjCgG,EAAWhJ,UAAY,eAEvB,IAAIiJ,EAAa,GAEjB,SAASC,EAAUpP,EAAM0E,GACrB,IAAI+E,EAAS/M,SAASgN,cAAc,KAChC2F,EAAS,WAEV3K,GAAUpG,aAAae,oBAAmBgQ,EAAS,aAEtD5F,EAAOP,aAAa,QAAS,YAAYmG,KACzC5F,EAAOP,aAAa,QAAS,eAC7BO,EAAOP,aAAa,cAAe,gCAAgCxE,OACnE+E,EAAOvD,UAAYlG,EACnBmP,GAAc1F,EAAOJ,SACzB,CAEA+F,EAAU,QAAQ,GAClBA,EAAU,QAAQ,GAElBH,EAAY5F,WAAa,gCAAkC6F,EAAW7F,UAAY,OAAS8F,CAE/F,CAEA,SAASG,eACLpB,4BACAQ,6BACAM,+BACJ,CAEA,SAASO,mBACL,IAAIC,EAAKC,YACTtT,OAAOsT,YAAc,WACjBD,IACAF,cACJ,EACAG,cACA3P,QAAQtC,MAAO,uBACnB,CAEA,SAASkS,YAAY9X,GACjB,OAAKR,MAAMC,OAAOO,IAGPA,EAFAP,OAAOO,EAItB,CAEA,SAAS2S,UAAUK,GACfA,EAAM,QAAUA,EAAI9R,WAAW,IAAK,WAAa,SAEjD,IAEI6W,GAFS,IAAIC,WACAC,gBAAgBjF,EAAK,mBACpBkF,iBAAiB,KAEnC,IAAK,IAAIpX,EAAI,EAAGA,EAAIiX,EAAQhX,OAAQD,IAAK,CACrC,IAAIqX,EAASJ,EAAQjX,GACrB,GAAsB,OAAlBqX,EAAOC,QAAkB,SAE7B,IAAIC,EAAK,IAAIC,EAAEH,EAAOC,SACtBC,EAAGhI,GAAK,CAAC,EAET,IAAK,IAAIhP,EAAI,EAAGA,EAAI8W,EAAOI,WAAWxX,OAAQM,IAAK,CAC/C,IAAI4H,EAAOkP,EAAOI,WAAWlX,GAAG4H,KAC5BrB,EAAQuQ,EAAOI,WAAWlX,GAAGuG,MAEjCyQ,EAAGhI,GAAGpH,GAAQ6O,YAAYlQ,EAAM1G,WAAW,UAAW,KAC1D,CAEAsX,GAAGnW,KAAKgW,EACZ,CAEAI,YAAc,EACdC,sBAAwB,CAC5B,CAEA,SAASvG,YACL,IAAIwG,EAAkB,EAClB7V,EAAS,GACT8V,EAAW9T,SAASgN,cAAc,KAEtC,IAAK,IAAIhR,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACvB0X,GAAG1X,GAAG+X,WACNF,EAAkB,GAI1B,GAAIA,EAAiB,CACjB,IAAIvG,QAAQ,oCAAqC,OACjD,IAAK,IAAItR,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACvB0X,GAAG1X,GAAG+X,WACN/V,GAAUgW,UAAUhY,IAIxBsS,MACAwF,EAASA,SAAWxF,MAAQ,mBAE5BwF,EAASA,SAAW,wBAE5B,KAAO,CACH,IAAK,IAAI9X,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACvB0X,GAAG1X,GAAGiY,SACNjW,GAAUgW,UAAUhY,IAIxBsS,MACAwF,EAASA,SAAWxF,MAAQ,OAE5BwF,EAASA,SAAW,YAE5B,CAEAA,EAASI,KAAO,aAAeC,OAAOnW,GAExB,IAAVA,GACA8V,EAASI,KAAO,aAAeC,OAAOnW,GAEtC8V,EAAS7F,SAETD,MAAM,iBAGV8F,EAAShG,QACb,CAnQArO,OAAO2U,oBAAsB,KACzB,IAAIxC,EAAWzD,OAAO,kBAAmB,IAEzC,GAAIyD,EAAJ,CACA,IAAGlX,MAAMC,OAAOiX,IAEhB,OAAIA,EAAW,IACXA,EAAW,QACX7O,QAAQ,wCAAyC,YAIjD6O,EAAW,KACXA,EAAW,SACX7O,QAAQ,2CAA4C,iBAIxDsR,gBAAgB/Y,KAAKM,MAAiB,GAAXgW,IAdE7O,QAAQ,oBAAqB,UADtC,CAesB,EAyD9CtD,OAAO6U,6BAA+B,SAASxR,GAE3ClB,aAAaU,WAAaQ,EAC1BD,aAAa,gBAAiBC,GAC9BiQ,aACJ,EAyBAtT,OAAO8U,6BAA+B,SAASvM,GAY3CwM,YAAcxM,EACdpG,aAAae,kBAAoBqF,EACjCnF,aAAa,yBAA0BmF,GACvC+K,cACAY,YAAc,CAClB,EA2IA,MAAMc,aAAe,CAEjB,IACA,IACA,IACA,IACA,WACA,UACA,MACA,MACA,MACA,OACA,SACA,IACA,IACA,KACA,KACA,IACA,IACA,QAEA,UACA,QAEA,MAEA,YACA,SAEJ,SAASC,oBAAoBC,EAASC,GAClCxR,QAAQrC,OAAQ,gCAAgCO,YAAYqT,IAAU1T,iBAAiBK,YAAYsT,IAAU3T,cAC7G,IAAK,IAAIjF,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IAAK,CAChC,IAAI6V,EAAU6B,GAAG1X,GACjB,IAAK6V,EAAQoC,OAAQ,SACrB,IAAIY,EAAahD,EAAQtG,GAEzB,IAAK,IAAIrG,KAASlG,OAAOmG,QAAQ0P,GAAa,CAC1C,IAAI/V,EAAMoG,EAAM,GACZpC,EAAQoC,EAAM,GAGlB,IAAmC,IAA/BuP,aAAahF,QAAQ3Q,GAAa,SACtC,GAAsB,iBAAZ,EAAsB,SAChC,IAAgC,IAA5BgE,EAAM2M,QAAQkF,GAAiB,SAGnC,GAAI7R,IAAU6R,EAAS,CACnBE,EAAW/V,GAAO8V,EAClB,QACJ,CAEA,IAAIE,EAAOhS,EAAMzG,MAAM,KACvB,IAAK,IAAIL,EAAI,EAAGA,EAAI8Y,EAAK7Y,OAAQD,IAAK,CAClC,IAAI+Y,EAAOD,EAAK9Y,GACZ+Y,EAAKC,QAAUL,IACfG,EAAK9Y,GAAK+Y,EAAKrY,QAAQiY,EAASC,GAExC,CACAC,EAAW/V,GAAOgW,EAAKG,KAAK,IAChC,CACJ,CACAxV,OAAOmU,uBAAwB,CACnC,CAEA,SAASsB,oBAAoBC,EAAWC,GACpCC,MAGA,IAFA,IAAIC,GAAiB,EACjBC,EAAe,GACVC,EAAQ,EAAGA,EAAQ9B,GAAGzX,OAAQuZ,IACnC,GAAI9B,GAAG8B,GAAOvB,QAAUP,GAAG8B,GAAOzB,UAC1BL,GAAG8B,GAAOjK,GAAGhM,eAAe4V,GAC5B,GAAIM,WAAW/B,GAAG8B,IAAS,CACN,OAAbL,GAAsBvT,aAAaU,YACnCoS,oBAAoBhB,GAAG8B,GAAOjK,GAAGmK,IAAKN,GAG1C,IAAIO,EAA4B,iBAAf,EAA2B,IAAMR,EAAY,IAAMA,EAC7C,iBAAb,GAAuC,IAAZC,GACjCQ,IAAI,MAAQJ,EAAQ,QAAUG,EAAM,OAASjC,GAAG8B,GAAOjK,GAAG4J,GAAa,KACvEU,IAAI,MAAQL,EAAQ,QAAUG,EAAM,OAASP,EAAU,KACvD1B,GAAG8B,GAAOjK,GAAG4J,GAAaxa,OAAOya,IACP,iBAAb,GACbQ,IAAI,MAAQJ,EAAQ,QAAUG,EAAM,QAAUjC,GAAG8B,GAAOjK,GAAG4J,GAAa,MACxEU,IAAI,MAAQL,EAAQ,QAAUG,EAAM,QAAUP,EAAU,MACxD1B,GAAG8B,GAAOjK,GAAG4J,GAAaW,gBAAgBV,IAE1CpH,MAAM,8BAA+B,GAEzCuH,GAAgB,cAAgBJ,EAAY,iBAAuC,MAApBzB,GAAG8B,GAAOjK,GAAGmK,IAAchC,GAAG8B,GAAOjK,GAAGmK,IAAMhC,GAAG8B,GAAO7C,QAAU,iBAAmByC,EAAU,QAC9I,cAAbD,KACwD,GAApD,EAAC,EAAM,QAAQ1F,QAAQiE,GAAG8B,GAAOjK,GAAGwK,YACnC1R,WAAWzD,yBAAyB,GAAK,aAEzCyD,WAAWzD,yBAAyB,GAAK,eAE7CgT,uBAAwB,EAEhC,MAAO0B,GAAiB,EAC1B3B,aAAc,EACxB5Q,QAAQ,8BAAgCwS,EAAcS,cAClDV,GAAgBvS,QAAQ,iGAAmGkT,cAC/HC,KAAI,GAEJC,aACJ,CAEA,IAAIC,gBAAkB,CAAC,EAiBvB,SAASC,aAAatW,EAAIF,EAAGyW,EAAUzE,EAAS0E,EAAgBC,GAAkB,EAAOC,EAAM,IAAKC,EAAS,IAAKC,GAAc,GAC5HP,gBAAgBrW,GAAMuW,EACtBM,aAAe/E,EACfgF,WAAaJ,EACb5W,EAAEiX,iBAEF,IAAIC,EAAgB/W,SAASC,eAAe,iBAExCzF,EAAM,GAkDV,OAhDI+b,GACA/b,GAAO,oIAAoIuF,oGAC3IvF,GAAO,yIAAyIuF,qEAChJvF,GAAO,mOAAmOic,gBAC1Ojc,GAAO,uEAAuEkc,UAC9Elc,GAAO,6NAA6Nic,gLACpOjc,GAAO,uIAAuIuF,8GAK1I0W,GAASO,UAAwB,KAAZN,GACrBlc,GAAO,wCAAwCuF,mBAE3CyW,GACAhc,GAAO,sFACPA,GAAO,8IAA8IuF,sFAGjJvF,GADY,YAAZ8b,EACO,kNAEA,4IAA4IvW,sHAEvJvF,GAAO,yGAGXA,GAAO,wCAAwCuF,0EAE/CvF,GAAO,mOAAmOic,gBAG9Ojc,GAAO,6CAEHA,GADAmc,EACO,sIAAsI5W,iEAEtI,sIAAsIA,6DAKrJgX,EAAcvN,UAAYhP,EAE1Buc,EAAc9Q,MAAMgR,KAAOpX,EAAE4Q,QAC7BsG,EAAc9Q,MAAMkK,IAAMtQ,EAAEqX,QAC5BH,EAAc9Q,MAAMkR,QAAU,QAE9BC,yBAAyBnR,MAAMkR,QAAU,SAElC,CACX,CAEA,SAASE,YAAYlT,GACjB,IAAImT,EAAQhK,QAAQ,eAChBiK,EAAW,EAOf,IAAK,IAAIvb,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IAC3B0X,GAAG1X,GAAG+X,SAAW,EAEbL,GAAG1X,GAAGuP,GAAGmK,MARH9W,EASG8U,GAAG1X,GAAGuP,GAAGmK,KARlB4B,EAAe1Y,GAAKuF,EACXvF,EAAE/D,SAASsJ,KAOMsR,WAAW/B,GAAG1X,MACpC0X,GAAG1X,GAAG+X,SAAW,EACjBwD,EAAW,IAXvB,IAAc3Y,EAmBd,OAHAgV,sBAAwB,EACxBD,YAAc,EAEP4D,CACX,CAEA,SAASC,gBACL,IAGIC,EACAC,EAJA3D,EAAW4D,eACXC,EAAQ,GACRC,EAAQ,GAIZ,IAAK,IAAI7b,EAAI,EAAGA,EAAI+X,EAAS9X,OAAQD,IAAK,CACtC,GAAI+X,EAAS/X,GAAGuP,GAAGE,GAAKsI,EAAS/X,GAAGuP,GAAGG,EAAG,CACtC,IAAIoM,EAAO/D,EAAS/X,GAAGuP,GAAGE,EAE1BsI,EAAS/X,GAAGuP,GAAGE,EAAIsI,EAAS/X,GAAGuP,GAAGG,EAClCqI,EAAS/X,GAAGuP,GAAGG,EAAIoM,CACvB,CAEAF,EAAMra,KAAKwW,EAAS/X,GAAGuP,GAAGrQ,GAC1B2c,EAAMta,KAAKwW,EAAS/X,GAAGuP,GAAGpQ,EAC9B,CAEAsc,EAAOnc,KAAK4T,OAAO0I,GACnBF,EAAOpc,KAAK4T,OAAO2I,GAEnB,IAAK,IAAI7b,EAAI,EAAGA,EAAI+X,EAAS9X,OAAQD,IACjC4b,EAAM5b,IAAMyb,EACZI,EAAM7b,IAAM0b,EAEZ3D,EAAS/X,GAAGuP,GAAGrQ,EAAIuc,EAAOI,EAAM7b,GAChC+X,EAAS/X,GAAGuP,GAAGpQ,EAAIuc,EAAOE,EAAM5b,EAExC,CAEA,SAAS+b,cAAcC,GAInB,IAHA,IAEIC,EAFAC,EAAUF,EAGLhc,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACvB0X,GAAG1X,GAAGiY,QACczV,MAAhBkV,GAAG1X,GAAGuP,GAAGmK,KACLhC,GAAG1X,GAAGuP,GAAGmK,KAAOwC,IAChBD,GAAa,EACbD,EAAUE,GAG1B,GAAID,EAEA,EAAG,CACCA,GAAa,EACb,IAAIE,EAAQH,EAAQI,YAdf,KAeDC,EAAa/c,KAAKI,MAAMsc,EAAQM,UAAUH,EAAQ,IAOtD,IALID,GADU,GAAVC,GAAezd,MAAM2d,GACXL,OAEAA,EAAQM,UAAU,EAAGH,GAnB9B,KAmBiDE,EAAa,GAG1Drc,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACvB0X,GAAG1X,GAAGiY,QACczV,MAAhBkV,GAAG1X,GAAGuP,GAAGmK,KACLhC,GAAG1X,GAAGuP,GAAGmK,KAAOwC,IAChBD,GAAa,EACbD,EAAUE,EAG9B,OAASD,GAEb,OAAOC,CACX,CAEA,SAASK,qBACL9Y,OAAOsY,cAAgBA,aAC3B,CAEA,SAASS,yBACLC,sBAAwB,IAC5B,CAEA,SAASC,kBAAkBvY,GACvB,IACI4F,EADAD,EAAQ9F,SAASS,YAAY,GAAGqF,MAGpC,IAAK,IAAI9J,EAAI,EAAGA,EAAI8J,EAAM7J,OAAQD,IAC1B8J,EAAM9J,GAAGgK,cAAgB7F,IACzB4F,EAAOD,EAAM9J,IAIrB,OAAO+J,CACX,CAEA,SAAS4S,SAASxY,EAAU8F,EAAOnD,GAC/B4V,kBAAkBvY,GAAU8F,MAAMA,GAASnD,CAC/C,CAEA,SAASN,aACL6D,SAAS,GAETD,MAAQ,EAERuS,SAAS,SAAU,iBAAkB,OACrCA,SAAS,UAAW,iBAAkB,OACtCA,SAAS,WAAY,iBAAkB,OACvCA,SAAS,SAAU,kBAAmB,WACtCA,SAAS,UAAW,kBAAmB,WACvCA,SAAS,WAAY,kBAAmB,WACxCA,SAAS,aAAc,kBAAmB,WAC1CA,SAAS,YAAa,kBAAmB,WACzCA,SAAS,YAAa,SAAU,IAChCA,SAAS,aAAc,kBAAmB,QAC1CA,SAAS,aAAc,SAAU,kBACjCA,SAAS,aAAc,QAAS,QAChCA,SAAS,YAAa,QAAS,QAC/BA,SAAS,aAAc,QAAS,QAChCA,SAAS,gBAAiB,QAAS,QACnCA,SAAS,KAAM,QAAS,QACxBA,SAAS,OAAQ,QAAS,QAC1BA,SAAS,OAAQ,QAAS,QAC1BA,SAAS,kBAAmB,QAAS,QACrCA,SAAS,mBAAoB,QAAS,QACtCA,SAAS,QAAS,SAAU,IAC5BA,SAAS,QAAS,SAAU,IAC5BA,SAAS,OAAQ,kBAAmB,WACpCA,SAAS,OAAQ,kBAAmB,WACpCA,SAAS,UAAW,kBAAmB,WACvCA,SAAS,kBAAmB,kBAAmB,WAC/CA,SAAS,mBAAoB,kBAAmB,WAChDA,SAAS,YAAa,kBAAmB,WACzCA,SAAS,kBAAmB,kBAAmB,WAC/CA,SAAS,kBAAmB,SAAU,kBACtCA,SAAS,kBAAmB,QAAS,QACrCA,SAAS,mBAAoB,kBAAmB,QAChDA,SAAS,mBAAoB,SAAU,kBACvCA,SAAS,mBAAoB,QAAS,QACtCA,SAAS,mBAAoB,kBAAmB,QAChDA,SAAS,mBAAoB,QAAS,QACtCA,SAAS,mBAAoB,kBAAmB,WAChDA,SAAS,mBAAoB,SAAU,kBACvCA,SAAS,mBAAoB,QAAS,QACtCA,SAAS,oBAAqB,kBAAmB,QACjDA,SAAS,oBAAqB,SAAU,kBACxCA,SAAS,oBAAqB,QAAS,QACvCA,SAAS,oBAAqB,kBAAmB,QACjDA,SAAS,oBAAqB,QAAS,QACvCA,SAAS,WAAY,kBAAmB,WACxCA,SAAS,SAAU,kBAAmB,WACtCA,SAAS,eAAgB,kBAAmB,QAC5CA,SAAS,eAAgB,QAAS,QAClCA,SAAS,OAAQ,kBAAmB,WACpCA,SAAS,OAAQ,QAAS,QAC1BA,SAAS,aAAc,kBAAmB,QAC1CA,SAAS,aAAc,QAAS,QAChCA,SAAS,cAAe,kBAAmB,QAC3CA,SAAS,cAAe,QAAS,QACjCA,SAAS,WAAY,kBAAmB,WACxCA,SAAS,WAAY,QAAS,QAC9BA,SAAS,cAAe,kBAAmB,WAC3CA,SAAS,cAAe,eAAgB,IACxCA,SAAS,oBAAqB,kBAAmB,QACjDA,SAAS,qBAAsB,kBAAmB,QAClDA,SAAS,0BAA2B,kBAAmB,WACvDA,SAAS,uBAAwB,kBAAmB,QACpDA,SAAS,WAAY,aAAc,IACnCA,SAAS,UAAW,cAAe,IACnCA,SAAS,4BAA6B,kBAAmB,QACzDA,SAAS,+CAAgD,iBAAkB,IAC3EA,SAAS,+CAAgD,iBAAkB,IAC3EA,SAAS,aAAc,aAAc,UACrCA,SAAS,aAAc,aAAc,OACzC,CAEA,SAASC,aAAaxZ,GAClB,IAAIlE,EAAI,EACJC,EAAI,EACJsQ,EAAIrM,EAAImM,GAAGE,EACXC,EAAItM,EAAImM,GAAGG,EA8Bf,MA5BK,iCAAiC7Q,SAASuE,EAAIuT,UAC/CzX,EAAI2d,KAAKzZ,EAAIuT,QACbxX,EAAI2d,KAAK1Z,EAAIuT,QACblH,EAAIsN,KAAK3Z,EAAIuT,QACbjH,EAAIsN,KAAK5Z,EAAIuT,SAGb,eAAe9X,SAASuE,EAAIuT,UAC5BzX,GAAK,GACLC,GAAK,GACLsQ,EAAI,GACJC,EAAI,IAGU,WAAdtM,EAAIuT,SACJzX,EAAI2d,KAAK,WAAazZ,EAAImM,GAAG1B,OAC7B1O,EAAI2d,KAAK,WAAa1Z,EAAImM,GAAG1B,OAC7B4B,EAAIsN,KAAK,WAAa3Z,EAAImM,GAAG1B,OAC7B6B,EAAIsN,KAAK,WAAa5Z,EAAImM,GAAG1B,OAET,UAAhBzK,EAAImM,GAAG1B,QACP3O,EAAI2Q,KAAkB,YACtB1Q,EAAI2Q,KAAkB,YACtBL,EAAIM,KAAkB,YACtBL,EAAIM,KAAkB,cAIvB,CACH9Q,EAAGA,EACHC,EAAGA,EACHsQ,EAAGA,EACHC,EAAGA,EAEX,CAEA,SAASuN,oBACL,IAAIC,EAAYvB,eAGZF,EAAO,IACPC,EAAO,IACPyB,GAAO,IACPC,GAAO,IAEX,IAAK,IAAIpd,EAAI,EAAGA,EAAIkd,EAAUjd,OAAQD,IAAK,CACvC,IAAIqd,EAAMT,aAAaM,EAAUld,IAC7Bd,EAAIge,EAAUld,GAAGuP,GAAGrQ,EAAIme,EAAIne,EAC5BC,EAAI+d,EAAUld,GAAGuP,GAAGpQ,EAAIke,EAAIle,EAC5BsQ,EAAI4N,EAAI5N,EACRC,EAAI2N,EAAI3N,EAERxQ,EAAIuc,IACJA,EAAOvc,GAGPA,EAAIuQ,EAAI0N,IACRA,EAAOje,EAAIuQ,GAGXtQ,EAAIuc,IACJA,EAAOvc,GAGPA,EAAIuQ,EAAI0N,IACRA,EAAOje,EAAIuQ,EAEnB,CAEAjM,OAAOiU,GAAK,GACZ,IAAK,IAAI7T,KAAKqZ,EACVxF,GAAGnW,KAAKsC,GAKZuG,MAAQ,EACRkT,WAAa,EACbC,iBAAmB,EACnBC,KAAO,EACPC,gBAEA,IAAIC,EAAKC,SAAWC,WAChBC,EAAKC,SAAWC,WAEpBH,WAAanC,EAAO,GACpBsC,WAAarC,EAAO,GACpBiC,SAAWlC,EAAOiC,EAAK,GACvBI,SAAWpC,EAAOmC,EAAK,GAEvBG,qBAAuB,GAEvBC,SAEA,IAAIxO,EAAI0N,EAAO1B,EAAO,GAClB/L,EAAI0N,EAAO1B,EAAO,GAEtBtU,QAAQrC,OAAQ,cAChB,IAAI6N,EAAOsL,IAAIC,aAAa,EAAG,EAAG1O,EAAGC,GACrCtI,QAAQrC,OAAQ,aAEhB,IAAIqZ,EAASpa,SAASgN,cAAc,UAChCqN,EAAOD,EAAOE,WAAW,MAEzBC,EAAUva,SAASgN,cAAc,UACjCwN,EAAOD,EAAQD,WAAW,MAE9BF,EAAOlK,MAAQzE,EACf2O,EAAOhK,OAAS1E,EAEhB2O,EAAKI,YACLJ,EAAKK,aAAa9L,EAAM,EAAG,GAC3ByL,EAAKM,YAEL,IAAIC,EAAQnP,EACRoP,EAAQnP,EAEZ,GAAID,EAAI,KAAOC,EAAI,IAAK,CACpB,IAAIoP,EAASrP,EAAIC,EAEboP,GAAU,GACVrP,EAAI,IACJC,EAAID,EAAIqP,IAERpP,EAAI,IACJD,EAAIC,EAAIoP,EAEhB,CAEAP,EAAQrK,MAAQzE,EAChB8O,EAAQnK,OAAS1E,EAEjB8O,EAAKC,YACLD,EAAKO,MAAMtP,EAAImP,EAAOlP,EAAImP,GAC1BL,EAAKQ,UAAUZ,EAAQ,EAAG,GAC1BI,EAAKG,YAEL,IAAItf,EAASkf,EAAQU,YAKrB,OAHAb,EAAOtM,SACPsM,OAAS5b,EAEFnD,CACX,CAEA,SAAS6f,qBACL,IAAIC,EAAenb,SAASgN,cAAc,OACtCoO,EAAcpb,SAASC,eAAe,eAE1Ckb,EAAapb,GAAK,eAClBob,EAAaE,UAAY,UACzBF,EAAalV,MAAQ,gIAErBkV,EAAaxL,iBAAiB,eAAe9P,IACzCA,EAAEiX,gBAAgB,IAGtBsE,EAAYzL,iBAAiB,SAAS9P,IAClCsb,EAAalV,MAAMkR,QAAU,MAAM,IAGvCnX,SAASsb,KAAKC,OAAOJ,EACzB,CAEA,SAASK,oBAAoBxf,GACzB,IAAIyf,EAAQC,KAAK7f,MAAM6F,aAAaia,gBAGpC,GAFarO,QAAQ,oCAET,CACR,IAAInJ,EAAOgK,OAAO,cAAesN,EAAMzf,GAAGmI,MAEtCA,IACAsX,EAAMzf,GAAGmI,KAAOA,EAEhBzC,aAAaia,eAAiBD,KAAKE,UAAUH,GAE7CI,qBAER,MACQvO,QAAQ,sCACRmO,EAAMvf,OAAOF,EAAG,GAEhB0F,aAAaia,eAAiBD,KAAKE,UAAUH,GAE7CI,qBAGZ,CAEA,SAASC,8BACLrc,OAAO+b,oBAAsBA,oBAC7BpY,QAAQtC,MAAO,mCACnB,CAEA,SAAS+a,qBACAna,aAAaia,iBACdja,aAAaia,eAAiB,MAGlC,IAAIF,EAAQC,KAAK7f,MAAM6F,aAAaia,gBAChCR,EAAenb,SAASC,eAAe,gBACvCmb,EAAcpb,SAASC,eAAe,eAE1Ckb,EAAalV,MAAMkR,QAAU,QAC7BiE,EAAYnV,MAAMkR,QAAU,QAE5B,IAAI4E,EAAO,iWASPC,EAAavc,OAAOiU,GACpBuI,EAAK,CAAC,EACVA,EAAGC,MAAQ9V,MACX6V,EAAGE,aAAe7C,WAClB2C,EAAGG,gBAAkB7C,iBAErB0C,EAAGI,IAAM1C,SACTsC,EAAGK,IAAMxC,SAETmC,EAAGM,IAAM3C,WACTqC,EAAGO,IAAMzC,WAETkC,EAAGQ,IAAMzC,qBACTiC,EAAGzC,KAAOA,KAEV/Z,OAAOiU,GAAK,GACZ,IAAK,IAAI1X,EAAI,EAAGA,EAAIyf,EAAMxf,OAAQD,IAC9B0gB,uBAAuBjB,EAAMzf,IAC7B+f,GAAQ,2FACuE/f,EAAI,2CAA6CA,EAAI,2BAC1Hid,oBAAsB,iEAC3BwC,EAAMzf,GAAGmI,KAAO,6BAKzBgX,EAAa3R,UAAYuS,EAAO,SAChCtc,OAAOiU,GAAKsI,EACZ5V,MAAQ6V,EAAGC,MACX5C,WAAa2C,EAAGE,aAChB5C,iBAAmB0C,EAAGG,gBACtBzC,SAAWsC,EAAGI,IACdvC,SAAWmC,EAAGK,IACd1C,WAAaqC,EAAGM,IAChBxC,WAAakC,EAAGO,IAChBxC,qBAAuBiC,EAAGQ,IAC1BjD,KAAOyC,EAAGzC,KACV7F,YAAc,EACd8F,eACJ,CAEA,SAASiD,uBAAuB3H,GAC5B9F,eAAe0N,oBAAsB5H,EAAKnG,KAC1CgO,mBAAmB,sBACvB,CAEA,SAASC,4BAA4B7gB,GACjC,IAAIyf,EAAQC,KAAK7f,MAAM6F,aAAaia,gBAEpC1M,eAAe0N,oBAAsBlB,EAAMzf,GAAG4S,KAE9CgO,mBAAmB,uBAEnB,IAAIzB,EAAenb,SAASC,eAAe,gBACvCmb,EAAcpb,SAASC,eAAe,eAE1Ckb,EAAalV,MAAMkR,QAAU,OAC7BiE,EAAYnV,MAAMkR,QAAU,OAE5BpU,QAAQ,2CAA4CiT,aACxD,CAEA,SAAS8G,2BACL,IAGI,GAAwB,GAFRnF,eAEF1b,OAAa,CACvBqT,gBAAgB,uBAEhB,IAAImM,EAAQC,KAAK7f,MAAM6F,aAAaia,gBAEpCF,EAAMle,KAAK,CACP4G,KAAM,YACNyK,KAAMK,eAAe0N,sBAGzBjb,aAAaia,eAAiBD,KAAKE,UAAUH,GAE7C1Y,QAAQ,yCAA0CiT,aACtD,MACI6F,oBAER,CAAE,MAAOkB,GACL9Z,QAAQC,MAAM6Z,GACdha,QAAQ,oEAAqEC,SACjF,CACJ,CAEA,SAASga,qBACL,IAAIC,EAAgBjd,SAASC,eAAe,kBACxCid,EAAOD,EAAcE,WAAW,GAEpCF,EAAchX,MAAMiK,MAAQ,QAC5BgN,EAAKjX,MAAMiK,MAAQ,QAEnBgN,EAAK1T,UAAY,yDAA2D5J,QAAQwd,OAAOC,OAC/F,CAEA,SAASlH,cACLzC,GAAGjW,MAAK,CAAC6f,EAAGC,IAAMD,EAAE/R,GAAGiS,SAAWD,EAAEhS,GAAGiS,UAC3C,CAEA,SAASC,kBACL,IAAIvM,EAAUlR,SAASC,eAAe,WAClCiZ,EAAYvB,eAEhB,GAAIzG,GAA+B,GAApBgI,EAAUjd,OAAa,CAClC,IAAIyhB,EAAsB,kIACtBC,EAA2B,uIAC3BC,EAA2B,uIAEJ,MAAvB1E,EAAU,GAAGvG,SACbzB,EAAQ1H,WAAakU,GAGE,SAAvBxE,EAAU,GAAGvG,SACbzB,EAAQ1H,WAAakU,EACrBxM,EAAQ1H,WAAamU,EACrBzM,EAAQ1H,WAAaoU,EAE7B,CACJ,CAEA,SAASC,eACL,IACI9d,EADAmZ,EAAYvB,eAWhB,GAR2B,MAAvBuB,EAAU,GAAGvG,SACb5S,EAAKmZ,EAAU,GAAG3N,GAAGuS,GAGE,SAAvB5E,EAAU,GAAGvG,SACb5S,EAAKmZ,EAAU,GAAG3N,GAAG1B,OAGR,iBAAN9J,EAAgB,CACvB,IAAIge,EAAM/d,SAASgN,cAAc,OAEjC+Q,EAAInQ,OAAS,WACT,IAAInC,EAAIsS,EAAI7N,MACRxE,EAAIqS,EAAI3N,OAEZ2N,EAAIjQ,SAEJE,MAAM,MAAQvC,EAAI,QAAUC,EAChC,EAEAqS,EAAIC,QAAU,WACVD,EAAIjQ,SAEJE,MAAM,mBACV,EAEA+P,EAAIjX,IAAM,0DAA4D/G,EAAGke,MAAM,EACnF,MACIjQ,MAAM,mBAEd,CAEA,SAASmM,eACL,OAAO,IAAIhS,SAAQ,CAAC+V,EAAKnB,KACrB,IACIhd,EADAmZ,EAAYvB,eAWhB,GAR2B,MAAvBuB,EAAU,GAAGvG,SACb5S,EAAKmZ,EAAU,GAAG3N,GAAGuS,GAGE,SAAvB5E,EAAU,GAAGvG,SACb5S,EAAKmZ,EAAU,GAAG3N,GAAG1B,OAGR,iBAAN9J,EAAgB,CACvB,IAAIge,EAAM/d,SAASgN,cAAc,OAEjC+Q,EAAInQ,OAAS,WACT,IAAInC,EAAIsS,EAAI7N,MACRxE,EAAIqS,EAAI3N,OAERgK,EAASpa,SAASgN,cAAc,UAChCkN,EAAME,EAAOE,WAAW,MAE5BF,EAAOlK,MAAQ6N,EAAI7N,MACnBkK,EAAOhK,OAAS2N,EAAI3N,OAEpB8J,EAAIO,YACJP,EAAIc,UAAU+C,EAAK,EAAG,GACtB7D,EAAIS,YAEJuD,EAAI,CAAChE,EAAIC,aAAa,EAAG,EAAG1O,EAAGC,GAAGkD,KAAMnD,GAC5C,EAEAsS,EAAIC,QAAU,WACVD,EAAIjQ,SAEJE,MAAM,oBAENkQ,EAAI,EACR,EAEAH,EAAIjX,IAAM,0DAA4D/G,EAAGke,MAAM,EACnF,MACIjQ,MAAM,oBAENkQ,EAAI,EACR,GAER,CAEA,SAASC,OAAO7hB,GACZ,IAAI4S,EAAMkP,IAEV,IAAK,IAAIpiB,EAAI,EAAGA,EAAIM,EAAIL,OAAQD,IACxBM,EAAIN,GAAKkT,IACTA,EAAM5S,EAAIN,IAIlB,OAAOkT,CACX,CAEA,SAASmP,OAAO/hB,GACZ,IAAIgL,GAAM,IAEV,IAAK,IAAItL,EAAI,EAAGA,EAAIM,EAAIL,OAAQD,IACxBM,EAAIN,GAAKsL,IACTA,EAAMhL,EAAIN,IAIlB,OAAOsL,CACX,CAEA,SAASgX,iBAAiB1P,EAAMnD,GAC5B,IAGIgM,EACAC,EACAyB,EACAC,EANAmF,EAAO,GACPC,EAAO,GAOPC,EAAU,EACVC,EAAU,EAEd,GAAY,GAAR9P,EAAW,CACX,IAAK,IAAI5S,EAAI,EAAGA,EAAI4S,EAAK3S,OAAQD,GAAK,EAClC,GAAI4S,EAAK5S,EAAI,IAAM,EAAG,CAClB,IAAId,EAAKc,EAAI,EAAKyP,EACdtQ,EAAIG,KAAKI,MAAMM,EAAI,EAAIyP,GAE3B8S,EAAKhhB,KAAKrC,GACVsjB,EAAKjhB,KAAKpC,EACd,CAGJsc,EAAO0G,OAAOI,GACd7G,EAAOyG,OAAOK,GACdrF,EAAOkF,OAAOE,GACdnF,EAAOiF,OAAOG,GAEdC,GAAWhH,EAAO0B,GAAQ,EAC1BuF,GAAWhH,EAAO0B,GAAQ,CAC9B,CAEA,MAAO,CACHle,EAAGujB,EACHtjB,EAAGujB,EAEX,CAEA,SAASC,eAAezjB,EAAGC,GACvB,IAAI+d,EAAYvB,eAEhBuB,EAAU,GAAG3N,GAAGqT,EAAI1jB,EACpBge,EAAU,GAAG3N,GAAGsT,EAAI1jB,CACxB,CAEA,SAAS2jB,eACL,IAAI5F,EAAYvB,eAEQ,GAApBuB,EAAUjd,QACiB,SAAvBid,EAAU,GAAGvG,QACbwH,eAAe7Q,MAAK4U,IACL,GAAPA,GAIAS,gBAHaL,iBAAiBJ,EAAI,GAAIA,EAAI,IAC3BhjB,EAEIge,EAAU,GAAG3N,GAAGsT,EACvC,IAKZlL,YAAc,EACdC,sBAAwB,CAC5B,CAEA,SAASmL,eACL,IAAI7F,EAAYvB,eAEQ,GAApBuB,EAAUjd,QACiB,SAAvBid,EAAU,GAAGvG,QACbwH,eAAe7Q,MAAK4U,IAChB,GAAW,GAAPA,EAAU,CACV,IACI/iB,EADSmjB,iBAAiBJ,EAAI,GAAIA,EAAI,IAC3B/iB,EAEfwjB,eAAezF,EAAU,GAAG3N,GAAGqT,GAAIzjB,EACvC,KAKZwY,YAAc,EACdC,sBAAwB,CAC5B,CAEA,SAASoL,iBACLvf,OAAOoe,aAAeA,aACtBpe,OAAOqf,aAAeA,aACtBrf,OAAOsf,aAAeA,YAC1B,CA/yBAtf,OAAOwf,uBAAyB,SAASlf,GACrC,IAAI8e,EAAI1Q,OAAO,YAAaiI,gBAAgBrW,IAC5Cmf,oBACW,OAANL,GACD3V,cAAc,0BAA0BiW,gCAAgCpf,WAAY8e,IAAK,eAEjG,EACApf,OAAO2f,uBAAyB,SAASrf,GACrC,IAAI8e,EAAIvR,QAAQ,mCAAmC8I,gBAAgBrW,QACnEmf,oBACKL,IACDjI,aAAa3Q,MAAMoZ,QAAU,MAC7BnW,cAAc,0BAA0BiW,yBAAyBpf,IAAM,gBAE/E,EAmyBA,IAAIuf,UAAY,EAEZC,cA0MJ,SAASC,YACL,IAAIC,EAAUzf,SAASgN,cAAc,KAErCyS,EAAQxZ,MAAMyZ,SAAW,OACzBD,EAAQxZ,MAAM0Z,WAAa,YAC3BF,EAAQxZ,MAAM2Z,MAAQ,OACtBH,EAAQxZ,MAAM4Z,gBAAkB,OAChCJ,EAAQxZ,MAAM6Z,QAAU,OACxBL,EAAQxZ,MAAMiK,MAAQ,cACtBuP,EAAQxZ,MAAM8Z,aAAe,MAC7BN,EAAQxZ,MAAM+Z,UAAY,YAC1BP,EAAQxZ,MAAMgK,SAAW,WACzBwP,EAAQxZ,MAAMgR,KAAO,QACrBwI,EAAQxZ,MAAMkK,IAAM,SAEpBnQ,SAASsb,KAAKC,OAAOkE,GAErBzf,SAAS2P,iBAAiB,aAAa9P,IAC/BA,EAAEogB,OAAOC,QACTrgB,EAAEogB,OAAOE,QAAQD,MAAQrgB,EAAEogB,OAAOC,MAClCrgB,EAAEogB,OAAOC,MAAQ,IAGjBrgB,EAAEogB,OAAOG,cAAcF,QACvBrgB,EAAEogB,OAAOG,cAAcD,QAAQD,MAAQrgB,EAAEogB,OAAOG,cAAcF,MAC9DrgB,EAAEogB,OAAOG,cAAcF,MAAQ,IAEnC,IAAIG,EAAa,IAEjB,GAAIxgB,EAAEogB,OAAOE,QAAQD,MAAO,CACxB,IAAIzjB,EAAKoD,EAAEogB,OAAOE,QAAQD,MAAMjkB,OAChCwjB,EAAQxZ,MAAMgR,KAAOxa,EAAK4jB,EAAaxgB,EAAE4Q,QAAU,GAAK,KACxDgP,EAAQjW,UAAY3J,EAAEogB,OAAOE,QAAQD,MAES,IAA1CT,EAAQlO,wBAAwBnB,SAChCqP,EAAQxZ,MAAMgR,KAAOxa,EAAK4jB,EAAaxgB,EAAE4Q,QAAU,GAAKgP,EAAQlO,wBAAwBrB,MAAQ,KAExG,MAAO,GAAIrQ,EAAEogB,OAAOG,cAAcD,QAAQD,MAAO,CAC7C,IAAIzjB,EAAKoD,EAAEogB,OAAOG,cAAcD,QAAQD,MAAMjkB,OAC9CwjB,EAAQxZ,MAAMgR,KAAOxa,EAAK4jB,EAAaxgB,EAAE4Q,QAAU,GAAK,KACxDgP,EAAQxZ,MAAMkK,IAAMtQ,EAAEqX,QAAU,KAChCuI,EAAQjW,UAAY3J,EAAEogB,OAAOG,cAAcD,QAAQD,MAEL,IAA1CT,EAAQlO,wBAAwBnB,SAChCqP,EAAQxZ,MAAMgR,KAAOxa,EAAK4jB,EAAaxgB,EAAE4Q,QAAU,GAAKgP,EAAQlO,wBAAwBrB,MAAQ,KAExG,MACIuP,EAAQxZ,MAAMgR,KAAO,OACrBwI,EAAQxZ,MAAMkK,IAAM,QACxB,IAEJ/M,QAAQtC,MAAO,iBACnB,CAEA,SAASwf,mBAEL,IAAIC,EAAczgB,IAAI,eAEtBygB,EAAY/T,aAAa,YAAY,GACrC+T,EAAYC,oBAAoB,SAAUC,aAE1CF,EAAY5Q,iBAAiB,UAAU,SAAS9P,GAC5C,IAAI4N,EAAQ5N,EAAEogB,OAAOxS,MACrB1K,QAAQ,qBAAqB0K,EAAMxR,sBAAuB,WAC1D,IAAK,IAAIykB,KAAQjT,EAEbgT,YADU,CAACR,OAAQ,CAACxS,MAAO,CAACiT,KAGpC,IAAG,EACP,CAEA,SAASC,aAAa1iB,EAAO6E,GACzB,IAAI8d,EAAc5gB,SAASC,eAAe,WAEtChC,EAAQ2iB,EAAYzD,WAAWlhB,SAC/B2kB,EAAYzD,WAAWlf,GAAOkf,WAAW,GAAG3T,UAAY1G,EAEhE,CAEA,SAAS6U,eACL,IAAI1E,EAAU,GAEd,IAAK,IAAIjX,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACvB0X,GAAG1X,GAAG+X,UAAYL,GAAG1X,GAAGiY,QACxBhB,EAAQ1V,KAAKmW,GAAG1X,IAIxB,OAAOiX,CACX,CAEA,SAAS4N,qBAAqB5N,GAC1B,IAAI6N,EAAO,EAEX,IAAK,IAAI9kB,EAAI,EAAGA,EAAIiX,EAAQhX,OAAQD,IAC5BiX,EAAQjX,GAAG2W,QAAUM,EAAQ,GAAGN,SAChCmO,EAAO,GAIf,OAAOA,CACX,CAEA,SAASC,gBAAgBC,GACrB,OAAOzc,MAAM/H,KAAK,IAAIykB,IAAID,GAC9B,CAEA,SAASE,YAAYF,EAAOvF,GACxB,IAAI0F,EAAOzF,KAAK7f,MAAM6f,KAAKE,UAAUoF,IAErC,IAAK,IAAIhlB,EAAI,EAAGA,EAAIyf,EAAMxf,OAAQD,IAC9BmlB,EAAKjlB,OAAOilB,EAAK1R,QAAQgM,EAAMzf,IAAK,GAGxC,OAAOmlB,CACX,CAEA,SAASC,wBAAwBC,EAAYC,GACzC,IAAIC,EAAU,GAEd,IAAK,IAAIvlB,EAAI,EAAGA,EAAIqlB,EAAWplB,OAAQD,IACnCulB,EAAQhkB,KAAK+jB,EAAiB7R,QAAQ4R,EAAWrlB,KAGrD,OAAOulB,CACX,CAEA,SAASC,kBAAkBvO,GACvB,IAAIwO,EAAsB,GACtBJ,EAAariB,OAAOmI,KAAK8L,EAAQ,GAAG1H,IAExC,IAAK,IAAIvP,EAAI,EAAGA,EAAIiX,EAAQhX,OAAQD,IAChC,IAAK,IAAIO,EAAI,EAAGA,EAAI8kB,EAAWplB,OAAQM,IAC/B0W,EAAQjX,GAAGuP,GAAG8V,EAAW9kB,KAAO0W,EAAQ,GAAG1H,GAAG8V,EAAW9kB,KACzDklB,EAAoBlkB,KAAK8jB,EAAW9kB,IAQhD,OAHAklB,EAAsBV,gBAAgBU,GACtCA,EAAsBP,YAAYG,EAAYI,GAEvCL,wBAAwBK,EAAqBJ,EACxD,CAEA,SAASK,UAAUlnB,GACf,OAAIE,MAAMC,OAAOH,IACC,QAAPA,EAEAmnB,QAAQnnB,EAEvB,CAEA,SAASonB,SAAS3jB,EAAO4jB,GACrB,IAAIC,EAAa7jB,EAQjB,MANkB,WAAd4jB,GACI5jB,EAAQ,IACR6jB,EAAa7jB,EAAQ3C,KAAKI,OAAOuC,EAAQ,GAAK,IAI/C6jB,CACX,CA3WA9hB,SAAS2P,iBAAiB,aAAa9P,IACnC0f,cAAgB1f,EAAEogB,MAAM,IAG5BjgB,SAAS2P,iBAAiB,WAAW9P,IAMjC,GALIA,EAAEkiB,SAAqB,QAAVliB,EAAEmiB,OACfniB,EAAEiX,iBACF9W,SAASiiB,uBAAuB,aAAa,GAAGhU,SAGhDpO,EAAEkiB,SAAqB,QAAVliB,EAAEmiB,KAAgB,CAC/BniB,EAAEiX,iBAEF,IAAI3S,EAAOgK,OAAO,gBAAiB,IAEtB,OAAThK,GAA0B,KAATA,GACFkT,YAAYlT,IAGvB6J,MAAM,iBAGlB,CAyCA,GAvCc,QAAVnO,EAAEmiB,MAAmC,6BAAjBzC,eAAoE,gBAApBA,cAAcxf,KAC7EmiB,yBACD1K,iBAIJ3X,EAAEkiB,SAAqB,QAAVliB,EAAEmiB,MACXE,0BAA4BC,sBAC5BtiB,EAAEiX,iBAEFsL,wBACAC,2BAIO,SAAVxiB,EAAEmiB,MAA6B,kBAAVniB,EAAEmiB,OAA6BniB,EAAEkiB,SAAWO,eAClEziB,EAAEiX,iBAEF0C,MAAQ,EACRC,gBACA9F,YAAc,IAGH,SAAV9T,EAAEmiB,MAA6B,aAAVniB,EAAEmiB,OAAwBniB,EAAEkiB,SAAWO,eAC7DziB,EAAEiX,iBAEF0C,MAAQ,GACRC,gBACA9F,YAAc,GAGd9T,EAAEkiB,SAAWliB,EAAE0iB,SACf1iB,EAAEiX,iBAEF0C,KAAO,EACPC,gBACA9F,YAAc,GAGJ,QAAV9T,EAAEmiB,MAAkBniB,EAAEkiB,UACtBliB,EAAEiX,iBAEuB,iBAArByI,cAAcxf,IAAuB,CACrC,IAAI+C,EAAQyc,cAAczc,MAEtB0f,EAAOrU,OAAO,gCAAiC,IACnD,IAAKqU,EAAM,OAEX,IAAIC,EAAOtU,OAAO,8BAA+BqU,GACjD,IAAKC,EAAM,OAEXlD,cAAczc,MAAQA,EAAM1G,WAAWomB,EAAMC,EACjD,CAGJ,GAAc,SAAV5iB,EAAEmiB,MAAoC,6BAAjBzC,eAAoE,gBAApBA,cAAcxf,IAAwBuiB,aAAc,CACzH,IAAIvO,EAAW4D,eAEf,GAAuB,GAAnB5D,EAAS9X,OAAa,CACtB,IAAIqI,EAAQ6J,OAAO,wBAAyB,IAE5C,GAAI7J,EAAO,CACP,IAAIoe,EAAavU,OAAO,oBAAqB,IAE7C,GAAIuU,EAAY,CACZpe,EAAQA,EAAMqe,cAAcjmB,QAAQ,QAAS,KAAKA,QAAQ,SAAU,KAEpE,IAAK,IAAIV,EAAI,EAAGA,EAAI+X,EAAS9X,OAAQD,IAAK,CACtC,IAAId,EAAI6Y,EAAS/X,GAAGuP,GAAGrQ,EACnBC,EAAI4Y,EAAS/X,GAAGuP,GAAGpQ,EACnBsQ,EAAIsI,EAAS/X,GAAGuP,GAAGE,EACnBC,EAAIqI,EAAS/X,GAAGuP,GAAGG,EAkBvB,QAhBUlN,IAANtD,IACAA,EAAI,QAGEsD,IAANrD,IACAA,EAAI,QAGEqD,IAANiN,IACAA,EAAI,QAGEjN,IAANkN,IACAA,EAAI,QAGsBlN,IAA1BuV,EAAS/X,GAAGuP,GAAGjH,GAAsB,CACrC,IAAIse,GAAS,gDAAeF,EAAY,CAACxnB,EAAGC,EAAGsQ,EAAGC,EAAG1P,IAErD,GAAqB,iBAAV4mB,EAAoB,CAC3B,IAAK,IAAIrmB,EAAI,EAAGA,EAAIwX,EAAS9X,OAAQM,IACjCwX,EAASxX,GAAGwX,SAAW,EAG3BA,EAAS/X,GAAG+X,SAAW,EAEvBmB,oBAAoB5Q,EAAOse,EAC/B,CAEA,IAAK,IAAIrmB,EAAI,EAAGA,EAAIwX,EAAS9X,OAAQM,IACjCwX,EAASxX,GAAGwX,SAAW,CAE/B,CACJ,CAEAH,sBAAwB,CAC5B,CACJ,CACJ,CACJ,CAMA,GAJI/T,EAAE0iB,QACF1iB,EAAEiX,iBAGFjX,EAAE0iB,QAA2B,6BAAjBhD,cAA8C,CAC1D,IAAIxL,EAAW4D,eAEf,GAAuB,GAAnB5D,EAAS9X,OAAa,CACtB,IAAIf,EAAI6Y,EAAS,GAAGxI,GAAGrQ,EACnBC,EAAI4Y,EAAS,GAAGxI,GAAGpQ,EACnBsQ,EAAIsI,EAAS,GAAGxI,GAAGE,EACnBC,EAAIqI,EAAS,GAAGxI,GAAGG,OAEblN,IAANtD,IACAA,EAAI,QAGEsD,IAANrD,IACAA,EAAI,QAGEqD,IAANiN,IACAA,EAAI,QAGEjN,IAANkN,IACAA,EAAI,GAGR,IAAIkX,GAAS,gDAAerD,cAAczc,MAAO,CAAC5H,EAAGC,EAAGsQ,EAAGC,EAAG1P,IAEzC,iBAAV4mB,IACPrD,cAAczc,MAAQ8f,EAE9B,CACJ,CAQA,GANI/iB,EAAEkiB,SAAqB,QAAVliB,EAAEmiB,OACfniB,EAAEiX,iBAEFgG,4BAGAjd,EAAEkiB,SAAWliB,EAAEgjB,UACXvD,UAAW,CACX,IAAIwD,EAAM,IAAI9jB,OAEdS,OAAOsjB,OAAS,WACZrf,YAAW,KACPof,EAAIE,OAAO,GACZ,IACP,EAEAvjB,OAAOwjB,QAAU,WACbC,SAASC,QACb,EAEAL,EAAMrjB,OAAO2jB,KAAK,uDACtB,CACJ,IAwKJ,MAAMC,aAAe,CACjB,IAAO,CAAC,EAAK,aACb,KAAQ,CACJ,OAAU,OACV,IAAO,QAEX,OAAU,CAAC,OAAU,qBACrB,MAAS,CACL,EAAK,gBACL,MAAS,eAEb,GAAM,CACF,EAAK,OACL,EAAK,gBACL,EAAK,YAET,MAAS,CAAC,SAAY,QACtB,QAAW,CAAC,QAAW,QACvB,MAAS,CAAC,QAAW,QACrB,IAAO,CACH,QAAW,WACX,IAAO,cACP,MAAS,aAEb,OAAU,CAAC,MAAS,gBACpB,KAAQ,CAAC,MAAS,QAClB,QAAW,CAAC,MAAS,kBAGzB,SAASC,kBAAkBnf,EAAMrB,EAAO+e,GACpC,IAAI0B,EAcJ,OAXIA,EADA7iB,UAAUyD,GACGzD,UAAUyD,GAAMrB,GAEzBugB,aAAaxB,IAAewB,aAAaxB,GAAY1d,GACxCzD,UAAW2iB,aAAaxB,GAAY1d,IAAQrB,GAC/B,YAApBqB,EAAK8Z,MAAM,EAAG,IAAsC,SAAlB9Z,EAAK8Z,OAAO,GACvCvd,UAAwB,aAAEoC,GAE1BA,EAIdygB,CACX,CAEA,SAASC,oBACL,IAAIvQ,EAAU0E,eAEd,GAAIkJ,qBAAqB5N,IAAYA,EAAQhX,QAAU,EAAG,CACtD,IAAIslB,EAAUC,kBAAkBvO,GAC5BoO,EAAariB,OAAOmI,KAAK8L,EAAQ,GAAG1H,IAExC,IAAK,IAAIvP,EAAI,EAAGA,EAAIulB,EAAQtlB,OAAQD,IAAK,CACrC,IAAImI,EAAOkd,EAAWE,EAAQvlB,IAC1B8G,EAAQmQ,EAAQ,GAAG1H,GAAG8V,EAAWE,EAAQvlB,KACzC6lB,EAAa5O,EAAQ,GAAGN,OAE5BgO,aAAaiB,SAASL,EAAQvlB,GAAI6lB,GAAayB,kBAAkBnf,EAAMrB,EAAO+e,GAClF,CACJ,CACJ,CAEA,SAAS4B,kBACL,IAAK7hB,aAAaW,QAAS,OAC3B,IAAImhB,EAAQ,CAAC,EACb,IAAK,IAAI7R,KAAW6B,GACX7B,EAAQoC,cACiBzV,IAA1BklB,EAAM7R,EAAQc,UAAuB+Q,EAAM7R,EAAQc,SAAW,GAElE+Q,EAAM7R,EAAQc,SAAW,EACzBd,EAAQ8R,OAASD,EAAM7R,EAAQc,QAEvC,CAEA,SAASiR,eACL,IAAK,IAAI5nB,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,SACDwC,IAAtBkV,GAAG1X,GAAGuP,GAAGiS,WACT9J,GAAG1X,GAAGuP,GAAGiS,SAAW,EAGhC,CAEA,SAASqG,WACL,IAAIC,EAASrb,IACbhJ,OAAOgJ,IAAM,WACT,IAAIsb,EAAOnQ,sBACXkQ,IACIC,IACAN,kBACAG,eACIhiB,aAAaS,oBACbmhB,oBAGZ,EACApgB,QAAQtC,MAAO,cACnB,CAIA,SAAS6P,wBACL,IACIqT,EADMlkB,IAAI,cACCyR,wBACXtL,EAAQge,UAAUhe,MACtBA,EAAMC,YAAY,QAAS8d,EAAK9T,OAChCjK,EAAMC,YAAY,OAAQ8d,EAAK9oB,GAC/B+K,EAAMC,YAAY,MAAO8d,EAAKE,OAClC,CAEA,SAASC,kBACL,IAAI/kB,EAAMU,IAAI,cACViQ,EAAW/P,SAASgN,cAAc,OACtCvN,OAAOwkB,UAAYlU,EACnB,IAAI9J,EAAQ8J,EAAS9J,MACrBnG,IAAI,YAAYqN,YAAY4C,GAE5B9J,EAAMC,YAAY,WAAY,YAC9BD,EAAMC,YAAY,SAAU,OAC5BD,EAAMC,YAAY,SAAU,YAE5ByK,wBAEA,IAAIyT,GAAmB,EACvBrU,EAASsU,YAAgBxkB,IAAOukB,GAAmB,CAAK,EACxD9jB,aAAaqP,iBAAiB,WAAY9P,IAAOukB,GAAmB,KACpE9jB,aAAaqP,iBAAiB,aAAc9P,IACxC,IAAKukB,EAAkB,OAEvB,IAAIE,EAAazkB,EAAEqX,QAAU,GAC7B9X,EAAI6G,MAAMmK,OAASkU,EACnB3T,wBACAM,oBACAA,mBAAmB,IAEvB7N,QAAQtC,MAAO,iCACnB,CAEA,SAASyjB,eACL,IAAIC,EAAW/kB,OAAOglB,OACtBhlB,OAAOglB,OAAS,SAAS5kB,GACrB,IAAI6kB,EAAmBhR,GAAGzX,OAE1B,GADAuoB,EAAS3kB,GACL6T,GAAGzX,OAASyoB,EAAkB,CAC9BjB,kBACAG,eACAzN,cACA,IAAItE,EAAU6B,GAAGA,GAAGzX,OAAS,GAC7B,KAAM,MAAO4V,EAAQtG,IAAK,OAG1B,IAAIA,EAAKsG,EAAQtG,GACb3P,EAAQ,SAASG,GACjB,OAAOT,KAAKM,MAAMG,EAAMgW,eAAiBA,aAC7C,EACAxG,EAAGrQ,EAAIU,EAAM2P,EAAGrQ,GAChBqQ,EAAGpQ,EAAIS,EAAM2P,EAAGpQ,GACZ0W,EAAQ8S,eACRpZ,EAAGE,EAAI7P,EAAM2P,EAAGE,GAChBF,EAAGG,EAAI9P,EAAM2P,EAAGG,IAGpBjM,OAAOmU,uBAAwB,EAC/BgR,sBACJ,CACJ,CACJ,CAEA,SAASC,mBACL,IAAIC,EAAOtR,EACX/T,OAAO+T,EAAI,SAASb,GAChB,IAAItX,EAAS,IAAIypB,EAAKnS,GAEtB,GAAa,SAAVA,EAAmBtX,EAAOkQ,GAAGwZ,QAAU,OACrC,GAAa,SAAVpS,EAAmBtX,EAAOkQ,GAAGjI,KAAO,oBACvC,GAAa,WAAVqP,EAAqB,CACzB,IAAIxN,EAAUnG,OAAOmG,QAAQ9J,EAAOkQ,IACpCpG,EAAQjJ,OAAO,EAAG,EAAG,CAAC,WAAW,IACjCb,EAAOkQ,GAAKvM,OAAOgmB,YAAY7f,EACnC,KACkB,UAAVwN,IAAoBtX,EAAOkQ,GAAGwK,YAAa,GAGnD,OADA1a,EAAO4pB,OAAS,WAAY,EACrB5pB,CACX,EACA+H,QAAQtC,MAAO,kBACnB,CAEA,SAAS8b,mBAAmBsI,GACxB,IAAIC,EAAY,IAAInmB,OACpB,GAAgCR,MAA5ByQ,eAAeiW,GACf,OAAO,EAEXC,EAAYC,YAAYnW,eAAeiW,IACvC7P,MACA,IAAK,IAAIrZ,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACvB0X,GAAG1X,GAAGiY,QACFP,GAAG1X,GAAG+X,WACN8B,IAAI,MAAQ7Z,EAAI,qBAChB4Z,IAAI,MAAQ5Z,EAAI,oBAChB0X,GAAG1X,GAAG+X,UAAW,GAEvB,IAAIsR,EAAQ,EACdC,EAAQ,EACRC,EAAQ,EACRC,EAAQ,EACZxpB,EAAI,EAEJ,IADA,IAAIypB,EAAW/R,GAAGzX,YACc,IAAlBkpB,EAAUnpB,IAAqB,CACzC,IAAI0pB,EAAWhS,GAAGzX,OAIlB,IAAKqI,SAHLuR,IAAI,MAAQ6P,EAAW,kBACvB9P,IAAI,MAAQ8P,EAAW,mBACvBhS,GAAGgS,GAAY,IAAIlS,EAAE2R,EAAUnpB,GAAG2W,QACpBwS,EAAUnpB,GACpB0X,GAAGgS,GAAUphB,OAAS6gB,EAAUnpB,GAAGsI,YAEL,IAAvBoP,GAAGgS,GAAUna,GAAI,QACU,IAAvBmI,GAAGgS,GAAUna,GAAI,IACf,GAALvP,GACAqpB,EAAQ3R,GAAGgS,GAAUna,GAAGrQ,EACxBqqB,EAAQ7R,GAAGgS,GAAUna,GAAGpQ,EACxBmqB,EAAQ5R,GAAGgS,GAAUna,GAAGrQ,EACxBsqB,EAAQ9R,GAAGgS,GAAUna,GAAGpQ,OACU,IAAvBuY,GAAGgS,GAAUna,GAAI,QACU,IAAvBmI,GAAGgS,GAAUna,GAAI,IACxB8Z,GAAS3R,GAAGgS,GAAUna,GAAGE,EAAI,EAC7B6Z,GAAS5R,GAAGgS,GAAUna,GAAGE,EAAI,EAC7B8Z,GAAS7R,GAAGgS,GAAUna,GAAGG,EAAI,EAC7B8Z,GAAS9R,GAAGgS,GAAUna,GAAGG,EAAI,KAGrC2Z,EAAQ/pB,KAAK4T,IAAImW,EAAO3R,GAAGgS,GAAUna,GAAGrQ,GACxCqqB,EAAQjqB,KAAK4T,IAAIqW,EAAO7R,GAAGgS,GAAUna,GAAGpQ,GACxCmqB,EAAQhqB,KAAKgM,IAAIge,EAAO5R,GAAGgS,GAAUna,GAAGrQ,GACxCsqB,EAAQlqB,KAAKgM,IAAIke,EAAO9R,GAAGgS,GAAUna,GAAGpQ,QACN,IAAvBuY,GAAGgS,GAAUna,GAAI,QACU,IAAvBmI,GAAGgS,GAAUna,GAAI,IACxB+Z,EAAQhqB,KAAKgM,IAAIge,EAAO5R,GAAGgS,GAAUna,GAAGrQ,EAAIwY,GAAGgS,GAAUna,GAAGE,GAC5D+Z,EAAQlqB,KAAKgM,IAAIke,EAAO9R,GAAGgS,GAAUna,GAAGpQ,EAAIuY,GAAGgS,GAAUna,GAAGG,MAG1E1P,GACV,CACA6Z,IAAI,yBACJA,IAAI,yBACJA,IAAI,qCACJD,IAAI,0BACJA,IAAI,0BACJA,IAAI,sCACJ+P,MAAO,EACPC,iBAAkB,EAClBC,6BAA8B,EAC9BC,OAASC,KACTC,OAASC,KAET,IAAIC,EAAUH,KACVI,EAAUF,KAEdG,SAAWC,QACXC,SAAWC,QACXC,SAAWN,EACXO,SAAWN,EAMX,IALA,IAAIO,EAAKprB,KAAKM,MAAM,EAAYmW,eAAiBA,cAC7C4U,EAAKrrB,KAAKM,MAAM,EAAYmW,eAAiBA,cAC7ClG,EAAOvQ,KAAKM,OAAO8qB,GAAMrB,EAAQC,GAAS,GAAKvT,eAAiBA,cAChEjG,EAAOxQ,KAAKM,OAAO+qB,GAAMpB,EAAQC,GAAS,GAAKzT,eAAiBA,cAE3DlM,EAAK4f,EAAU5f,EAAK6N,GAAGzX,OAAQ4J,IAAM,CAC1C,QAA8B,IAAnB6N,GAAG7N,GAAI0F,GAAM,IAAmB,CACvC,IAAIqb,EAAUlT,GAAG7N,GAAI0F,GAAGmK,IACxBhC,GAAG7N,GAAIoO,QAAS,EAChBP,GAAG7N,GAAI0F,GAAGmK,IAAMqC,cAAcrE,GAAG7N,GAAI0F,GAAGmK,KACxChC,GAAG7N,GAAIoO,QAAS,EAChB,IAAK,IAAI4S,EAAKpB,EAAUoB,EAAKnT,GAAGzX,OAAQ4qB,IACpC,IAAKviB,SAASoP,GAAGmT,GAAItb,GACe,iBAArBmI,GAAGmT,GAAItb,GAAGjH,QACboP,GAAGmT,GAAItb,GAAGjH,QAAUsiB,IACpBlT,GAAGmT,GAAItb,GAAGjH,OAASoP,GAAG7N,GAAI0F,GAAGmK,IAKjD,MAC4B,IAAjBhC,GAAG7N,GAAI0F,GAAI,QACU,IAAjBmI,GAAG7N,GAAI0F,GAAI,IAClBqK,IAAI,MAAQ/P,EAAK,UAAY6N,GAAG7N,GAAI0F,GAAGrQ,EAAI,KAC3C0a,IAAI,MAAQ/P,EAAK,UAAY6N,GAAG7N,GAAI0F,GAAGpQ,EAAI,KAC3CuY,GAAG7N,GAAI0F,GAAGrQ,GAAK2Q,EACf6H,GAAG7N,GAAI0F,GAAGpQ,GAAK2Q,EACf4H,GAAG7N,GAAIof,SACPpP,IAAI,MAAQhQ,EAAK,UAAY6N,GAAG7N,GAAI0F,GAAGrQ,EAAI,KAC3C2a,IAAI,MAAQhQ,EAAK,UAAY6N,GAAG7N,GAAI0F,GAAGpQ,EAAI,KAEvD,CAIA,IAFAurB,EAAKprB,KAAKM,OAAOsqB,EAAUM,UAAYzU,eAAiBA,cACxD4U,EAAKrrB,KAAKM,OAAOuqB,EAAUM,UAAY1U,eAAiBA,cAC/C/V,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACvB0X,GAAG1X,GAAG8qB,aAAepT,GAAG1X,GAAGiY,QAAUP,GAAG1X,GAAG+X,WAAa0B,WAAW/B,GAAG1X,KAAO4pB,mBAC7ElS,GAAG1X,GAAGuP,GAAGrQ,GAAKwrB,EACdhT,GAAG1X,GAAGuP,GAAGpQ,GAAKwrB,GAMtB,OAHAH,UAAYE,EACZD,UAAYE,EACZzQ,KAAI,IACG,CACX,CAEA,SAAS6Q,4BAA4BC,GAGjC5jB,QAAQtC,MAAO,2BAEf,MAAMmmB,EAAsB,gDACtBC,EAAsB,+BAE5B,IAAIC,EAAcH,EAAQ3qB,MAAM,OAE5B+qB,EAAiB,KAErB3nB,OAAOiU,GAAK,IAAInP,MAChB,IAAItG,EAAQ,EACZ,KAAMA,EAAQkpB,EAAYlrB,OAAQgC,IAAS,CACvC,IAAIykB,EAAayE,EAAYlpB,GAG7B,GAAkE,GAA/DykB,EAAWtmB,WAAW,KAAM,IAAIA,WAAW,KAAM,IAAIH,OAAc,SAGtE,IAAwC,GAApCymB,EAAWjT,QAAQ,aAAoB,CACvChQ,OAAO6O,MAAQoU,EAAWrmB,MAAM,OAAO,GAAG4hB,MAAM,GAAI,GACpD5P,YAAYvL,MAAQwL,MACpB,QACJ,CACK,GAAkB,iCAAdoU,EAAgD,SACpD,IAAoD,GAAhDA,EAAWjT,QAAQ,yBAAgC,CACxD,IAAI4X,EAAS3E,EAAWrmB,MAAM,KAAK,GAAGA,MAAM,eAAe,GAAG4hB,MAAM,GAAI,GACxEqJ,UAAUxkB,MAAQukB,EAClBtkB,QAAQ,QAAQuL,uCAAwCiZ,WACxD3D,eACAzN,cACA,QACJ,CAEA,IAAsC,GAAnCuM,EAAWjT,QAAQ,YAAmB,CACrC,IAAI+X,EAAWN,EAAoBhpB,KAAKwkB,GACxC0E,EAAiB,IAAI5T,EAAEgU,EAAS,IAChC9T,GAAGA,GAAGzX,QAAUmrB,EAEhB,IAAItS,EAAO4N,EAAWrmB,MAAM,KAC5B,GAAIyY,EAAK7Y,OAAS,EAAG,CAIjBmH,QAAQpC,KAAM,yBAAyB8T,EAAK7Y,YAAY6Y,KACxD,QACJ,CACA4N,EAAa5N,EAAK,EACtB,CAGA,IAAI2S,EAAgBR,EAAoB/oB,KAAKwkB,GAE7C,GAAsB,OAAlB+E,EAAwB,CACxBrkB,QAAQpC,KAAM,8CAA8C0hB,8BAC5D,QACJ,CACA,IAAI5jB,EAAM2oB,EAAc,GACpB3kB,EAAQ2kB,EAAc,GAAGrrB,WAAW,MAAO,KAEtB0G,EADT,KAAZA,EAAM,GACO,QAATA,GACa,SAATA,KACuB,GAAvBA,EAAM2M,QAAQ,KAAoBiY,WAAW5kB,GACxCZ,SAASY,IAGdA,EAAMmb,MAAM,GAAI,GAAG7hB,WAAW,MAAO,KAEjDgrB,EAAe7b,GAAGzM,GAAOgE,CAE7B,CACJ,CAEA,SAAS6kB,4BAA4BC,EAASC,EAAWC,GACrD,IAAkD,GAA9CA,EAASrY,QAAQ,yBACjBsX,4BAA4Be,QAC1B,IAA2C,IAAvCA,EAASrY,QAAQ,iBAAyB,CAChDhQ,OAAOsoB,UAAY,GACnB,IAAK,IAAI3gB,KAAO0gB,EAASE,MAAM,YAC3BD,UAAUxqB,KAAK6J,EAAI6W,MAAM,GAAI,IAEjC7a,QAAQtC,MAAO,0BAA0BinB,UAAU9rB,cACvD,KAAM,CACFmH,QAAQrC,OAAQ,uBAAuBK,eAAewmB,KAAW3mB,gCAAgCG,eAAeymB,KAAa5mB,eAAe6mB,KAC5I,IAAKnkB,QAAQmkB,EAAU,CACvB,MAAMjoB,GAAIkD,QAAQ,cAAeC,UAAWC,QAAQC,MAAMrD,GAAIuD,QAAQvC,KAAM,mBAAmB+mB,aAAmBC,uBAA+BC,IAAW,CAChK,CACJ,CAEA,SAASG,YAAYC,EAAQpgB,EAAK8G,GAC9B,OAAO,IAAIzG,SAAQ,SAAUuH,EAASyY,GAClC,IAAIC,EAAM,IAAIC,eACdD,EAAIhF,KAAK8E,EAAQpgB,GACjBsgB,EAAIE,iBAAiB,eAAgB,qCACrCF,EAAIxa,OAAS,WACL2a,KAAKvgB,QAAU,KAAOugB,KAAKvgB,OAAS,IACpC0H,EAAQ,CAAC1H,OAAQ,IAAK8f,SAAUM,EAAIN,WAEpCK,EAAO,CACHngB,OAAQugB,KAAKvgB,OACbwgB,WAAYJ,EAAII,YAG5B,EACAJ,EAAIpK,QAAU,WACVmK,EAAO,CACHngB,OAAQugB,KAAKvgB,OACbwgB,WAAYJ,EAAII,YAExB,EACAJ,EAAIK,KAAK7Z,EACb,GACJ,CAEA,SAAS8Z,kBACL,IACI,IAAIC,EAAc7oB,IAAI,eACtB,IAAI,IAAI9D,EAAI,EAAGA,EAAIgP,YAAY/O,OAAQD,IAAK,CACxC,IAAI2O,EAAQK,YAAYhP,GACpB4O,EAAcD,EAAM,GACpBE,EAAaF,EAAM,GACnBG,EAAcH,EAAM,GACxBge,EAAYnf,WAAa,+EACuCoB,QAAkBC,4EAC3BC,sEAExCD,oFAInB,CACAzH,QAAQtC,MAAO,sBACnB,CACA,MAAMjB,GAAI,CACd,CAEA0H,eAAe8B,mBAAmBue,EAASC,EAAW7e,EAAW,MAC7D,IAAI8e,QAAiBG,YAAY,OAAQ,kBAAkBW,YAAahB,GACxE,GAAuB,KAAnBE,EAAS9f,OAAb,CAKA,IACI2f,4BAA4BC,EAASC,EAAWC,EAASA,WACjB,GAApCF,EAAQnY,QAAQ,kBAAsE,GAA7CmY,EAAQnY,QAAQ,0BACzDiZ,kBAEJjpB,OAAO4W,aAAeA,aACL,QAAbwR,GAAoC,QAAbA,IACvBgB,cAAe,EACE,QAAbhB,IACAlU,aAAc,EACdC,uBAAwB,EACxBkV,cAGZ,CAAE,MAAOjpB,GACLoD,QAAQC,MAAMrD,GACdkD,QAAQ,4FAA8FC,SAE1G,CACgB,MAAZgG,GACAA,GArBJ,KAHqB,QAAb6e,EAAqB9kB,QAAQ,0JAA4JC,UACvK,QAAb6kB,GAAqB9kB,QAAQ,gGAAiGC,SAyB/I,CAEA,IAAI+lB,uBAAwB,EAC5B,SAASC,qBAEDD,wBACJA,uBAAwB,EAKxBtpB,OAAOyJ,cAAgBG,mBACvBjG,QAAQtC,MAAO,yBACnB,CAiBA,SAASmoB,uBACL,IAAIjH,KAAOviB,OAAOypB,gBAAgBtiB,WAAWlK,QAAQ,oCAAqC,2CAC1FslB,KAAO,IAAMA,KAAO,IACpB,IAAImH,QAAUvlB,KAAKoe,MACfoH,QAAU3pB,OAAO4pB,YAErB5pB,OAAO6pB,+BAAgC,EAKvC7pB,OAAO4pB,YAAc,SAASE,EAAMzmB,GAChC,OAAIwmB,+BAAyC,YAARC,EAE1B,iBADsB,GAAGzmB,IAAQ1G,WAAW,IAAK,mCAGrDgtB,QAAQG,EAAMzmB,EACzB,EAEArD,OAAO+pB,8BAAgC,SAASxtB,GAC5C,IAEIytB,EAAqB,EAIzB,OAL0C,GAD3B9R,eACiB1b,QAAgB2F,aAAaW,UAGzDknB,EAAqB,GAElBztB,GAAKytB,IAAuBztB,EAAIytB,GAAsB,GAAK,CACtE,EAEAhqB,OAAOypB,gBAAkB,WACrBI,+BAAgC,EAChC,IAAII,EAAa,GAEb3V,EAAW4D,eACXgS,EAAsC,GAAnB5V,EAAS9X,QAAgB2F,aAAaW,QACzDqnB,EAAuB7V,EAAS9X,QAAU,GAAM2F,aAAac,WAEjE,IAAK,IAAI1G,EAAI,EAAGA,EAAI+X,EAAS9X,OAAQD,IACP,WAAtB+X,EAAS/X,GAAG2W,SACZiX,EAAsB,GAI9B,GAAID,EAAiB,CACjB,IAAIxkB,EAAUnG,OAAOmG,QAAQ4O,EAAS,GAAGxI,IACzCpG,EAAQjJ,OAAO,EAAG,EAAG,CAAC,OAAS6X,EAAS,GAAG4P,SAC3C5P,EAAS,GAAGxI,GAAKvM,OAAOgmB,YAAY7f,EACxC,CAEA,IAAKykB,EACD,IAAK,IAAI5tB,EAAI,EAAGA,EAAI+X,EAAS9X,OAAQD,IACjC0tB,EAAWnsB,KAAKwW,EAAS/X,GAAGuP,GAAGiS,iBAExBzJ,EAAS/X,GAAGuP,GAAGiS,SAgB9B,GAZuB,GAAnBzJ,EAAS9X,QAAuC,UAAtB8X,EAAS,GAAGpB,UACmB,GAAtD,EAAC,EAAM,QAAQlD,QAAQsE,EAAS,GAAGxI,GAAGwK,YACrC1R,WAAWzD,yBAAyB,GAAK,aAEzCyD,WAAWzD,yBAAyB,GAAK,gBAIjDuoB,UAEIQ,UAAwB5V,EAAS,GAAGxI,GAAGse,MAEtCD,EACD,IAAK,IAAI5tB,EAAI,EAAGA,EAAI+X,EAAS9X,OAAQD,IACjC+X,EAAS/X,GAAGuP,GAAGiS,SAAWkM,EAAWI,QAI7CrM,kBAEA6L,+BAAgC,CACpC,EACAlmB,QAAQtC,MAAO,0BACnB,CAEA,SAASipB,eACLtqB,OAAOuqB,QAAU,SAASlrB,EAAKgE,GAE3BrD,OAAOX,GAAOgE,EACdiQ,aACJ,EACA3P,QAAQtC,MAAO,kBACnB,CAaA,SAASmpB,yBACL,IAAIC,EAAalqB,SAASgN,cAAc,OACxCkd,EAAW1d,aAAa,QAAS,WAEjC,IAAI0T,EAAQlgB,SAASgN,cAAc,OACnCkT,EAAM1W,UAAY,eAClB0W,EAAM1T,aAAa,KAAM,WACzB0d,EAAW/c,YAAY+S,GAGvB,IAAI7G,EAAMrZ,SAASgN,cAAc,OACjCqM,EAAI7M,aAAa,KAAM,SACvB0d,EAAW/c,YAAYkM,GAGvB,IAAI8Q,EAAanqB,SAASgN,cAAc,SAoCxC,SAASod,EAAQ9mB,EAAM+mB,GAAkB,GACrC,IAAIC,EAAMtqB,SAASgN,cAAc,OACjCsd,EAAI9gB,UAAYlG,EACZ+mB,GACAC,EAAIrkB,MAAMC,YAAY,QAAS,WAEnCokB,EAAI9d,aAAa,QAAS,wBAC1B6M,EAAI7P,WAAa,OACjB6P,EAAI7P,WAAa8gB,EAAI3d,SACzB,CACA,SAAS4d,EAAeC,EAASC,EAAQ3rB,GACrC4rB,sBAAsBF,GAAW,CAACC,EAAQ3rB,EAC9C,CACA,SAAS4T,EAAUyE,EAASwT,EAAY3hB,EAAU/C,EAAQ,IACtDgH,iBAAiB,WAAa0d,GAAc3hB,EAE5C,IAAI+D,EAAS/M,SAASgN,cAAc,SACpCD,EAAOP,aAAa,OAAQ,UAC5BO,EAAOP,aAAa,KAAM,QAAUme,GACpC5d,EAAOP,aAAa,QAAS2K,GAC7BpK,EAAOP,aAAa,UAAW,6BAA6Bme,qEAC5D5d,EAAOP,aAAa,QAAS,2BAC7BO,EAAOP,aAAa,QAASvG,GAE7BoT,EAAI7P,WAAauD,EAAOJ,SAC5B,CACA,SAASie,EAAgBC,EAAWC,EAAUC,EAASjsB,EAAK+N,EAAc7D,EAAW,UACjF,SAASgiB,EAAOlpB,GACZe,aAAakoB,EAASjpB,GACtBF,aAAa9C,GAAOgD,CACxB,CACA4Q,EAAUmY,EAAW,GAAGhe,UAAqB,KAAOme,GAAO,GAAOhiB,GAAS,EAAI,IAC/E0J,EAAUoY,EAAU,GAAGje,WAAsB,KAAOme,GAAO,GAAQhiB,GAAS,EAAK,GACrF,CAGA,SAASiiB,EAASnpB,GACde,aAAa,gBAAiBf,GAC9BF,aAAaK,SAAWH,CAC5B,CA1EAqoB,EAAW3gB,UAAY,qyBAgCvBxJ,SAASkrB,KAAK/d,YAAYgd,GA2C1B9Q,EAAI7P,WAAa,yEACjBkJ,EAAU,eAAgB,mBAAmB,KACzC,IAAIyY,EAAU,GACd,IAAK,IAAIrsB,KAAOE,OAAOmI,KAAKzF,cACe,WAAlC5C,EAAImf,MAAM,EAAG,KAClBkN,EAAQ5tB,KAAKuB,GACb4C,aAAaC,WAAW7C,IAE5BiE,QAAQ,uCAAuCooB,EAAQlvB,kBAAmB,WAC1EmH,QAAQrC,OAAQ,sBAAsBoqB,IAAU,GACjD,gBACH9R,EAAI7P,WAAa,OAEjB+gB,EAAe,MAAO,CAAC,EAAG,EAAG,GAAI,YACjCH,EAAQ,cACR1X,EAAU,OAAQ,SAAS,IAAMuY,EAAS,KAC1CvY,EAAU,QAAS,SAAS,IAAMuY,EAAS,KAC3CvY,EAAU,SAAU,SAAS,IAAMuY,EAAS,KAG5CV,EAAe,WAAY,EAAC,GAAM,GAAQ,kBAC1CH,EAAQ,eAAe,GACvBQ,EAAgB,OAAQ,OAAQ,sBAAuB,iBAAkB,YAGzEL,EAAe,UAAW,EAAC,GAAM,GAAQ,kBACzCH,EAAQ,aACRQ,EAAgB,OAAQ,OAAQ,oBAAqB,iBAAkB,WAGvEL,EAAe,UAAW,EAAC,GAAM,GAAQ,WACzCH,EAAQ,eACRQ,EAAgB,OAAQ,OAAQ,eAAgB,UAAW,WAG3DL,EAAe,aAAc,EAAC,GAAM,GAAQ,cAC5CH,EAAQ,mBACRQ,EAAgB,OAAQ,OAAQ,kBAAmB,aAAc,cAGjEL,EAAe,aAAc,EAAC,GAAM,GAAQ,sBAC5CH,EAAQ,oBACRQ,EAAgB,OAAQ,OAAQ,0BAA2B,qBAAsB,cAGjFL,EAAe,aAAc,EAAC,GAAM,GAAQ,cAC5CH,EAAQ,gBAAgB,GACxBQ,EAAgB,MAAO,KAAM,kBAAmB,aAAc,cAG9DL,EAAe,4BAA6B,EAAC,GAAM,GAAQ,uBAC3DH,EAAQ,iBACRQ,EAAgB,MAAO,KAAM,2BAA4B,sBAAuB,6BAGhFL,EAAe,kBAAmB,EAAC,GAAM,GAAQ,qBACjDH,EAAQ,uBACRQ,EAAgB,MAAO,KAAM,yBAA0B,oBAAqB,mBAAoB5iB,GAAWuM,6BAA6BvM,KAGxIuiB,EAAe,WAAY,EAAC,GAAM,GAAQ,cAC1CH,EAAQ,eACRQ,EAAgB,UAAW,WAAY,gBAAiB,aAAc,YAAa5iB,GAAWsM,6BAA6BtM,KAG3HuiB,EAAe,2BAA4B,EAAC,GAAM,GAAQ,sBAC1DH,EAAQ,0BACRQ,EAAgB,MAAO,KAAM,0BAA2B,qBAAsB,4BAG9EnrB,OAAO2rB,kBAAoBlB,EAC3BlqB,SAASsb,KAAKnO,YAAY+c,GAC1BmB,4BACAjoB,QAAQtC,MAAO,2BACnB,CA1RArB,OAAOmE,KAAO,SAASoe,QACUxjB,IAAzBiB,OAAOyJ,eACPye,4BAA4B,KAAM,KAAM3F,GACxCgH,qBAGAvpB,OAAOmE,KAAOD,SAIdV,QAAQO,IAAIwe,EAGpB,EA6FAviB,OAAO2rB,uBAAoB5sB,EAkL3B,IAAIksB,sBAAwB,CAAC,EAoB7B,SAAStc,oBACqB5P,IAAtB4sB,mBAAiCnB,yBAErC7O,YAAYnV,MAAMkR,QAAU,QAC5BiU,kBAAkBnlB,MAAMkR,QAAU,QAClCmU,SAAW,0CACf,CAEA,SAASC,gBACL,IAAK,IAAIrmB,KAASlG,OAAOmG,QAAQzE,UAAgB,MAAI,CACjD,IAAI8qB,EAAStpB,SAASgD,EAAM,IACxBumB,EAAWvmB,EAAM,GAEjBsmB,EAAS,IACTC,EAAWA,EAAS/uB,QAAQ,qBAAsB,qCAClDgE,UAAgB,KAAE8qB,GAAUC,IAGhB,IAAZD,IACJ9qB,UAAU,YAAY8qB,GAAUC,EACpC,CACAroB,QAAQtC,MAAO,qBACnB,CAEA,SAAS4qB,sBACL,IAAIC,EAAmBjrB,UAAiC,sBAAI,CACxD,EAAG,+DACH,EAAG,+DACH,EAAG,+DACH,EAAG,+DACH,EAAG,+DACH,EAAG,+DACH,EAAG,+DACH,EAAG,+DACH,EAAG,+DACH,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,GACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,gEACJ,GAAI,iEAER,IAAK,IAAI1E,EAAI,EAAGA,EAAI,GAAIA,IACpB2vB,EAAiB3vB,GAAK,aAAc2vB,EAAiB3vB,0CAEzDoH,QAAQtC,MAAO,4BACnB,CAEA,SAAS8qB,oBACL,IAAIC,EAAMpsB,OAAOqsB,cACjBrsB,OAAOqsB,cAAgB,CAACvC,EAAMzmB,KAC1B,IAAiD,IAA7C,CAAC,yBAAyB2M,QAAQ8Z,GAAc,CAChD,IAAIwC,EAAYrrB,UAAU6oB,GAAMzmB,GAChC,YAAkBtE,IAAdutB,EAAgCC,YACxBD,CAChB,CAAO,MAAW,gBAARxC,GACO,GAAVzmB,EAAoBpC,UAAU,iBAAiB,GAC3CorB,cAAc,UAAWhpB,GACnB,cAARymB,GACQ,GAAVzmB,EAAoBpC,UAAU,eAAe,GACzCorB,cAAc,QAAShpB,GACrB+oB,EAAItC,EAAMzmB,EAAM,EAEjCM,QAAQtC,MAAO,uBACnB,CAEA,SAASmrB,aAAa5O,GAClBiC,UAAY,EAEZlc,QAAQvC,KAAM,eAAewc,KAC7Bta,QAAQ,8BAA8Bsa,2BAAiCzd,QAAQwd,OAAOC,0CAA2C,UACrI,CAEA,SAAS6O,qBAAqB9O,GAC1B,IACIC,EADA8O,EAAQ/O,EAAO/gB,MAAM,MAEzB,IAAI,IAAIL,EAAI,EAAGA,EAAImwB,EAAMlwB,OAAQD,IAAK,CAClC,IAAIowB,EAAOD,EAAMnwB,GACjB,IAAgC,GAA7BowB,EAAK3c,QAAQ,YAAmB,SAEnC,IAAI4c,EAAQD,EAAK/vB,MAAM,KACvBghB,EAAUgP,EAAMA,EAAMpwB,OAAS,GAC/B,KACJ,CAEA,IAAIqwB,EAAWjP,EAAQhhB,MAAM,KACzBkwB,EAAkB3sB,QAAQwd,OAAOC,QAAQhhB,MAAM,KAGnD,GAAGiwB,EAASrwB,OAASswB,EAAgBtwB,OAAQ,OAAOgwB,aAAa5O,GAEjE,IAAImP,EAAiBlxB,KAAK4T,IAAIod,EAASrwB,OAASswB,EAAgBtwB,QAChE,IAAK,IAAID,EAAI,EAAGA,EAAIwwB,EAAgBxwB,IAIhC,GAHckG,SAASoqB,EAAStwB,IACXkG,SAASqqB,EAAgBvwB,IAEjB,OAAOiwB,aAAa5O,GAErDja,QAAQvC,KAAM,sBAClB,CAEA0G,eAAeklB,kBAEXP,4BADiBtkB,GAAGC,eAAe,CAAGC,IAAKlI,QAAQwd,OAAOsP,YAAc3kB,OAAMlI,GAAKoD,QAAQC,MAAMrD,MACvE8sB,aAC9B,CAEA,SAASC,oBACL,IAAIC,EAAW1e,OAAO,0CAA2C,KACjE,GAAgB,MAAZ0e,GAAgC,KAAZA,OAAyB,CAC7C,IAAIC,EAASxxB,KAAKI,MAAMmxB,GAAY,IACpC,CACI,IAAIE,EAAiB,iCACrB,IAAIC,GAAY,EAEhB,IADA3X,MACKrZ,EAAI,EAAGA,EAAI0X,GAAGzX,OAAQD,IACnB0X,GAAG1X,GAAGiY,QACFP,GAAG1X,GAAG+X,UACF0B,WAAW/B,GAAG1X,MACIwC,MAAdkV,GAAG1X,GAAGuP,GAAGE,IACToK,IAAI,MAAQ7Z,EAAI,wBAA0BA,EAAI,UAAY8wB,EAASC,GACnEnX,IAAI,MAAQ5Z,EAAI,UAAY0X,GAAG1X,GAAGuP,GAAGE,EAAI,KACrCiI,GAAG1X,GAAGuP,GAAGE,EAAIqhB,GAAUxxB,KAAKM,MAAM8X,GAAG1X,GAAGuP,GAAGE,EAAIqhB,EAAS/a,eAAiBA,gBACzEib,GAAY,IAEFxuB,MAAdkV,GAAG1X,GAAGuP,GAAGG,IACTmK,IAAI,MAAQ7Z,EAAI,wBAA0BA,EAAI,UAAY8wB,EAASC,GACnEnX,IAAI,MAAQ5Z,EAAI,UAAY0X,GAAG1X,GAAGuP,GAAGG,EAAI,KACrCgI,GAAG1X,GAAGuP,GAAGG,EAAIohB,GAAUxxB,KAAKM,MAAM8X,GAAG1X,GAAGuP,GAAGG,EAAIohB,EAAS/a,eAAiBA,gBACzEib,GAAY,IAEFxuB,MAAdkV,GAAG1X,GAAGuP,GAAGrQ,IACT2a,IAAI,MAAQ7Z,EAAI,wBAA0BA,EAAI,UAAY8wB,EAASC,GACnEnX,IAAI,MAAQ5Z,EAAI,UAAY0X,GAAG1X,GAAGuP,GAAGrQ,EAAI,KACrCwY,GAAG1X,GAAGuP,GAAGrQ,EAAI4xB,GAAUxxB,KAAKM,MAAM8X,GAAG1X,GAAGuP,GAAGrQ,EAAI4xB,EAAS/a,eAAiBA,gBACzEib,GAAY,IAEFxuB,MAAdkV,GAAG1X,GAAGuP,GAAGpQ,IACT0a,IAAI,MAAQ7Z,EAAI,wBAA0BA,EAAI,UAAY8wB,EAASC,GACnEnX,IAAI,MAAQ5Z,EAAI,UAAY0X,GAAG1X,GAAGuP,GAAGpQ,EAAI,KACrCuY,GAAG1X,GAAGuP,GAAGpQ,EAAI2xB,GAAUxxB,KAAKM,MAAM8X,GAAG1X,GAAGuP,GAAGpQ,EAAI2xB,EAAS/a,eAAiBA,gBACzEib,GAAY,KAGpC9W,KAAI,GACJnT,QAAQ,yDAA2D+pB,EAAS,KAAOD,EAAW,sBAAuB7W,cAChHgX,GACDjqB,QAAQ,+GAAgHkT,cAC5HrC,uBAAwB,EACxBD,aAAc,EACdZ,aACJ,CACJ,CACJ,CACA,SAASka,sBACLxtB,OAAOytB,aAAeN,kBACtBxpB,QAAQtC,MAAO,0BACnB,CAEA,SAASgV,gBAAgBhT,GACrB,OAAOA,EAAM1G,WAAW,IAAK,QAAQA,WAAW,IAAK,QAAQA,WAAW,IAAK,SACjF,CAEA,SAAS+wB,sBACL,IAAIC,EAAM3tB,OAAO4tB,eACjB5tB,OAAO4tB,eAAiB,KACpB,IAAIhyB,EAAS+xB,IACTrZ,EAAW4D,eACf,IAAK,IAAI3b,EAAI,EAAGA,EAAI+X,EAAS9X,OAAQD,IAAK,CACtC,IAAIoD,EAAM2U,EAAS/X,GACfmL,EAAOnI,OAAOmI,KAAK/H,EAAImM,IAE3B,IAAK,IAAIhP,EAAI,EAAGA,EAAI4K,EAAKlL,OAAQM,IACC,iBAAnB6C,EAAImM,GAAGpE,EAAK5K,MACnB6C,EAAImM,GAAGpE,EAAK5K,IAAMuZ,gBAAgB1W,EAAImM,GAAGpE,EAAK5K,KAG1D,CACA,OAAOlB,CAAM,EAEjB+H,QAAQtC,MAAO,yBACnB,CAEA,SAASwsB,iCACL7tB,OAAOod,4BAA8BA,2BACzC,CAlPApd,OAAO4rB,0BAA4B,KAI/B,IAAK,IAAInmB,KAASlG,OAAOmG,QAAQulB,uBAAwB,CACrD,IAAI6C,EAAWroB,EAAM,GACjBulB,EAASvlB,EAAM,GAAG,GAClBpG,EAAMoG,EAAM,GAAG,GAEfsoB,EAAa5rB,aAAa9C,GAC9B,IAAK,IAAIgE,KAAS2nB,EACdvqB,OAAO,SAASqtB,KAAYzqB,KAAS0J,aAAa,QAVvC,2BAYftM,OAAO,SAASqtB,KAAYC,KAAchhB,aAAa,QAXxC,wDAYnB,GAsOJ,IAAIihB,uBAAyB,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACrDC,sBAAwB,EACxBC,wBAA0B,GAE9B,SAASC,2BACL,IAAItxB,EAAM,GACNkZ,EAAQxV,SAASiiB,uBAAuB,OACxCjmB,EAAI,EAMR,IAJI4F,aAAaW,SACbvG,IAGGA,EAAIwZ,EAAMvZ,OAAQD,IACrBM,EAAIiB,KAAKiY,EAAMxZ,GAAGmhB,WAAW,IAGjC,OAAO7gB,CACX,CAEA,SAASuxB,oBACL,IAAIrY,EAAQoY,2BAEZ,IAAK,IAAI5xB,EAAI,EAAGA,EAAIwZ,EAAMvZ,OAAQD,IAAK,CACnC,IAAIkhB,EAAO1H,EAAMxZ,GAEjBkhB,EAAKmH,YAAc,WACfoJ,uBAAuBnyB,KAAKI,MAAMM,EAAI,KAAO,EAC7C8xB,6BACJ,EAEA5Q,EAAK6Q,aAAe,WAChBL,qBAAuBpyB,KAAKI,MAAMM,EAAI,GACtC8xB,6BACJ,EAEA5Q,EAAK8Q,aAAe,WAChBN,sBAAwB,EACxBI,6BACJ,CACJ,CACJ,CAEA,SAASA,8BACL,IAAItY,EAAQoY,2BAGZ,IAAK,IAAI5xB,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAEzB,IAAI4jB,EAAQ,GAGR6N,uBAAuBzxB,KACvB4jB,EAAQ,kBACK,GAATxZ,QAAYwZ,EAAQ,oBAG5BpK,EAAU,EAAJxZ,EAAQ,GAAGiK,MAAM4Z,gBAAkBD,EACzCpK,EAAU,EAAJxZ,EAAQ,GAAGiK,MAAM4Z,gBAAkBD,EACzCpK,EAAU,EAAJxZ,EAAQ,GAAGiK,MAAM4Z,gBAAkBD,CAC7C,CAGA,IAA6B,GAAzB8N,uBACKD,uBAAuBC,sBAAuB,CAC/C,IAAI9N,EAAQ,mBAEC,GAATxZ,QAAYwZ,EAAQ,mBAExBpK,EAA6B,EAAvBkY,qBAA2B,GAAGznB,MAAM4Z,gBAAkBD,EAC5DpK,EAA6B,EAAvBkY,qBAA2B,GAAGznB,MAAM4Z,gBAAkBD,EAC5DpK,EAA6B,EAAvBkY,qBAA2B,GAAGznB,MAAM4Z,gBAAkBD,CAChE,CAER,CAEA,SAASsC,wBACL,IAAI7mB,EAAS,EACT6d,EAAYvB,eAMhB,OAJwB,GAApBuB,EAAUjd,QAAsC,WAAvBid,EAAU,GAAGvG,SACtCtX,EAAS,GAGNA,CACX,CAEA,SAAS4yB,oBACLC,sBAAwB,EAExBhF,kBAEA,IACI5sB,EADW0D,SAASC,eAAe,gBACpB6C,MAAMzG,MAAM,MAAM4hB,MAAM,GAE3C,KAAO3hB,EAAIL,OAAS,IAChBK,EAAIiB,KAAK,IAMb,OAHA2wB,sBAAwB,EACxBhF,kBAEO5sB,CACX,CAEA,SAAS6xB,qBACL,IAAIC,EAAUH,oBAEdN,wBAA0B,GAE1B,IAAK,IAAI3xB,EAAI,EAAGA,EAAI,GAAIA,IAChByxB,uBAAuBzxB,IACvB2xB,wBAAwBpwB,KAAK6wB,EAAQpyB,GAGjD,CAEA,SAASmmB,oBACL,OAAQsL,uBAAuB5yB,SAAS,EAC5C,CAEA,SAASwzB,iCACL,OAAOZ,uBAAuBhe,QAAQ,IAAMge,uBAAuBrV,YAAY,KAAO+J,mBAC1F,CAEA,SAASmM,2BACL,OAAOb,uBAAuBhe,QAAQ,EAC1C,CAEA,SAAS8e,iBAOL,OANAL,sBAAwB,EACxBhF,kBAEelpB,SAASC,eAAe,gBACpB6C,MAAMzG,MAAM,MAAM4hB,MAAM,EAAG,EAGlD,CAEA,SAASuQ,sBAIL,IAAIJ,EAAUH,oBACVhwB,EAAQqwB,2BACRnJ,EAAYwI,wBAAwB1Y,KAAK,MACzCwZ,EAAOF,iBAEXL,sBAAwB,EACxBhF,kBAEI/G,sBACAlkB,EAAQmwB,EAAQnyB,OAAS,EACzBmyB,EAAQnwB,GAASmwB,EAAQnwB,GAAS,KAAOknB,GAGzCkJ,mCACAD,EAAQnwB,GAASknB,EAAY,KAAOiJ,EAAQnwB,IAGjC+B,SAASC,eAAe,gBAE9B6C,MAAQ2rB,EAAKC,OAAON,GAASnZ,KAAK,MAE3CoY,iBAEAa,sBAAwB,EACxBhF,iBACJ,CAEA,SAASyF,uBACL,IAAIP,EAAUH,oBACVQ,EAAOF,iBAEXL,sBAAwB,EACxBhF,kBAEA,IAAK,IAAIltB,EAAI,EAAGA,EAAI,GAAIA,IAChByxB,uBAAuBzxB,KACvBoyB,EAAQpyB,GAAK,IAINgE,SAASC,eAAe,gBAE9B6C,MAAQ2rB,EAAKC,OAAON,GAASnZ,KAAK,MAE3CoY,iBAEAa,sBAAwB,EACxBhF,iBACJ,CAEA,SAAS9G,wBACL,IAAIwM,EAAWX,oBACXY,EAAW,GACXtN,EAAU,GACVkN,EAAOF,iBAEXL,sBAAwB,EACxBhF,kBAEA,IAAK,IAAIltB,EAAI,EAAGA,EAAI,GAAIA,IAChByxB,uBAAuBzxB,KACvB6yB,EAAStxB,KAAKqxB,EAAS5yB,IACvBulB,EAAQhkB,KAAKvB,IAIrBulB,EAAQuN,UAER,IAAK,IAAI9yB,EAAI,EAAGA,EAAI6yB,EAAS5yB,OAAQD,IAAK,CACtC,IAAIiC,EAAQsjB,EAAQvlB,GAChB+yB,EAASF,EAAS7yB,GAEtB4yB,EAAS3wB,GAAS8wB,CACtB,CAEe/uB,SAASC,eAAe,gBAE9B6C,MAAQ2rB,EAAKC,OAAOE,GAAU3Z,KAAK,MAE5CtU,+BAAgC,EAChC0sB,iBACA1sB,+BAAgC,EAChCoC,QAAQ,oBAAqB,WAE7BmrB,sBAAwB,EACxBhF,iBACJ,CAEA,SAAS7G,yBACLoL,uBAAyB,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACrDC,sBAAwB,EACxBI,6BACJ,CAEA,SAASkB,6BACLvB,uBAAyB,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACrDC,sBAAwB,EACxBxE,iBACJ,CAEA,SAAS+F,0BACL,IAAIC,EAAsB5f,gBACtB6f,EAAyBvS,mBACzBwS,EAAsBC,gBACtBC,EAAsBpG,gBACtBqG,EAAcC,QACdC,EAAcC,QAElBjwB,OAAO6P,gBAAkB,SAAShL,GAC9B,GAAI6d,oBAAqB,CACrB,IAAI9mB,EAAS6zB,EAAoB5qB,GAEjC,OADAqpB,wBAA0B,GACnBtyB,CACX,CAGI,OAFA8yB,qBACA9L,0BACO,CAEf,EAEA5iB,OAAOmd,mBAAqB,SAAStY,GACjC,GAAsC,GAAlCqpB,wBAAwB1xB,OAAa,CACrC,IAAIZ,EAAS8zB,EAAuB7qB,GAEpC,OADA4kB,kBACO7tB,CACX,CAKI,OAJAsF,+BAAgC,EAChC6tB,sBACAnM,yBACA1hB,+BAAgC,GACzB,CAEf,EAEAlB,OAAO4vB,gBAAkB,WACjBlN,oBACAiN,KAEAzuB,+BAAgC,EAChCguB,uBACAtM,yBACAtf,QAAQ,2BAA4B,WACpCpC,+BAAgC,EAExC,EAEAlB,OAAOypB,gBAAkB,WACrBoG,IAEKpN,wBAGOgM,wBACRL,oBACAC,gCAJAL,uBAAyB,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACrDC,sBAAwB,EAKhC,EAEAjuB,OAAO+vB,QAAU,WACb,IACID,GACJ,CAAE,MAAOxS,GACLha,QAAQ,qBAAsBC,SAClC,CACJ,EAEAvD,OAAOiwB,QAAU,WACb,IACID,GACJ,CAAE,MAAO1S,GACLha,QAAQ,qBAAsBC,SAClC,CACJ,EAEAvD,OAAOuvB,2BAA6BA,2BACpC5rB,QAAQtC,MAAO,uCACnB,CAEA,SAAS6uB,gBACL,IAAIC,EAASC,GAEbpwB,OAAOowB,GAAK,SAASC,EAAQC,GACtBnuB,aAAaa,oBACZmtB,EAAOE,GAAU/d,cAAgB,IAAKzW,KAAK4T,IAAI6gB,EAASz0B,KAAKgM,IAAIyK,cAAgB,GAAI,GAAI,IAEzF6d,EAAOE,EAAQC,EAEvB,EACA3sB,QAAQtC,MAAO,aACnB,CAEA,SAASkvB,eACL,IAAIC,EAAMltB,QACVtD,OAAOsD,QAAU,CAACO,EAAMsc,IAChBjf,+BACuD,+BAAvD2C,EAAK2a,MAAM,EAAG,IADwBgS,EAAI3sB,EAAMsc,QACpD,CAER,CAEA,IAAIsQ,wBAA0B,IAE9B,SAASC,0BAA0BjW,EAAK5W,EAAM8sB,EAASC,EAASC,GAC5D,GAAK1uB,aAAagB,mBAGb,CACD,IAAI2tB,EAAY,EAAI/W,KACpB+W,GAAaL,wBACTK,EAAY,IACZA,EAAY,GAEhB,IAEIr1B,EAAIk1B,EAFoBE,EAAIpgB,MACcqgB,EACZ,EAC9Bp1B,EAAIk1B,EAAU,EAAIE,EACtBrW,EAAIsW,UAAUt1B,EAAGC,GACjB+e,EAAIa,MAAMwV,EAAWA,GACrBrW,EAAIuW,SAASntB,EAAM,EAAG,GACtB4W,EAAIa,MAAM,EAAEwV,EAAW,EAAEA,GACzBrW,EAAIsW,WAAWt1B,GAAIC,EACvB,MAjBI+e,EAAIuW,SAASntB,EAAM8sB,EAAUE,EAAIpgB,MAAM,EAAGmgB,EAAU,EAkB5D,CAEA,SAASK,cACL,IAAIC,eAAiB,wDACjBC,eAAiB,6DACjB5O,KAAOne,WAAW+C,WAAWlK,QAAQi0B,eAAgBC,gBAEzD5O,KAAOA,KAAKtlB,QAAQ,+BAAgC,kCACpDslB,KAAO,IAAMA,KAAO,IACpBviB,OAAOwa,OAASrW,KAAKoe,MACrB5e,QAAQtC,MAAO,iBACnB,CAEA,IAAI+vB,UAAY,iBAoEZ,GAjEAnwB,UAAYowB,qBACZxwB,aAAeN,SAASO,gBACxBC,YAAcR,SAASS,YACvBoD,WAAaoW,OAEbpK,yBACAsU,kBAEAze,eACAa,cACA/B,eACAgB,qBACAxB,mBACAiH,gBACAkB,gBACAC,gBACAmY,eACAhV,iBACAsB,gBACAE,sBACAzI,WACAuK,mBACAyN,mBACAuE,mBACAmL,eACAjG,eAEAtqB,OAAOyV,oBAAsBA,oBAC7BzV,OAAOmd,mBAAqBA,mBAC5BiH,WAEGjiB,aAAaQ,gBACZod,YAEJwJ,qBACAC,uBACAsC,gBACAhT,qBACAC,yBACI5W,aAAaY,YACbA,aAEJkpB,sBACAE,oBACA7Y,cACAka,sBACAE,sBACAjS,qBACAoS,iCACAxR,8BACAmT,0BACAU,gBACAe,cACA1R,iBAEGrf,WACC8sB,kBACAzP,sBAGJ5Z,QAAQrC,OAAQ,aAAe2a,KAAKE,UAAUha,eACV,GAAjCA,aAAamvB,kBAA2Bxc,8BAA6B,GAExExR,QAAQ,iBAAkB,WAC1BK,QAAQvC,KAAM,YACXlB,SACCyD,QAAQvC,KAAM,yBAAyBjB,QAAQyd,yBAAyBzd,QAAQwd,OAAOC,eACpF,CACH,IAAI2T,EAAU,wHACdjuB,QAAQ,SAASiuB,IAAW,WAC5BjuB,QAAQ,+DAAgE,WACxEK,QAAQvC,KAAMmwB,EAClB,CACH,EAEDhxB,SAAS2P,iBAAiB,oBAAoB,IAAMkhB,a","sources":["webpack://alei/./src/alescript.js","webpack://alei/webpack/bootstrap","webpack://alei/webpack/runtime/define property getters","webpack://alei/webpack/runtime/hasOwnProperty shorthand","webpack://alei/./src/main.js"],"sourcesContent":["function isNumber(str) {\r\n    let number = 0;\r\n\r\n    if ((!isNaN(Number(str)) && str !== \" \") || str == \".\") {\r\n        number = 1;\r\n    }\r\n\r\n    return number;\r\n}\r\n\r\nfunction isOperator(str) {\r\n    return \"+-*/%^SCANRF\".includes(str);\r\n}\r\n\r\nfunction isGroup(str) {\r\n    return \"()\".includes(str);\r\n}\r\n\r\nfunction split(str) {\r\n    return str.replaceAll(\" \", \"\").split(\"\");\r\n}\r\n\r\nfunction concatNumbers(str) {\r\n    let num = \"\";\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (isNumber(str[i])) {\r\n            num += str[i];\r\n        } else if (num.length != 0) {\r\n            str.splice(i - num.length, num.length, num);\r\n            i -= (num.length - 1);\r\n            num = \"\";\r\n        }\r\n    }\r\n\r\n    if (num.length != 0) {\r\n        str.splice(str.length - num.length, num.length, num);\r\n    }\r\n}\r\n\r\nfunction convertToObjects(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        str[i] = {\r\n            chr: str[i]\r\n        }\r\n    }\r\n}\r\n\r\nfunction createGroupOrders(str) {\r\n    let order = 1;\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str[i].chr == \"(\") {\r\n            order++;\r\n        }\r\n\r\n        if (str[i].chr == \")\") {\r\n            order--;\r\n        }\r\n\r\n        str[i].groupOrder = order;\r\n    }\r\n}\r\n\r\nfunction removeGroupChars(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (isGroup(str[i].chr)) {\r\n            str.splice(i, 1);\r\n            i--;\r\n        }\r\n    }\r\n}\r\n\r\nfunction operatorOrder(str) {\r\n    let order = 0;\r\n\r\n    if (\"+-\".includes(str)) {\r\n        order = 1;\r\n    }\r\n\r\n    if (\"*/%\".includes(str)) {\r\n        order = 2;\r\n    }\r\n\r\n    if (\"^SCANRF\".includes(str)) {\r\n        order = 3;\r\n    }\r\n\r\n    return order;\r\n}\r\n\r\nfunction createOperatorOrders(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (isOperator(str[i].chr)) {\r\n            let order = operatorOrder(str[i].chr);\r\n\r\n            str[i].operatorOrder = order;\r\n\r\n            if (str[i + 1].groupOrder == str[i].groupOrder) {\r\n                str[i + 1].operatorOrder = order;\r\n            }\r\n\r\n            if (!str[i - 1].operatorOrder || (str[i - 1].operatorOrder < str[i].operatorOrder && str[i - 1].groupOrder == str[i].groupOrder)) {\r\n                str[i - 1].operatorOrder = order;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction createOrders(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        str[i].order = str[i].groupOrder * 10 + str[i].operatorOrder;\r\n    }\r\n}\r\n\r\nfunction getOrders(str) {\r\n    let orders = [];\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        orders.push(str[i].order);\r\n    }\r\n\r\n    return orders;\r\n}\r\n\r\nfunction simplifyOrders(orders) {\r\n    let arr = [];\r\n    let order = 1;\r\n\r\n    orders.sort((x, y) => {\r\n        return y - x;\r\n    });\r\n\r\n    arr.push({\r\n        from: orders[0],\r\n        to: order\r\n    });\r\n\r\n    for (let i = 1; i < orders.length; i++) {\r\n        if (orders[i] != orders[i - 1]) {\r\n            order++;\r\n        }\r\n\r\n        arr.push({\r\n            from: orders[i],\r\n            to: order\r\n        });\r\n    }\r\n\r\n    return arr;\r\n}\r\n\r\nfunction replaceOrders(str) {\r\n    let orders = getOrders(str);\r\n    let arr = simplifyOrders(orders);\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        for (let j = 0; j < arr.length; j++) {\r\n            if (str[i].order == arr[j].from) {\r\n                str[i].order = arr[j].to;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction calc(x, y, z) {\r\n    let result;\r\n\r\n    x = Number(x);\r\n    z = Number(z);\r\n\r\n    if (y == \"+\") {\r\n        result = x + z;\r\n    }\r\n\r\n    if (y == \"-\") {\r\n        result = x - z;\r\n    }\r\n\r\n    if (y == \"*\") {\r\n        result = x * z;\r\n    }\r\n\r\n    if (y == \"/\") {\r\n        result = x / z;\r\n    }\r\n\r\n    if (y == \"%\") {\r\n        result = x % z;\r\n    }\r\n\r\n    if (y == \"^\") {\r\n        result = x ** z;\r\n    }\r\n\r\n    if (y == \"S\") {\r\n        result = Math.sin(x) * z;\r\n    }\r\n\r\n    if (y == \"C\") {\r\n        result = Math.cos(x) * z;\r\n    }\r\n\r\n    if (y == \"A\") {\r\n        result = Math.atan2(x, z);\r\n    }\r\n\r\n    if (y == \"N\") {\r\n        if (z) {\r\n            result = Math.floor(Math.random() * x);\r\n        } else {\r\n            result = Math.random() * x;\r\n        }\r\n    }\r\n\r\n    if (y == \"R\") {\r\n        result = Math.round(x / z) * z;\r\n    }\r\n\r\n    if (y == \"F\") {\r\n        result = Math.floor(x / z) * z;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction getMaxOrder(str) {\r\n    let order = 0;\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str[i].order > order) {\r\n            order = str[i].order;\r\n        }\r\n    }\r\n\r\n    return order;\r\n}\r\n\r\nfunction exec(str) {\r\n    let maxOrder = getMaxOrder(str);\r\n\r\n    for (let order = 1; order <= maxOrder; order++) {\r\n        let i = 0;\r\n        let loop = 1;\r\n\r\n        while (loop) {\r\n            loop = 0;\r\n\r\n            let newstr = [];\r\n            let length;\r\n            let saveOrder;\r\n            let index = -1;\r\n\r\n            for (; i < str.length; i++) {\r\n                if (str[i].order == order) {\r\n                    newstr.push(str[i]);\r\n\r\n                    if (index == -1) {\r\n                        index = i;\r\n                    }\r\n                } else if (newstr.length != 0) {\r\n                    loop = 1;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            length = newstr.length;\r\n\r\n            if (length) {\r\n                while (newstr.length != 1) {\r\n                    newstr.splice(0, 3, {\r\n                        chr: calc(newstr[0].chr, newstr[1].chr, newstr[2].chr)\r\n                    });\r\n                }\r\n\r\n                saveOrder = str[index].order;\r\n\r\n                str.splice(index, length, newstr[0]);\r\n                i -= (length - 1);\r\n\r\n                str[index] = {\r\n                    chr: str[index].chr,\r\n                    order: saveOrder + 1\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction replace(str, arr) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        for (let j = 0; j < arr.length; j++) {\r\n            if (str[i] == arr[j].from) {\r\n                str[i] = arr[j].to;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction negativeNumbers(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str[i] == \"-\" && str[i - 1] == \"(\") {\r\n            str.splice(i, 0, \"0\");\r\n        }\r\n    }\r\n}\r\n\r\nfunction simpleGroups(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str[i - 1] == \"(\" && str[i + 1] == \")\") {\r\n            str.splice(i, 0, \"0\", \"+\");\r\n        }\r\n    }\r\n}\r\n\r\nexport function parse(str, vars) {\r\n    if (str == \"\") {\r\n        str = \"0\";\r\n    }\r\n\r\n    if (str[0] == \"-\") {\r\n        str = \"0\" + str;\r\n    }\r\n\r\n    str = split(str);\r\n    concatNumbers(str);\r\n\r\n    replace(str, [\r\n        {\r\n            from: \"p\",\r\n            to: String(Math.PI)\r\n        },\r\n\r\n        {\r\n            from: \"x\",\r\n            to: String(vars[0])\r\n        },\r\n\r\n        {\r\n            from: \"y\",\r\n            to: String(vars[1])\r\n        },\r\n\r\n        {\r\n            from: \"w\",\r\n            to: String(vars[2])\r\n        },\r\n\r\n        {\r\n            from: \"h\",\r\n            to: String(vars[3])\r\n        },\r\n\r\n        {\r\n            from: \"i\",\r\n            to: String(vars[4])\r\n        }\r\n    ]);\r\n\r\n    try {\r\n        negativeNumbers(str);\r\n        simpleGroups(str);\r\n        convertToObjects(str);\r\n        createGroupOrders(str);\r\n        removeGroupChars(str);\r\n        createOperatorOrders(str);\r\n        createOrders(str);\r\n        replaceOrders(str);\r\n        exec(str);\r\n    } catch {\r\n        return \"error\";\r\n    }\r\n\r\n    return Number(Number(str[0].chr).toFixed(10));\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import { parse as alescriptParse } from \"./alescript.js\"\n\nlet window = unsafeWindow;\nlet isNative;\ntry {\n    GM_info\n    isNative = true\n    window[\"nativeALEIRunning\"] = true;\n} catch (e) {isNative = false};\n\nif(!isNative && (window[\"nativeALEIRunning\"] == true)) {\n    // An ALEI instance is already running, probably ran under tampermonkey so let that run.\n    Hello_IgnoreThisError_ItIsIntentional // hope this is not defined\n}\n\n// Shorthand things\nfunction $id(id) {\n    return document.getElementById(id);\n}\nfunction $query(selector) {\n    return document.querySelector(selector);\n}\n\nlet ROOT_ELEMENT = document.documentElement;\nlet stylesheets = document.styleSheets;\nlet VAL_TABLE = {}; // Will be filled later.\nlet displayOperationCompleteNotes = true;\nlet REGION_EXECUTE_PARAM_ID; // Will be set later.\n\nconst INFO = 0;\nconst DEBUG = 1;\nconst DEBUG2 = 2;\nconst WARN = -1;\n\n// Just for styling.\nconst ANSI_RESET = \"\\x1B[0m\"\nconst ANSI_RED = \"\\x1B[31m\"\nconst ANSI_GREY = \"\\x1B[37m\"\nconst ANSI_YELLOW = \"\\x1B[93m\"\nconst ANSI_GREEN = \"\\x1B[92m\"\nconst ANSI_CYAN = \"\\x1B[96m\"\n\nfunction readStorage(key, defaultValue, func) {\n    let val = localStorage[key];\n    if (val === undefined) return defaultValue;\n    return func(localStorage[key])\n}\n\nif (localStorage['RIGHT_PANEL_WIDTH'] != undefined) {\n    localStorage[\"ALEI_RightPanelWidth\"] = localStorage[\"RIGHT_PANEL_WIDTH\"];\n    localStorage.removeItem(\"RIGHT_PANEL_WIDTH\");\n}\n\nlet aleiSettings = {\n    rightPanelSize:     readStorage(\"ALEI_RightPanelWidth\",   \"30vw\",  (val) => val            ),\n    triggerEditTextSize:readStorage(\"ALEI_EditTextSize\",      \"12px\",  (val) => val + \"px\"     ),\n    starsImage:         readStorage(\"ALEI_StarImage\",    \"stars2.jpg\", (val) => val            ),\n    logLevel:           readStorage(\"ALEI_LogLevel\",             0,     parseInt               ),\n    showTriggerIDs:     readStorage(\"ALEI_ShowTriggerIDs\",       false, (val) => val === \"true\"),\n    enableTooltips:     readStorage(\"ALEI_ShowTooltips\",         false, (val) => val === \"true\"),\n    showSameParameters: readStorage(\"ALEI_ShowSameParameters\",   true , (val) => val === \"true\"),\n    rematchUID:         readStorage(\"ALEI_RemapUID\",             false, (val) => val === \"true\"),\n    showIDs:            readStorage(\"ALEI_ShowIDs\",              false, (val) => val === \"true\"),\n    blackTheme:         readStorage(\"ALEI_BlackTheme\",           false, (val) => val === \"true\"),\n    gridBasedOnSnapping:readStorage(\"ALEI_gridBasedOnSnapping\",  true,  (val) => val === \"true\"),\n    showZIndex:         readStorage(\"ALEI_ShowZIndex\",           false, (val) => val === \"true\"),\n    renderObjectNames:  readStorage(\"ALEI_RenderObjectNames\",    true,  (val) => val === \"true\"),\n    textAffectedByZoom: readStorage(\"ALEI_TextAffectedByZoom\",   false, (val) => val === \"true\")\n}\nwindow.aleiSettings = aleiSettings;\n\nfunction writeStorage(key, value) {\n    try {\n        localStorage[key] = value;\n    } catch (e) {\n        NewNote(\"ALEI: There was some issue trying to save into storage. You might need to clear your datas.\", note_bad);\n        console.error(e);\n    }\n}\n\nlet levelToNameMap = {\n    0: `${ANSI_CYAN}INFO${ANSI_RESET}`,\n    1: `${ANSI_GREEN}DEBUG${ANSI_RESET}`,\n    2: `${ANSI_GREEN}DEBUG2${ANSI_RESET}`\n}\n\nfunction aleiLog(level, text) {\n    if (level === WARN) {\n        console.warn(`[ALEI:WARNING]: ${text}`);\n        NewNote(`ALEI: Please check console.`, \"#FFFF00\");\n    }else if (level <= aleiSettings.logLevel)\n        console.log(`[${ANSI_GREEN}ALEI:${levelToNameMap[level]}]: ${text}`)\n}\naleiLog(INFO, \"Starting up...\");\n\n// Original functions, globally saved here if needed\n// JS_ prefix for JavaScript ones, ALE_ for ALE ones\nlet JS_setTimeout = window.setTimeout;\nlet JS_eval = window.eval;\nlet ALE_Render;\n\nlet aleiSessionID = null; // ID of this session\nlet aleiSessionList = []; // Set of known session IDs\n\nfunction updateParameters() {\n    // Does things to parameters depending on purpose.\n    function add(key, type, name, objType) {\n        param_type[param_type.length] = [key, type, name, \"\", objType];\n    }\n    // Adding parameters that the game accepts but ALE does not have.\n    add(\"moving\", \"bool\", \"Is Moving?\", \"door\");\n    add(\"tarx\", \"value\", \"Target X\", \"door\");\n    add(\"tary\", \"value\", \"Target Y\", \"door\");\n    // Adding our own parameter.\n    add(\"__id\", \"value\", \"ID\", \"*\");\n    add(\"__zIndex\", \"value\", \"Z-Index\", \"*\");\n    add(\"execute\", \"bool\", \"Executes directly?\", \"trigger\");\n    add(\"uses_timer\", \"bool\", \"Calls timer?\", \"region\");\n    add(\"text\", \"string\", \"Placeholder text\", \"decor\");\n    add(\"attach\", \"door+none\", \"Attach to\", \"water\");\n    // Patching parameters\n    param_type[0] = ['uid', 'string', 'Name', 'Object Name', '*'];\n\n    // Setting global variables for future use\n    for(let i = 0; i < param_type.length; i++) {\n        let param = param_type[i];\n        let key = param[0];\n        let selector = param[4];\n\n        if((key == \"use_target\") && (selector == \"region\")) {\n            REGION_EXECUTE_PARAM_ID = i;\n        }\n    }\n    VAL_TABLE[\"timer+none\"] = new Array();\n    VAL_TABLE[\"timer+none\"][-1] = \"- No timer -\";\n    VAL_TABLE[\"timer+none\"][\"[listof]\"] = \"timer\"; // Somebody save me.\n}\n\nfunction updateSounds() {\n    // Adds sounds that exist in game but not in ALE\n    let SVTS = VAL_TABLE[\"sound\"];\n    SVTS['am_base'] = 'Indoor Ambience';\n    SVTS['am_wind'] = 'Outdoor Ambience';\n    SVTS['android2_die'] = 'DT-148 - Death';\n    SVTS['android2_hurt'] = 'DT-148 - Hurt';\n    SVTS['android2_welcome2'] = 'DT-148 - Alerted';\n    SVTS['arrin_death1'] = 'Arrin - Death';\n    SVTS['arrin_dying'] = 'Arrin - Dying';\n    SVTS['arrin_hurt1'] = 'Arrin - Hurt 1';\n    SVTS['arrin_hurt2'] = 'Arrin - Hurt 2';\n    SVTS['arrin_welcome1'] = 'Arrin - Alerted 1';\n    SVTS['arrin_welcome2'] = 'Arrin - Alerted 2';\n    SVTS['arrin_welcome3'] = 'Arrin - Alerted 3';\n    SVTS['bounce_bullet'] = 'Falkonian PSI Cutter - Shot Bounce';\n    SVTS['dart4'] = 'Medic Pistol';\n    SVTS['exp_event_stop'] = 'EXP - Stop';\n    SVTS['exp_level'] = 'EXP - Level Up';\n    SVTS['exp_tick'] = 'EXP - Gain';\n    SVTS['gameplay_song'] = 'Katharsys - Erges';\n    SVTS['gravitator2'] = 'Floor gravitator noice';\n    SVTS['helm_proxy_alert_over_hereB'] = 'Proxy - Over here!';\n    SVTS['helm_proxy_alert_take_coverB'] = 'Proxy - Take cover!';\n    SVTS['helm_proxy_alert_up_thereA'] = 'Proxy - Up there!';\n    SVTS['helm_proxy_death3'] = 'Proxy - Death 1';\n    SVTS['helm_proxy_death4'] = 'Proxy - Death 2';\n    SVTS['helm_proxy_death5'] = 'Proxy - Death 3';\n    SVTS['helm_proxy_death6'] = 'Proxy - Death 4';\n    SVTS['helm_proxy_dyingC'] = 'Proxy - Help! 1';\n    SVTS['helm_proxy_dyingF'] = 'Proxy - Help! 2';\n    SVTS['helm_proxy_enemy_down_fantasticA'] = 'Proxy - Fantastic.';\n    SVTS['helm_proxy_enemy_down_got_oneD'] = 'Proxy - Got one.';\n    SVTS['helm_proxy_enemy_down_niceA'] = 'Proxy - Nice. 1';\n    SVTS['helm_proxy_enemy_down_niceC'] = 'Proxy - Nice. 2';\n    SVTS['helm_proxy_hurt11'] = 'Proxy - Hurt 1';\n    SVTS['helm_proxy_hurt12'] = 'Proxy - Hurt 2';\n    SVTS['helm_proxy_hurt13'] = 'Proxy - Hurt 3';\n    SVTS['helm_proxy_hurt14'] = 'Proxy - Hurt 4';\n    SVTS['helm_proxy_hurt15'] = 'Proxy - Hurt 5';\n    SVTS['helm_proxy_hurt17'] = 'Proxy - Hurt 6';\n    SVTS['helm_proxy_hurt4'] = 'Proxy - Hurt 7';\n    SVTS['helm_proxy_hurt5'] = 'Proxy - Hurt 8';\n    SVTS['helm_proxy_hurt8'] = 'Proxy - Hurt 9';\n    SVTS['helm_proxy_hurt9'] = 'Proxy - Hurt 10';\n    SVTS['hexagon_death1'] = 'Hexagon - Death 1';\n    SVTS['hexagon_death2'] = 'Hexagon - Death 2';\n    SVTS['hexagon_pain1'] = 'Hexagon - Hurt 1';\n    SVTS['hexagon_pain2'] = 'Hexagon - Hurt 2';\n    SVTS['hexagon_pain3'] = 'Hexagon - Hurt 3';\n    SVTS['hexagon_pain4'] = 'Hexagon - Hurt 4';\n    SVTS['hexagon_welcome1'] = 'Hexagon - Alerted 1';\n    SVTS['hexagon_welcome2'] = 'Hexagon - Alerted 2';\n    SVTS['hexagon_welcome3'] = 'Hexagon - Alerted 3';\n    SVTS['main_song'] = 'NPhonix - Antigravity';\n    SVTS['orakin_death1'] = 'Orakin - Death 1';\n    SVTS['orakin_death2'] = 'Orakin - Death 2';\n    SVTS['orakin_hurt'] = 'Orakin - Hurt';\n    SVTS['orakin_welcome'] = 'Orakin - Alerted';\n    SVTS['proxy_alert_over_hereB'] = 'No Helm Proxy - Over here!';\n    SVTS['proxy_alert_take_coverB'] = 'No Helm Proxy - Take cover!';\n    SVTS['proxy_alert_up_thereA'] = 'No Helm Proxy - Up there!';\n    SVTS['proxy_death3'] = 'No Helm Proxy - Death 1';\n    SVTS['proxy_death4'] = 'No Helm Proxy - Death 2';\n    SVTS['proxy_death5'] = 'No Helm Proxy - Death 3';\n    SVTS['proxy_death6'] = 'No Helm Proxy - Death 4';\n    SVTS['proxy_dyingC'] = 'No Helm Proxy - Help! 1';\n    SVTS['proxy_dyingF'] = 'No Helm Proxy - Help! 2 ';\n    SVTS['proxy_enemy_down_fantasticA'] = 'No Helm Proxy - Fantastic.';\n    SVTS['proxy_enemy_down_got_oneD'] = 'No Helm Proxy - Got one.';\n    SVTS['proxy_enemy_down_niceA'] = 'No Helm Proxy - Nice. 1';\n    SVTS['proxy_enemy_down_niceC'] = 'No Helm Proxy - Nice. 2';\n    SVTS['proxy_hurt11'] = 'No Helm Proxy - Hurt 1';\n    SVTS['proxy_hurt12'] = 'No Helm Proxy - Hurt 2';\n    SVTS['proxy_hurt13'] = 'No Helm Proxy - Hurt 3';\n    SVTS['proxy_hurt14'] = 'No Helm Proxy - Hurt 4';\n    SVTS['proxy_hurt15'] = 'No Helm Proxy - Hurt 5';\n    SVTS['proxy_hurt17'] = 'No Helm Proxy - Hurt 6';\n    SVTS['proxy_hurt4'] = 'No Helm Proxy - Hurt 7';\n    SVTS['proxy_hurt5'] = 'No Helm Proxy - Hurt 8';\n    SVTS['proxy_hurt8'] = 'No Helm Proxy - Hurt 9';\n    SVTS['proxy_hurt9'] = 'No Helm Proxy - Hurt 10';\n    SVTS['silk_alert_contactA'] = 'Silk - Contact!';\n    SVTS['silk_alert_i_see_oneA'] = 'Silk - I see one.';\n    SVTS['silk_alert_there_is_oneA'] = 'Silk - There is one...!';\n    SVTS['silk_death1B'] = 'Silk - Death 1';\n    SVTS['silk_death2B'] = 'Silk - Death 2';\n    SVTS['silk_dyingB'] = 'Silk - Not good...';\n    SVTS['silk_enemy_down_brilliantC'] = 'Silk - Brilliant.';\n    SVTS['silk_enemy_down_eliminatedB'] = 'Silk - Eliminated.';\n    SVTS['silk_enemy_down_hell_yeahB'] = 'Silk - Hell yeah!';\n    SVTS['silk_enemy_down_ive_got_oneB'] = 'Silk - I got one!';\n    SVTS['silk_enemy_down_minus_oneB'] = 'Silk - -1.';\n    SVTS['silk_enemy_down_no_kicking_for_youB'] = 'Silk - No kicking for you.';\n    SVTS['silk_hurt1B'] = 'Silk - Hurt 1';\n    SVTS['silk_hurt2B'] = 'Silk - Hurt 2';\n    SVTS['silk_hurt5'] = 'Silk - Hurt 3';\n    SVTS['silk_hurt6'] = 'Silk - Hurt 4';\n    SVTS['silk_hurt9B'] = 'Silk - Hurt 5';\n    SVTS['wea_crossfire2'] = 'Crossfire CR-145 Vortex';\n    SVTS['wea_ditzy_cs_ik'] = 'Assault Rifle CS-IK';\n    SVTS['wea_glhf'] = 'Grenade Launcher CS-GLHF';\n    SVTS['wea_incompetence_archetype_27xx_fire'] = 'Archetype 27XX';\n    SVTS['wea_lazyrain_gravy_rl'] = 'Falkonian Anti-Grav Rocket Launcher';\n    SVTS['wea_m202'] = 'Rocket Launcher CS-Barrage';\n    SVTS['wea_moonhawk_railgun'] = 'Crossfire CR-34 Marauder';\n    SVTS['wea_ph01'] = 'Crossfire CR-54 Viper';\n    SVTS['wea_plasma_shotgun'] = 'Plasma Shotgun';\n    SVTS['wea_rail_alt2'] = 'Falkonian PSI Cutter';\n    SVTS['wea_thetoppestkek_shotgun_nxs25'] = 'Shotgun NXS-25';\n    SVTS['xin_celebrate'] = 'Xin - Celebrating';\n    SVTS['xin_death'] = 'Xin - Death';\n    SVTS['xin_enemy_spotted'] = 'Xin - Alerted';\n    SVTS['xin_hit'] = 'Xin - Hurt';\n    let voices = {\n        Grosk: [\n            \"Grosk\",\n            [\"death\", \"Death\", 2],\n            [\"dying\", \"Dying\", 2],\n            [\"edown\", \"Celebrating\", 3],\n            [\"welcome\", \"Alerted\", 5],\n            [\"hurt\", \"Hurt\", 3]\n        ],\n        drohnentroop: [\n            \"Drohnen Trooper\",\n            [\"welcome\", \"Alerted\", 3],\n            [\"hurt\", \"Hurt\", 3],\n            [\"edown\", \"Celebrating\", 3],\n            [\"dying\", \"Dying\", 1],\n            [\"death\", \"Death\", 3]\n        ],\n        drohnenfem: [\n            \"Drohnen Female\",\n            [\"welcome\", \"Alerted\", 3],\n            [\"hurt\", \"Hurt\", 3],\n            [\"edown\", \"Celebrating\", 3],\n            [\"dying\", \"Dying\", 1],\n            [\"death\", \"Death\", 3]\n        ],\n        elurra: [\n            \"Elurra\",\n            [\"welcome\", \"Alerted\", 3],\n            [\"hurt\", \"Hurt\", 2],\n            [\"edown\", \"Celebrating\", 2],\n            [\"dying\", \"Dying\", 1],\n            [\"death\", \"Death\", 1]\n        ],\n        ferro: [\n            \"Lt. Ferro\",\n            [\"welcome\", \"Alerted\", 3],\n            [\"hurt\", \"Hurt\", 2],\n            [\"edown\", \"Celebrating\", 3],\n            [\"death\", \"Death\", 2]\n        ],\n        serkova: [\n            \"Serkova\",\n            [\"welcome\", \"Alerted\", 3],\n            [\"hurt\", \"Hurt\", 1],\n            [\"edown\", \"Celebrating\", 2],\n            [\"death\", \"Death\", 1]\n        ],\n        phantom: [\n            \"Phantom\",\n            [\"edown\", \"Celebrating\", 1],\n            [\"welcome\", \"Alerted\", 2],\n            [\"death\", \"Death\", 1]\n        ]\n    };\n    for (let entry of Object.entries(voices)) {\n        let character = entry[0];\n        let charVoices = entry[1];\n        let charName = charVoices[0];\n\n        for (let i = 1; i < charVoices.length; i++) {\n            let voice = charVoices[i];\n            for (let j = 1; j <= voice[2]; j++) {\n                SVTS[`${character}_${voice[0]}${j}`] = `${charName} - ${voice[1]} ${j}`\n            }\n        }\n    }\n}\n\nfunction updateVoicePresets() {\n    // Adds voice presets that exist in game but not in ALE\n    let VP = VAL_TABLE['voice_preset'];\n    VP['proxy_helmetless'] = 'Proxy (helmetless)';\n    VP['silk'] = 'Silk';\n    VP['orakin'] = 'Orakin';\n    VP['arrin'] = 'Arrin';\n    VP['civilian_male'] = 'Civilian Male';\n    VP['vulture'] = 'Vulture';\n    VP['crossfire_sentinel'] = 'Crossfire Sentinel';\n    VP['xin'] = 'Xin';\n    VP[\"grosk\"] = \"Grosk\";\n\n    VP[\"elurra\"] = \"Elurra\";\n    VP[\"drohnenfem\"] = \"Drohnen Female\";\n    VP[\"serkova\"] = \"Serkova\";\n    VP[\"ferro\"] = \"Lt. Ferro\";\n    VP[\"drohnentroop\"] = \"Drohnen Trooper\";\n    VP[\"phantom\"] = \"Phantom\";\n}\n\nfunction updateStyles() {\n    // Changes some stylesheets to open up to things like resizable right panel.\n    for(let i1 = 0; i1 < stylesheets.length; i1++) {\n        let styleSheet = stylesheets[i1];\n        for (let i2 = 0; i2 < styleSheet.rules.length; i2++) {\n            let rule = styleSheet.rules[i2];\n            switch(rule.selectorText) {\n                case \".p_i\":\n                    rule.style.setProperty(\"display\", \"flex\");\n                    break;\n                case \".rightui\":\n                    rule.style.setProperty(\"width\", aleiSettings.rightPanelSize);\n                    break;\n                case \".pa1\":\n                    rule.style.setProperty(\"flex-grow\", 0);\n                    rule.style.setProperty(\"flex-shrink\", 0);\n                    break;\n                case \".pa2\":\n                    rule.style.setProperty(\"width\", \"100%\");\n                    break;\n                case \".opcode_field\":\n                    rule.style.setProperty(\"font-size\", aleiSettings.triggerEditTextSize);\n                    break;\n                case \"#rparams\":\n                    rule.style.setProperty(\"height\", \"var(--ALEI_RPARAMS_HEIGHT)\");\n                    break;\n                default:\n                    break;\n            }\n        }\n    }\n    $id(\"stars\").style.setProperty(\"background-image\", `url(${aleiSettings.starsImage})`)\n    let _th = THEME;\n    ThemeSet(THEME_BLUE);\n    ThemeSet(_th);\n}\n\nfunction updateSkins() {\n    // Adds skins that exist in game but not in ALE.\n    let charlists = [\n        [10, \"Head Gib\"],\n        [20, \"Arm Gib\"],\n        [30, \"Leg Gib\"],\n        [50, \"Heavy Hero (Only Head and Arms)\"],\n        [60, \"Proxy (Only Head and Arms)\"],\n        [62, \"Proxy (No Limbs)\"],\n\n        [38, \"GoldenKnife Noir Lime\"],\n        [39, \"RootZ Noir Lime\"],\n\n        [151, \"Purple Xin\"],\n        [152, \"Golden Xin\"],\n        [153, \"Blue Xin\"],\n        [154, \"Red Xin\"],\n        [155, \"Amber Xin\"],\n\n        [156, \"Nirvana Noir Lime\"],\n\n        [157, \"Purple Gallynew\"],\n        [158, \"Golden Gallynew\"],\n        [159, \"Blue Gallynew\"],\n        [160, \"Red Gallynew\"],\n        [161, \"Amber Gallynew\"],\n\n        [162, \"Pinkine\"],\n        [163, \"Raider (by Serpent)\"],\n        [164, \"Blue Heavy Hero\"],\n        [165, \"Red Heavy Hero\"],\n        [166, \"Orakin\"],\n        [167, \"Husk\"],\n        [168, \"Hex\"],\n        [169, \"Arrin\"],\n        [170, \"Heavy Usurpation Soldier\"],\n\n        [171, \"Cyber Grub by S1lk\"],\n        [172, \"Grosk\"],\n        [173, \"Futuristic Knight\"],\n        [174, \"Uncivil Proxy\"],\n\n        [175, \"Serkova Insertion Unit\"],\n        [176, \"Xenos Scout\"],\n\n        [177, \"Armored Trooper\"],\n\n        [178, \"Newgen Marine\"],\n        [179, \"Elurra (by Lin)\"],\n        [180, \"Phantom Proxy (Unofficial Name)\"],\n        [181, \"Huntsman (Night)\"],\n        [182, \"Huntsman (Swamp)\"],\n        [183, \"Lt. Ferro (by Serpent)\"],\n        [184, \"Xenos Titan\"],\n        [185, \"Elurra (Masked) (by Lin)\"],\n        [186, \"Drohnen Heavy (by Ark633)\"],\n        [187, \"Cromastakan\"],\n        [188, \"Sgt. Davais\"],\n        [189, \"Maroon (by Francis localhost)\"],\n        [190, \"Drohnen Skirmisher (by Ark633)\"],\n        [191, \"Serkova Recon Unit\"],\n        [192, \"Drohnen Drifter (by Ark633)\"],\n        [193, \"Xenos Marine\"],\n        [194, \"Phantom Android SLC-56 (Unofficial Name)\"],\n        [195, \"Wraith (by Ark633)\"],\n        [196, \"Serkova Armored Unit\"],\n        [197, \"Phantom\"],\n        [198, \"Blue Civil Security Heavy\"],\n        [199, \"Red Civil Security Heavy\"],\n        [200, \"Xenos Welder\"],\n        [201, \"Xenos Engineer\"],\n        [202, \"Serkova Assault Unit\"],\n        [203, \"Serkova Gunner Unit\"],\n        [204, \"Serkova Grenader Unit\"],\n        [205, \"Serkova Team Leader\"],\n        [206, \"Serkova Resource Unit\"],\n        [207, \"Serkova Technician Unit\"],\n        [208, \"Serkova Grub\"],\n        [209, \"Serkova Reinforced Grub\"],\n        [210, \"Serkova Devastator Grub\"],\n        [211, \"XBT-117 Android\"],\n        [212, \"Teneguilae\"],\n        [213, \"Walker (by Serpent)\"],\n        [214, \"Space Grub (by Broforce1)\"],\n        [215, \"Phantom (Blue)\"],\n        [216, \"Phantom (Red)\"]\n    ]\n    for(let li = 0; li < charlists.length; li++) {\n        let charID = charlists[li][0];\n        let paddedCharID = charID.toString().padStart(4, \"0\")\n        let charName = charlists[li][1];\n        let src = \"https://www.plazmaburst2.com/level_editor/chars_full/char\" + paddedCharID + \".png\"\n        VAL_TABLE['char'][charID] = _turnLinkIntoSkinSpan(src, charName);\n        img_chars_full[charID] = new Image();\n        img_chars_full[charID].src = 'chars_full/char' + paddedCharID + '.png';\n    }\n\n    let ids = Object.keys(VAL_TABLE[\"char\"]);\n    ids = ids.map(str => parseInt(str));\n    let fromID = Math.max(...ids) + 1;\n    fetchSkinsFrom(fromID);\n}\n\nfunction _turnLinkIntoSkinSpan(src, charName) {\n    return '<span style=\\'background:url(' + src + '); width: 16px; height: 16px; display: inline-block; background-position: center; background-position-x: 30%; background-position-y: 26%; background-size: 67px;vertical-align: -4px;\\'></span> ' + charName;\n}\n\nasync function fetchSkinsFrom(startingID) {\n    if(!isNative) {\n        NewNote(`ALEI: Will not check for any undetected skins as the function requires tampermonkey-specific function.`, `#FFFF00`);\n        return;\n    }\n    const requestsAtOnce = 5;\n    let requestsRunning = true;\n    let skinsAdded = [];\n\n    async function requestSkin(id) {\n        let paddedCharID = id.toString().padStart(4, \"0\");\n        let src = \"https://www.plazmaburst2.com/level_editor/chars_full/char\" + paddedCharID + \".png\"\n        let response = await GM.xmlHttpRequest({ url: src }).catch(e => console.error(e));\n        if(response.status == 404) {\n            requestsRunning = false;\n            return;\n        }\n        VAL_TABLE[\"char\"][id] = _turnLinkIntoSkinSpan(src, `Unknown Skin #${id}`);\n        skinsAdded.push(id);\n    }\n    async function requestBatch(id) {\n        let promises = [];\n        for (let i = 0; i < requestsAtOnce; i++) {\n            promises.push(requestSkin(id + i));\n        }\n        await Promise.all(promises);\n    }\n    let fromID = startingID;\n    while(requestsRunning) {\n        await requestBatch(fromID);\n        fromID += requestsAtOnce;\n    }\n    if(skinsAdded.length > 0) {\n        NewNote(`ALEI: There are ${skinsAdded.length} unregistered skins, please inform ALEI developer(s) about this. Check logs for more information`, `#00FFFF`);\n        aleiLog(INFO, `Unregistered skins: ${skinsAdded}`);\n    }\n}\n\nfunction optimize() {\n    // VSync.\n    window.setTimeout = (f, ms) => {\n        if (f == ani) {window.requestAnimationFrame(ani)}\n        else return JS_setTimeout(f, ms);\n    }\n    let _browseImages = window.BrowseImages;\n    let ogImageLists = {};\n    // Image caching.\n    window.BrowseImages = function(for_class = 'bg_model', current_value = '', callback = null) {\n        // If cache doesn't have the class we are looking for, we will just set default value.\n        if (ogImageLists[for_class] == undefined) {\n            ogImageLists[for_class] = \"[ALEI] Loading...\";\n            aleiLog(INFO, `Will cache response of ${for_class}`);\n        }\n        // Overwrite setTimeout temporarily, as BrowseImages calls setTimeout for ServerRequest which sets the innerHTML of image_list\n        let ost = window.setTimeout;\n        window.setTimeout = (f, ms) => {\n            window.setTimeout = ost; // Assign original setTimeout\n            window.ServerRequest = (req, op, callback = null) => {\n                window.ServerRequest = ALEI_ServerRequest; // Assign original ServerRequest\n                // We made ServerRequest an async function, so we can just register on it\n                ServerRequest(req, op, callback).then(() => {\n                    ogImageLists[for_class] = image_list.innerHTML;\n                });\n            };\n            f();\n        }\n        _browseImages(for_class, current_value, callback);\n        image_list.innerHTML = ogImageLists[for_class]; // Show what is in cache. (If cache didn't have the class, it will just show the previously set default value)\n    }\n}\n\nfunction updateVehicles() {\n    // Adding vehicles that exist in game but not in ALE. Currently only veh_hh, which is grabbable ledge.\n    let _SVTV = VAL_TABLE[\"vehicle_model\"];\n    let vehicles = [\n        [\"veh_hh\", \"Grabbable Ledge\", \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACLSURBVEhLYxhxgBFE2M3/r/vvH0MQWISGgImJYd2hRMbLIDbYYpu5/+t/MzEEf2diuALi0wJw/mPQYf3HsPZIMmMjiA+3+BMLg/olIYblID4tgN47hki+Pww3YRYzgUUHAIxaTDcwajHdwKjFdAOjFtMNjFpMNzBqMd3AqMV0AwPbrh6InsQAAQYGAA8CLDKAAcpOAAAAAElFTkSuQmCC\"]\n    ]\n    for(let i = 0; i < vehicles.length; i++) {\n        let vehicle = vehicles[i];\n        let model = vehicle[0];\n        let name = vehicle[1];\n        let image = vehicle[2];\n        _SVTV[model] = `<img src='${image}' border=0 height=12 style=vertical-align:middle title='${name}' > ${name}`\n        img_vehicles[model] = new Image();\n        img_vehicles[model].src = image;\n    }\n}\n\nfunction updateGuns() {\n    // Adds guns that exist in game but not in ALE. Currently only one isn't visible in ALE, and that is joke weapon: NARL\n    let guns = [\n        [\"gun_rl0\", \"BETA Rocket Launcher\", \"data:image/png;base64,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\"]\n    ];\n    for(let i = 0; i < guns.length; i++) {\n        let gun = guns[i];\n        let gun_model = gun[0];\n        let gun_name = gun[1];\n        let gun_image = gun[2];\n        VAL_TABLE[\"gun_model\"][gun_model] = `<img src='${gun_image}' border=0 width=80 height=20 style=vertical-align:baseline title='${gun_name}'>`\n        img_guns[gun_model] = new Image();\n        img_guns[gun_model].src = gun_image;\n    }\n}\n\nfunction updateDecors() {\n    // Adds decors that exist in game, but not in ALE. Currently only hakase easter egg is known.\n    window.img_decors = CACHED_DECORS; // For some reason img_decors gets resetted\n    let decors = [\n        [\"hakase\", \"Hakase\", \"data:image/png;base64,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\"]\n    ];\n    for(let i = 0; i < decors.length; i++) {\n        let decor = decors[i];\n        let decor_model = decor[0];\n        let decor_name = decor[1];\n        let decor_image = decor[2];\n        VAL_TABLE[\"decor_model\"][decor_model] = decor_name; // Add to known decors.\n        img_decors[decor_model] = new Image();\n        img_decors[decor_model].src = decor_image;\n        CACHED_DECORS[decor_model] = img_decors[decor_model];\n        CUSTOM_IMAGES_APPROVED[decor_model] = true; // Since it's obviously vanilla, and other vanilla decors are approved, it's only natural if we approve added decors too\n    }\n    window.ALEI_decors = decors;\n}\n\nfunction updateOffsets() {\n    // Because hakase decor and grabbable ledge image is made with hand manually and doesn't come from website, and that there is no\n    // inbuilt offset, we have to offset those to make sure they show up in ALE correctly.\n    let toosc = window.ThinkOfOffsetClass;\n    window.ThinkOfOffsetClass = function(tc, esi) {\n        if (tc == \"vehicle\" && offsets[esi.pm.model] != undefined) {\n            return \"alei_\" + esi.pm.model;\n        } else if (tc == \"decor\" && offsets[esi.pm.model] != undefined) {\n            return \"alei_\" + esi.pm.model;\n        } else return toosc(tc, esi);\n    }\n    let offsets = {\n        veh_hh: {x: -15, y: -15, w: 30, h: 30},\n        hakase: {x: -18, y: -57, w: 40, h: 60}\n    }\n    for (let key in offsets) {\n        let off = offsets[key];\n        lo_x[\"alei_\" + key] = off.x;\n        lo_y[\"alei_\" + key] = off.y;\n        lo_w[\"alei_\" + key] = off.w;\n        lo_h[\"alei_\" + key] = off.h;\n    }\n}\n\nfunction updateTriggers() {\n    // This is where we will rename some triggers.\n    // For now it's only 378, but we got more triggers like renaming 328\n    addTrigger(175, \"Gun &#8250; Change gun 'A' projectile model to 'B'\", \"gun\", \"ALEI_projectileModels\");\n    addTrigger(378, \"Gun &#8250; Add hex color 'B' to gun 'A'\", \"gun\", \"string\");\n    addTrigger(332, \"Var &#8250; Set variable 'A' to value 1 if Gun 'B' is in owner's active slot, set to value 0 in else case\", \"string\", \"gun\");\n}\n\nfunction updateObjects() {\n    // Shorthand for object-related functions as to not clutter console.\n    updateGuns();\n    updateVehicles();\n    updateDecors();\n    updateTriggers();\n}\n\nfunction updateButtons() {\n    let topPanel = $id(\"top_panel\");\n    let childs = topPanel.children;\n\n    // We redirect the manual page to EaglePB2's.\n    childs[16].value = \"Eagle's Manual\";\n    childs[16].setAttribute(\"onclick\", \"window.open('https://eaglepb2.gitbook.io/pb2-editor-manual/', '_blank');\")\n\n    // We dont want our new buttons to appear after \"rights\", so we will store \"rights\" beforehand and remove them, we'll add them back once we are done\n    let appendBack = (topPanel.removeChild(childs[childs.length - 1])).outerHTML;\n    appendBack = (topPanel.removeChild(childs[childs.length - 1])).outerHTML + appendBack;\n\n    // Remove pad (we will add our own later).\n    topPanel.removeChild(childs[childs.length - 1])\n\n    window.aleiButtonClicks = {};\n\n    // Convenience function for doing easy top panel buttons\n    function createButton(text, internalName, onClick) {\n        let button = document.createElement(\"input\");\n        button.setAttribute(\"class\", \"field_btn\");\n        button.setAttribute(\"type\", \"button\");\n        button.setAttribute(\"value\", text);\n        button.setAttribute(\"onclick\", `aleiButtonClicks['${internalName}']()`);\n        window.aleiButtonClicks[internalName] = onClick;\n\n        let pad = document.createElement(\"div\");\n        pad.setAttribute(\"class\", \"q\");\n\n        topPanel.appendChild(button);\n        topPanel.appendChild(pad);\n    }\n    let bigPad = document.createElement(\"div\");\n    bigPad.setAttribute(\"class\", \"q3\");\n    topPanel.appendChild(bigPad);\n\n    // \"Download XML\" button.\n    createButton(\"Download XML\", \"downloadXMLButton\", exportXML);\n    // \"Insert XML\" button.\n    createButton(\"Insert XML\", \"insertXMLButton\", () => {\n        let file = confirm(\"File (OK) or text (Cancel) ?\");\n\n        if (file) {\n            let fileInput = document.createElement(\"input\");\n\n            fileInput.type = \"file\";\n\n            fileInput.onchange = function() {\n                if (fileInput.files[0]) {\n                    if (fileInput.files[0].name.split(\".\")[1] == \"xml\") {\n                        let reader = new FileReader();\n\n                        reader.onload = function() {\n                            insertXML(reader.result);\n\n                            fileInput.remove();\n                        }\n\n                        reader.readAsText(fileInput.files[0]);\n                    } else {\n                        alert(\"Invalid file extension.\");\n                    }\n                }\n            }\n\n            fileInput.click();\n        } else {\n            let xml = prompt(\"Enter XML:\", \"\");\n\n            if (xml !== null) {\n                insertXML(xml);\n            }\n        }\n    });\n    createButton(\"ALEI Settings\", \"openALEISettings\", showSettings);\n    // Readd 'rights' back.\n    topPanel.innerHTML += appendBack;\n    // Update original reference\n    window.mapid_field = $id(\"mapid_field\");\n    mapid_field.value = mapid; // And update map id field value manually.\n}\n\nfunction addClipboardSync() {\n    let clipboard_channel = new BroadcastChannel(\"ale_clipboard\");\n\n    ///////////////\n    // Receiving //\n    ///////////////\n    clipboard_channel.onmessage = (msg) => {\n        let data = msg.data;\n        let kind = data.kind;\n        if (kind == \"send\") {\n            let recipient = data.recipient;\n            let clip_name  = data.clip_name;\n            let clip_data  = data.clip_data;\n\n            if (recipient == undefined || recipient == aleiSessionID) {\n                aleiLog(DEBUG, '/ale_clipboard/ got data for ' + clip_name);\n                sessionStorage[clip_name] = clip_data;\n            }\n        }\n        if (kind == \"get\") {\n            if (aleiSessionID > Math.min(...aleiSessionList)) return;\n\n            let session_id = data.session_id;\n            aleiLog(DEBUG, '/ale_clipboard/ syncing to ' + session_id);\n            for (let i = 0; i <= 10; i++) {\n                let clip_name = \"clipboard\" + (i == 0 ? \"\" : (\"_slot\" + (i-1)));\n                let clip_data = sessionStorage[clip_name];\n                if (clip_data == undefined) continue;\n                clipboard_channel.postMessage({kind: \"send\", recipient: session_id, clip_name, clip_data});\n            }\n        }\n    }\n\n    // Initial Sync\n    aleiLog(DEBUG, '/ale_clipboard/ requesting');\n    clipboard_channel.postMessage({kind: \"get\", session_id: aleiSessionID});\n\n    /////////////\n    // Sending //\n    /////////////\n    let ALE_CopyToClipBoard = window.CopyToClipBoard;\n    window.CopyToClipBoard = (clip_name) => {\n        ALE_CopyToClipBoard(clip_name);\n        let clip_data = sessionStorage[clip_name];\n        clipboard_channel.postMessage({kind: \"send\", clip_name, clip_data});\n    }\n}\n\nasync function addSessionSync() {\n    // This function registers some events, as to talk with other tabs\n    // For now, this is useful for clipboard sync, but we probably can have more.\n    const PROBE_TIMEOUT_MS = 200;\n    let session_channel = new BroadcastChannel(\"ale_session\");\n\n    // Receive data\n    session_channel.onmessage = (msg) => {\n        let data = msg.data;\n        let kind = data.kind;\n        // New ALEI instance started up.\n        if (kind == \"start\") {\n            if (aleiSessionID == null) return;\n            session_channel.postMessage({kind: \"greet\", id: aleiSessionID});\n            aleiLog(DEBUG, \"/ale_session/ recieved start\");\n        }\n        // An ALEI instance responded to new ALEI instance, registering the ALEI instance\n        if (kind == \"greet\") {\n            let session_id = data.id;\n            if (!aleiSessionList.includes(session_id))\n                aleiSessionList.push(session_id);\n            aleiLog(DEBUG, \"/ale_session/ received greet by \" + session_id);\n        }\n        // An ALEI instance is closing\n        if (kind == \"close\") {\n            let session_id = data.id;\n            aleiSessionList.splice(aleiSessionList.indexOf(session_id), 1);\n            aleiLog(DEBUG, \"/ale_session/ received close by \" + session_id);\n        }\n    }\n\n    // Probe for other sessions\n    session_channel.postMessage({kind: \"start\"});\n    aleiLog(DEBUG, \"/ale_session/ probing\");\n    await new Promise(resolve => {\n        JS_setTimeout(resolve, PROBE_TIMEOUT_MS);\n    });\n\n    // Assign own session ID\n    if (aleiSessionList.length == 0)\n        aleiSessionID = 0;\n    else\n        aleiSessionID = Math.max(...aleiSessionList) + 1;\n\n    aleiLog(DEBUG, \"/ale_session/ session ID \" + aleiSessionID);\n\n    // Tell other sessions that this one is done\n    window.addEventListener('beforeunload', (event) => {\n        session_channel.postMessage({kind: \"close\", id: aleiSessionID});\n    });\n\n    addClipboardSync();\n}\n\nfunction addPropertyPanelResize() {\n    // Gives right panel ability to be resized.\n\n    let splitter_is_down = false;\n    const splitter = document.createElement(\"div\");\n    const root = document.documentElement;\n\n    splitter.style.position = \"absolute\";\n    splitter.style.width = \"5px\";\n    splitter.style.top = \"50px\";\n    splitter.style.height = \"100%\";\n    splitter.style.cursor = \"w-resize\";\n    // splitter.style[\"background-color\"] = \"black\";\n    $id('floattag').appendChild(splitter);\n\n    function splitter_resize(e) {\n        let new_width = Math.min(root.clientWidth - 100, Math.max(100, root.clientWidth - e.clientX));\n        right_panel.style.width = new_width + 'px';\n        splitter.style.right = new_width + 'px';\n        ROOT_ELEMENT.style.setProperty(\"--param_panel_size\", splitter.style.right);\n        updateBoxSplitterSize();\n    }\n\n    splitter.addEventListener('mousedown', (e) => {\n        splitter_is_down = true;\n    });\n\n    root.addEventListener('mouseup', (e) => {\n        splitter_is_down = false;\n        writeStorage('ALEI_RightPanelWidth', right_panel.clientWidth + 'px');\n    });\n\n    root.addEventListener('mousemove', (e) => {\n        if (splitter_is_down) splitter_resize(e);\n    });\n\n    splitter.style.right = aleiSettings.rightPanelSize;\n    ROOT_ELEMENT.style.setProperty(\"--param_panel_size\", splitter.style.right);\n    window.splitter = splitter;\n}\n\nfunction addTriggerIDs() {\n    if (!aleiSettings.showTriggerIDs) return;\n\n    let SVTTP = VAL_TABLE['trigger_type'];\n    for (let i in SVTTP) {\n        SVTTP[i] = i + \" \" + SVTTP[i];\n    }\n}\n\nfunction patchShowHideButton() {\n    let og = window.ShowHideObjectBox;\n    window.ShowHideObjectBox = function() {\n        og();\n        let rparams = $id(\"rparams\");\n        let heightOffset = {true: 270, false: 155}[ObjectBox_visible];\n        if (rparams != null) {\n            heightOffset = Math.round(rparams.getBoundingClientRect().top + 13);\n        }\n        // We then set variable and call original function.\n        document.documentElement.style.setProperty(\"--ALEI_RPARAMS_HEIGHT\", `calc(100vh - ${heightOffset}px)`);\n        //og();\n    }\n    ShowHideObjectBox();\n    ShowHideObjectBox(); // Hacky way to fix bug\n}\n\nwindow.ALEI_CustomSnapping = () => {\n    let snapping = prompt(\"Enter snapping:\", \"\");\n\n    if(!snapping) return;\n    if(isNaN(Number(snapping))) {NewNote(\"Invalid snapping.\", \"#FF0000\"); return};\n\n    if (snapping < 0.1) {\n        snapping = 0.1;\n        NewNote(\"ALEI: Snapping can't be less than 0.1\", \"#FF0000\");\n        return;\n    }\n\n    if (snapping > 100) {\n        snapping = 100;\n        NewNote(\"ALEI: Snapping can't be greater than 100\", \"#FF0000\");\n        return;\n    }\n\n    GridSnappingSet(Math.round(snapping * 10));\n}\n\nfunction addSnappingOptions_helper() {\n    // Remove default snapping options except for \"1\", we will replace it them later\n    $query(`a[onmousedown=\"GridSnappingSet(50);\"]`).remove();\n    $query(`a[onmousedown=\"GridSnappingSet(100);\"]`).remove();\n\n    let newHTML = \"\"\n    let snappingOptions = [\n        1, 2, 5,\n        10, 20, 40,\n        50, 100, \"C\"\n    ];\n\n    for (let snappingIndex in snappingOptions) {\n        let snapping = snappingOptions[snappingIndex];\n\n        if ((snappingIndex % 3 == 0) && (snappingIndex != 0)) {\n            // We have to break into new row.\n            newHTML += \"<br>\";\n        }\n\n        let element = document.createElement(\"a\");\n        // Set relevant attributes.\n\n        if (snapping != \"C\") {\n            element.innerHTML = snapping / 10;\n        } else {\n            element.innerHTML = \"C\";\n        }\n\n        let toolClass = \"tool_btn\";\n        if (GRID_SNAPPING == snapping) {\n            toolClass = \"tool_btn2\";\n        }\n\n        if (!snappingOptions.includes(GRID_SNAPPING) && snapping == \"C\") {\n            toolClass = \"tool_btn2\";\n        }\n\n        element.setAttribute(\"class\", `${toolClass} tool_wid`);\n        element.setAttribute(\"style\", \"width: 21px;\");\n\n        if (snapping != \"C\") {\n            element.setAttribute(\"onmousedown\", `GridSnappingSet(${snapping}); Render();`);\n        } else {\n            element.setAttribute(\"onmousedown\", \"ALEI_CustomSnapping(); Render();\");\n        }\n\n        newHTML += element.outerHTML;\n        // Add to main HTML.\n    }\n    // Replace original `1` snapping with new HTML.\n    $query(`a[onmousedown=\"GridSnappingSet(10);\"]`).outerHTML = newHTML;\n}\n\nwindow.ALEI_UpdateRematchUIDSetting = function(value) {\n\n    aleiSettings.rematchUID = value;\n    writeStorage(\"ALEI_RemapUID\", value);\n    UpdateTools();\n}\n\nfunction addRematchUIOptions_helper() {\n    $query(`a[onmousedown=\"EvalSet('param_panel_size',800);SaveBrowserSettings();UpdateCSS();\"]`).remove();\n\n    let result = document.evaluate(\"//span[contains(., 'Param')]\", left_panel, null, XPathResult.ANY_TYPE, null);\n    result.iterateNext();\n    result.iterateNext().innerHTML = \"Remap UID\";\n\n    for (let value of [[true, \"Yes\", 0], [false, \"No\", 200]]) {\n        let element = document.createElement(\"a\");\n        element.innerHTML = value[1];\n\n        let toolClass = \"tool_btn\";\n        if(aleiSettings.rematchUID == value[0]) toolClass = \"tool_btn2\";\n\n        element.setAttribute(\"class\", `${toolClass} tool_wid`);\n        element.setAttribute(\"style\", \"width: 64px;\");\n        element.setAttribute(\"onmousedown\", `ALEI_UpdateRematchUIDSetting(${value[0]})`);\n\n        $query(`a[onmousedown=\"EvalSet('param_panel_size',${value[2]});SaveBrowserSettings();UpdateCSS();\"]`).outerHTML = element.outerHTML;\n    }\n\n}\n\nwindow.ALEI_UpdateNameRenderSetting = function(status) { // TODO: we should have mixin function lol, check: <#1245454955477729382>\n    /*if(!status) {\n        let code = ALE_Render.toString().replace(\"if (es[i].pm.uid != undefined)\", \"if (false)\");\n        eval(code);\n        window.Render = Render;\n        aleiSettings.renderObjectNames = false;\n        writeStorage(\"ALEI_RenderObjectNames\", false);\n    } else {\n        window.Render = ALE_Render;\n        aleiSettings.renderObjectNames = true;\n        writeStorage(\"ALEI_RenderObjectNames\", true);\n    }*/\n    ENABLE_TEXT = status;\n    aleiSettings.renderObjectNames = status;\n    writeStorage(\"ALEI_RenderObjectNames\", status);\n    UpdateTools();\n    need_redraw = 1;\n}\nfunction addPreviewNamesOptions_helper() {\n    let prevElement = $query(`a[onmousedown=\"ShowTexturesSet(true);\"]`);\n\n    function space() {\n        let spacer = document.createElement(\"div\");\n        spacer.setAttribute(\"class\", \"q\");\n        prevElement.outerHTML += spacer.outerHTML;\n    }\n\n    let headerText = document.createElement(\"span\");\n    headerText.setAttribute(\"class\", \"gui_sel_info\");\n    headerText.innerHTML = \"Object Names\";\n\n    let buttonHTML = \"\";\n\n    function addButton(text, status) {\n        let button = document.createElement(\"a\");\n        let _class = \"tool_btn\";\n\n        if(status == aleiSettings.renderObjectNames) _class = \"tool_btn2\";\n\n        button.setAttribute(\"class\", `tool_wid ${_class}`);\n        button.setAttribute(\"style\", \"width: 32px\");\n        button.setAttribute(\"onmousedown\", `ALEI_UpdateNameRenderSetting(${status});`);\n        button.innerHTML = text;\n        buttonHTML += button.outerHTML;\n    }\n\n    addButton(\"Show\", true);\n    addButton(\"Hide\", false);\n\n    prevElement.outerHTML += `<br><div class=\"q\"></div><br>` + headerText.outerHTML + \"<br>\" + buttonHTML;\n\n}\n\nfunction onToolUpdate() {\n    addSnappingOptions_helper();\n    addRematchUIOptions_helper();\n    addPreviewNamesOptions_helper();\n}\n\nfunction patchUpdateTools() {\n    let ut = UpdateTools;\n    window.UpdateTools = function() {\n        ut();\n        onToolUpdate();\n    }\n    UpdateTools();\n    aleiLog(DEBUG, \"Patched updateTools.\");\n}\n\nfunction tryToNumber(x) {\n    if (!isNaN(Number(x))) {\n        return Number(x);\n    } else {\n        return x;\n    }\n}\n\nfunction insertXML(xml) {\n    xml = \"<map>\" + xml.replaceAll(\"&\", \"[__Amp]\") + \"</map>\";\n\n    let parser = new DOMParser();\n    let map = parser.parseFromString(xml, \"application/xml\");\n    let objects = map.querySelectorAll(\"*\");\n\n    for (let i = 1; i < objects.length; i++) {\n        let object = objects[i];\n        if (object.tagName == \"map\") continue;\n\n        let eo = new E(object.tagName);\n        eo.pm = {};\n\n        for (let j = 0; j < object.attributes.length; j++) {\n            let name = object.attributes[j].name;\n            let value = object.attributes[j].value;\n\n            eo.pm[name] = tryToNumber(value.replaceAll(\"[__Amp]\", \"&\"));\n        }\n\n        es.push(eo);\n    }\n\n    need_redraw = 1;\n    need_GUIParams_update = 1;\n}\n\nfunction exportXML() {\n    let exportSelection = 0;\n    let newstr = \"\";\n    let download = document.createElement(\"a\");\n\n    for (let i = 0; i < es.length; i++) {\n        if (es[i].selected) {\n            exportSelection = 1;\n        }\n    }\n\n    if (exportSelection) {\n        if(!confirm(\"Only selection will be exported.\")) return;\n        for (let i = 0; i < es.length; i++) {\n            if (es[i].selected) {\n                newstr += compi_obj(i);\n            }\n        }\n\n        if (mapid) {\n            download.download = mapid + \" (selection).xml\";\n        } else {\n            download.download = \"newmap (selection).xml\";\n        }\n    } else {\n        for (let i = 0; i < es.length; i++) {\n            if (es[i].exists) {\n                newstr += compi_obj(i);\n            }\n        }\n\n        if (mapid) {\n            download.download = mapid + \".xml\";\n        } else {\n            download.download = \"newmap.xml\";\n        }\n    }\n\n    download.href = \"data:text,\" + escape(newstr);\n\n    if (newstr != \"\") {\n        download.href = \"data:text,\" + escape(newstr);\n\n        download.click();\n    } else {\n        alert(\"Map is empty.\");\n    }\n\n    download.remove();\n}\n///////////////////////////////\nconst _ignoredKeys = [\n    // Numbers obviously cannot have texts.\n    \"x\",\n    \"y\",\n    \"w\",\n    \"h\",\n    \"maxcalls\",\n    \"command\",\n    \"upg\",\n    \"tox\",\n    \"toy\",\n    \"stab\",\n    \"damage\",\n    \"u\",\n    \"v\",\n    \"sx\",\n    \"sy\",\n    \"r\",\n    \"f\",\n    \"power\",\n    // Booleans obviously cannot have texts.\n    \"enabled\",\n    \"flare\",\n    // We are obviously not going to change UID\n    \"uid\",\n    // We are obviously not going to change models\n    \"gun_model\",\n    \"model\",\n];\nfunction updateUIDReferences(oldName, newName) {\n    aleiLog(DEBUG2, `Updating UID references from ${ANSI_CYAN}${oldName}${ANSI_RESET} to ${ANSI_CYAN}${newName}${ANSI_RESET}`);\n    for (let i = 0; i < es.length; i++) {\n        let element = es[i];\n        if (!element.exists) continue;\n        let properties = element.pm;\n\n        for (let entry of Object.entries(properties)) {\n            let key = entry[0];\n            let value = entry[1];\n\n            // Quick elimination\n            if (_ignoredKeys.indexOf(key) !== -1) continue;\n            if (typeof(value) !== \"string\") continue;\n            if (value.indexOf(oldName) === -1) continue;\n\n            // Actual replacement\n            if (value === oldName) { // Fine.\n                properties[key] = newName;\n                continue;\n            }\n\n            let splt = value.split(\",\");\n            for (let i = 0; i < splt.length; i++) {\n                let item = splt[i];\n                if (item.trim() == oldName) {\n                    splt[i] = item.replace(oldName, newName);\n                }\n            }\n            properties[key] = splt.join(\",\");\n        }\n    }\n    window.need_GUIParams_update = true;\n}\n\nfunction UpdatePhysicalParam(paramname, chvalue) {\n    lcz();\n    var layer_mismatch = false;\n    var list_changes = '';\n    for (var elems = 0; elems < es.length; elems++)\n        if (es[elems].exists && es[elems].selected)\n            if (es[elems].pm.hasOwnProperty(paramname)) {\n                if (MatchLayer(es[elems])) {\n                    if (paramname == \"uid\" && aleiSettings.rematchUID) {\n                        updateUIDReferences(es[elems].pm.uid, chvalue);\n                    }\n\n                    var lup = (typeof(paramname) == 'string') ? '\"' + paramname + '\"' : paramname;\n                    if (typeof(chvalue) == 'number' || ((chvalue === 0))) {\n                        lnd('es[' + elems + '].pm[' + lup + '] = ' + es[elems].pm[paramname] + ';');\n                        ldn('es[' + elems + '].pm[' + lup + '] = ' + chvalue + ';');\n                        es[elems].pm[paramname] = Number(chvalue);\n                    } else if (typeof(chvalue) == 'string') {\n                        lnd('es[' + elems + '].pm[' + lup + '] = \"' + es[elems].pm[paramname] + '\";');\n                        ldn('es[' + elems + '].pm[' + lup + '] = \"' + chvalue + '\";');\n                        es[elems].pm[paramname] = _encodeXMLChars(chvalue);\n                    } else {\n                        alert('Unknown value type: ' + typeof(chvalue));\n                    }\n                    list_changes += 'Parameter \"' + paramname + '\" of object \"' + (es[elems].pm.uid != null ? es[elems].pm.uid : es[elems]._class) + '\" was set to \"' + chvalue + '\"<br>';\n                    if(paramname == \"uses_timer\") { // I do not have to do this, but i will for convenience\n                        if([true, \"true\"].indexOf(es[elems].pm.uses_timer) != -1) {\n                            param_type[REGION_EXECUTE_PARAM_ID][1] = \"timer+none\";\n                        } else {\n                            param_type[REGION_EXECUTE_PARAM_ID][1] = \"trigger+none\";\n                        }\n                        need_GUIParams_update = true;\n                    }\n                } else layer_mismatch = true;\n            } need_redraw = true;\n    NewNote('Operation complete:<br><br>' + list_changes, note_passive);\n    if (layer_mismatch) NewNote('Note: Some changes weren\\'t made due to missmatch of active layer and class of selected objects', note_neutral);\n    lfz(false);\n\n    sortObjects();\n}\n\nlet imageContextMap = {};\nwindow.aleiContextRenameImage = function(id) {\n    var v = prompt('New name:', imageContextMap[id]);\n    CloseImageContext();\n    if ( v !== null ) {\n        ServerRequest(`a=get_images&for_class=${last_for_class}&set_title_for=${id}&value=${v}`, \"rename_image\");\n    }\n}\nwindow.aleiContextDeleteImage = function(id) {\n    let v = confirm(`Are you sure you want to delete ${imageContextMap[id]} ?`);\n    CloseImageContext();\n    if ( v ) {\n        last_element.style.opacity = '0.5';\n        ServerRequest(`a=get_images&for_class=${last_for_class}&delete=${id}`, 'delete_image' );\n    }\n}\n\nfunction ImageContext(id, e, old_name, element, moderator_menu, awaiting_approval=false, login='?', approver='?', is_fav_menu = false) {\n    imageContextMap[id] = old_name;\n    last_element = element;\n    last_login = login;\n    e.preventDefault();\n\n    var image_context = document.getElementById('image_context');\n\n    var str = '';\n\n    if (moderator_menu) {\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&approve_for=${id}', 'approve_image' ); }, 1 );\">Approve <img src=\"../images/ap.png\" width=\"11\" height=\"11\"></div>`;\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&reset_status_for=${id}', 'reset_approval_image' ); }, 1 );\">Reset approval status</div>`;\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { open_approved_decor_model = true; SaveFiltering(); search_phrase = '*by_login*'+last_login; UpdateImageList(); }, 1 );\">Search for other approved images from &quot;${login}&quot;</div>`;\n        str += `<div onclick=\"\" style=\"color:rgba(0,0,0,0.3)\">Last status change by ${approver}</div>`;\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&disapprove_for_all='+last_login, 'disapprove_image' ); }, 1 );\">Disapprove all unreviewed from &quot;${login}&quot; <img src=\"../images/noap.png\" width=\"11\" height=\"11\"><img src=\"../images/noap.png\" width=\"11\" height=\"11\"><img src=\"../images/noap.png\" width=\"11\" height=\"11\"></div>`;\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&disapprove_for=${id}', 'disapprove_image' ); }, 1 );\">Disapprove <img src=\"../images/noap.png\" width=\"11\" height=\"11\"></div>`;\n\n    } else {\n        //console.log( login, curlogin );\n\n        if (login == curlogin && approver != '!') {\n            str += `<div onclick=\"aleiContextRenameImage(${id})\">Rename</div>`; // We overwrite rename action to our own.\n\n            if (awaiting_approval) {\n                str += `<div onclick=\"\" style=\"color:rgba(0,0,0,0.3)\">Request Approval (already done)</div>`;\n                str += `<div onclick=\"CloseImageContext();  setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&deawait_approval_for=${id}', 'await_approval_status' ); }, 1 ); \">Exclude from approval review queue</div>`;\n            } else {\n                if (old_name == 'Untitled') {\n                    str += `<div onclick=\"alert('Proper name required for custom image - you will not be available to change name once image is approved.');\" style=\"color:rgba(0,0,0,0.3)\">Request Approval (proper name required)</div>`;\n                } else {\n                    str += `<div onclick=\"CloseImageContext();  setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&await_approval_for=${id}', 'await_approval_status' ); }, 1 ); \">Request Approval <img src=\"../images/ap.png\" width=\"11\" height=\"11\"></div>`;\n                }\n                str += `<div onclick=\"\" style=\"color:rgba(0,0,0,0.3)\">Exclude from approval review queue (not in queue)</div>`;\n            }\n\n            str += `<div onclick=\"aleiContextDeleteImage(${id})\">Delete <img src=\"../images/noap.png\" width=\"11\" height=\"11\"></div>`;\n        } else {\n            str += `<div onclick=\"CloseImageContext(); setTimeout( function() { open_approved_decor_model = true; SaveFiltering(); search_phrase = '*by_login*'+last_login; UpdateImageList(); }, 1 );\">Search for other approved images from &quot;${login}&quot;</div>`;\n        }\n\n        str += `<span style=\"display:block;\">&nbsp;</span>`;\n        if (is_fav_menu) {\n            str += `<div onclick=\"CloseImageContext();  setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&favorite_del=${id}', 'favorite_status' ); }, 1 ); \">Remove from favorites</div>`;\n        } else {\n            str += `<div onclick=\"CloseImageContext();  setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&favorite_add=${id}', 'favorite_status' ); }, 1 ); \">Add to favorites</div>`;\n        }\n\n    }\n\n    image_context.innerHTML = str;\n\n    image_context.style.left = e.clientX;\n    image_context.style.top = e.clientY;\n    image_context.style.display = 'block';\n\n    image_context_cancel_pad.style.display = 'block';\n\n    return false;\n}\n\nfunction findObjects(name) {\n    let exact = confirm(\"Exact name?\");\n    let notFound = 1;\n\n    function pred(d) {\n        if (exact) {return d == name;}\n        else {return d.includes(name)}\n    }\n\n    for (let i = 0; i < es.length; i++) {\n        es[i].selected = 0;\n\n        if (es[i].pm.uid) {\n            if (pred(es[i].pm.uid) && MatchLayer(es[i])) {\n                es[i].selected = 1;\n                notFound = 0;\n            }\n        }\n    }\n\n    need_GUIParams_update = 1;\n    need_redraw = 1;\n\n    return notFound;\n}\n\nfunction rotateObjects() {\n    let selected = getSelection();\n    let distX = [];\n    let distY = [];\n    let minX;\n    let minY;\n\n    for (let i = 0; i < selected.length; i++) {\n        if (selected[i].pm.w && selected[i].pm.h) {\n            let save = selected[i].pm.w;\n\n            selected[i].pm.w = selected[i].pm.h;\n            selected[i].pm.h = save;\n        }\n\n        distX.push(selected[i].pm.x);\n        distY.push(selected[i].pm.y);\n    }\n\n    minX = Math.min(...distX);\n    minY = Math.min(...distY);\n\n    for (let i = 0; i < selected.length; i++) {\n        distX[i] -= minX;\n        distY[i] -= minY;\n\n        selected[i].pm.x = minX + distY[i];\n        selected[i].pm.y = minY + distX[i];\n    }\n}\n\nfunction RandomizeName(oldname) {\n    var newname = oldname;\n    var phrase = \"*\";\n    var unoriginal;\n    for (var i = 0; i < es.length; i++)\n        if (es[i].exists)\n            if (es[i].pm.uid != undefined) {\n                if (es[i].pm.uid == newname) {\n                    unoriginal = true;\n                    oldname = newname;\n                }\n            }\n    if (unoriginal) {\n        var takes = 0;\n        do {\n            unoriginal = false;\n            var indof = oldname.lastIndexOf(phrase);\n            var copysuffix = Math.floor(oldname.substring(indof + 1));\n            if (indof == -1 || isNaN(copysuffix)) {\n                newname = oldname + phrase + '1';\n            } else {\n                newname = oldname.substring(0, indof) + phrase + (copysuffix + 1);\n            }\n            takes += 1;\n            for (var i = 0; i < es.length; i++)\n                if (es[i].exists)\n                    if (es[i].pm.uid != undefined) {\n                        if (es[i].pm.uid == newname) {\n                            unoriginal = true;\n                            oldname = newname;\n                        }\n                    }\n        } while (unoriginal);\n    }\n    return newname;\n}\n\nfunction patchRandomizeName() {\n    window.RandomizeName = RandomizeName;\n}\n\nfunction patchAllowedCharacters() {\n    allowed_string_chars += \"<>\";\n}\n\nfunction getRuleBySelector(selector) {\n    let rules = document.styleSheets[0].rules;\n    let rule;\n\n    for (let i = 0; i < rules.length; i++) {\n        if (rules[i].selectorText == selector) {\n            rule = rules[i];\n        }\n    }\n\n    return rule;\n}\n\nfunction setStyle(selector, style, value) {\n    getRuleBySelector(selector).style[style] = value;\n}\n\nfunction blackTheme() {\n    ThemeSet(0);\n\n    THEME = 4;\n\n    setStyle(\".topui\", \"backgroundSize\", \"0px\");\n    setStyle(\".leftui\", \"backgroundSize\", \"0px\");\n    setStyle(\".rightui\", \"backgroundSize\", \"0px\");\n    setStyle(\".topui\", \"backgroundColor\", \"#101010\");\n    setStyle(\".leftui\", \"backgroundColor\", \"#101010\");\n    setStyle(\".rightui\", \"backgroundColor\", \"#101010\");\n    setStyle(\".field_btn\", \"backgroundColor\", \"#202020\");\n    setStyle(\".tool_btn\", \"backgroundColor\", \"#202020\");\n    setStyle(\".tool_btn\", \"border\", \"\");\n    setStyle(\".tool_btn2\", \"backgroundColor\", \"#333\");\n    setStyle(\".tool_btn2\", \"border\", \"1px solid #888\");\n    setStyle(\".field_btn\", \"color\", \"#CCC\");\n    setStyle(\".tool_btn\", \"color\", \"#CCC\");\n    setStyle(\".tool_btn2\", \"color\", \"#CCC\");\n    setStyle(\".gui_sel_info\", \"color\", \"#CCC\");\n    setStyle(\".c\", \"color\", \"#CCC\");\n    setStyle(\".pa1\", \"color\", \"#CCC\");\n    setStyle(\".pa2\", \"color\", \"#CCC\");\n    setStyle(\".field_dis_left\", \"color\", \"#CCC\");\n    setStyle(\".field_dis_right\", \"color\", \"#CCC\");\n    setStyle(\".p_u1\", \"border\", \"\");\n    setStyle(\".p_u2\", \"border\", \"\");\n    setStyle(\".pa1\", \"backgroundColor\", \"#202020\");\n    setStyle(\".pa2\", \"backgroundColor\", \"#000000\");\n    setStyle(\".objbox\", \"backgroundColor\", \"#000000\");\n    setStyle(\".field_dis_left\", \"backgroundColor\", \"#202020\");\n    setStyle(\".field_dis_right\", \"backgroundColor\", \"#000000\");\n    setStyle(\".selline1\", \"backgroundColor\", \"#202020\");\n    setStyle(\".tool_btn:hover\", \"backgroundColor\", \"#202020\");\n    setStyle(\".tool_btn:hover\", \"border\", \"1px solid #888\");\n    setStyle(\".tool_btn:hover\", \"color\", \"#CCC\");\n    setStyle(\".tool_btn2:hover\", \"backgroundColor\", \"#333\");\n    setStyle(\".tool_btn2:hover\", \"border\", \"1px solid #888\");\n    setStyle(\".tool_btn2:hover\", \"color\", \"#CCC\");\n    setStyle(\".field_btn:hover\", \"backgroundColor\", \"#333\");\n    setStyle(\".field_btn:hover\", \"color\", \"#CCC\");\n    setStyle(\".tool_btn:active\", \"backgroundColor\", \"#202020\");\n    setStyle(\".tool_btn:active\", \"border\", \"1px solid #888\");\n    setStyle(\".tool_btn:active\", \"color\", \"#CCC\");\n    setStyle(\".tool_btn2:active\", \"backgroundColor\", \"#333\");\n    setStyle(\".tool_btn2:active\", \"border\", \"1px solid #888\");\n    setStyle(\".tool_btn2:active\", \"color\", \"#CCC\");\n    setStyle(\".field_btn:active\", \"backgroundColor\", \"#333\");\n    setStyle(\".field_btn:active\", \"color\", \"#CCC\");\n    setStyle(\"#mrtitle\", \"backgroundColor\", \"#202020\");\n    setStyle(\"#mrbox\", \"backgroundColor\", \"#101010\");\n    setStyle(\".field_input\", \"backgroundColor\", \"#000\");\n    setStyle(\".field_input\", \"color\", \"#CCC\");\n    setStyle(\".btn\", \"backgroundColor\", \"#202020\");\n    setStyle(\".btn\", \"color\", \"#CCC\");\n    setStyle(\".btn:hover\", \"backgroundColor\", \"#333\");\n    setStyle(\".btn:hover\", \"color\", \"#CCC\");\n    setStyle(\".btn:active\", \"backgroundColor\", \"#333\");\n    setStyle(\".btn:active\", \"color\", \"#CCC\");\n    setStyle(\"closebox\", \"backgroundColor\", \"#101010\");\n    setStyle(\"closebox\", \"color\", \"#CCC\");\n    setStyle(\".list_group\", \"backgroundColor\", \"#202020\");\n    setStyle(\".list_group\", \"borderBottom\", \"\");\n    setStyle(\".list_group:hover\", \"backgroundColor\", \"#333\");\n    setStyle(\".list_group:active\", \"backgroundColor\", \"#333\");\n    setStyle(\".image_list_collapsable\", \"backgroundColor\", \"#101010\");\n    setStyle(\".img_option_selected\", \"backgroundColor\", \"#444\");\n    setStyle(\".rightui\", \"borderLeft\", \"\");\n    setStyle(\".leftui\", \"borderRight\", \"\");\n    setStyle(\"::-webkit-scrollbar-thumb\", \"backgroundColor\", \"#888\");\n    setStyle(\"#rparams, #gui_objbox, #tools_box, #parambox\", \"scrollbarColor\", \"\");\n    setStyle(\"#rparams, #gui_objbox, #tools_box, #parambox\", \"scrollbarWidth\", \"\");\n    setStyle(\"#tools_box\", \"overflow-y\", \"hidden\");\n    setStyle(\"#tools_box\", \"overflow-y\", \"auto\");\n}\n\nfunction getObjectBox(obj) {\n    let x = 0;\n    let y = 0;\n    let w = obj.pm.w;\n    let h = obj.pm.h;\n\n    if (!\"box door region pushf bg water\".includes(obj._class)) {\n        x = bo_x[obj._class];\n        y = bo_y[obj._class];\n        w = bo_w[obj._class];\n        h = bo_h[obj._class];\n    }\n\n    if (\"player enemy\".includes(obj._class)) {\n        x = -15;\n        y = -81;\n        w = 30;\n        h = 80;\n    }\n\n    if (obj._class == \"vehicle\") {\n        x = bo_x[\"vehicle_\" + obj.pm.model];\n        y = bo_y[\"vehicle_\" + obj.pm.model];\n        w = bo_w[\"vehicle_\" + obj.pm.model];\n        h = bo_h[\"vehicle_\" + obj.pm.model];\n\n        if (obj.pm.model == \"veh_hh\") {\n            x = lo_x[\"alei_veh_hh\"];\n            y = lo_y[\"alei_veh_hh\"];\n            w = lo_w[\"alei_veh_hh\"];\n            h = lo_h[\"alei_veh_hh\"];\n        }\n    }\n\n    return {\n        x: x,\n        y: y,\n        w: w,\n        h: h\n    }\n}\n\nfunction getSelectionImage() {\n    let selection = getSelection();\n    let arr1 = [];\n    let arr2 = [];\n    let minX = +Infinity;\n    let minY = +Infinity;\n    let maxX = -Infinity;\n    let maxY = -Infinity;\n\n    for (let i = 0; i < selection.length; i++) {\n        let box = getObjectBox(selection[i]);\n        let x = selection[i].pm.x + box.x;\n        let y = selection[i].pm.y + box.y;\n        let w = box.w;\n        let h = box.h;\n\n        if (x < minX) {\n            minX = x;\n        }\n\n        if (x + w > maxX) {\n            maxX = x + w;\n        }\n\n        if (y < minY) {\n            minY = y;\n        }\n\n        if (y + h > maxY) {\n            maxY = y + h;\n        }\n    }\n\n    window.es = [];\n    for (let e of selection) {\n        es.push(e);\n    }\n\n\n\n    THEME = 4;\n    GRID_ALPHA = 0;\n    SHOW_CONNECTIONS = 0;\n    zoom = 1;\n    zoom_validate();\n\n    let sw = dis_to_x - dis_from_x;\n    let sh = dis_to_y - dis_from_y;\n\n    dis_from_x = minX - 10;\n    dis_from_y = minY - 10;\n    dis_to_x = minX + sw - 10;\n    dis_to_y = minY + sh - 10;\n\n    ConsoleTraceMessages = [];\n\n    Render();\n\n    let w = maxX - minX + 20;\n    let h = maxY - minY + 20;\n\n    aleiLog(DEBUG2, \"Before GID\");\n    let data = ctx.getImageData(0, 0, w, h);\n    aleiLog(DEBUG2, \"After GID\");\n\n    let canvas = document.createElement(\"canvas\");\n    let ctx2 = canvas.getContext(\"2d\");\n\n    let canvas2 = document.createElement(\"canvas\");\n    let ctx3 = canvas2.getContext(\"2d\");\n\n    canvas.width = w;\n    canvas.height = h;\n\n    ctx2.beginPath();\n    ctx2.putImageData(data, 0, 0);\n    ctx2.closePath();\n\n    let prevW = w;\n    let prevH = h;\n\n    if (w > 100 || h > 100) {\n        let divide = w / h;\n\n        if (divide >= 1) {\n            w = 100;\n            h = w / divide;\n        } else {\n            h = 100;\n            w = h * divide;\n        }\n    }\n\n    canvas2.width = w;\n    canvas2.height = h;\n\n    ctx3.beginPath();\n    ctx3.scale(w / prevW, h / prevH);\n    ctx3.drawImage(canvas, 0, 0);\n    ctx3.closePath();\n\n    let result = canvas2.toDataURL();\n\n    canvas.remove();\n    canvas = undefined;\n\n    return result;\n}\n\nfunction createClipboardDiv() {\n    let clipboardDiv = document.createElement(\"div\");\n    let mrdimlights = document.getElementById(\"mrdimlights\");\n\n    clipboardDiv.id = \"clipboardDiv\";\n    clipboardDiv.className = \"mrpopup\";\n    clipboardDiv.style = \"width: calc(100% - 280px); height: 100%; margin: 0px; padding: 0px; top: 50%; transform: translate(0px, -50%); display: none;\";\n\n    clipboardDiv.addEventListener(\"contextmenu\", e => {\n        e.preventDefault();\n    });\n\n    mrdimlights.addEventListener(\"click\", e => {\n        clipboardDiv.style.display = \"none\";\n    });\n\n    document.body.append(clipboardDiv);\n}\n\nfunction clipboardItemAction(i) {\n    let items = JSON.parse(localStorage.clipboardItems);\n    let action = confirm(\"Rename (OK) or delete (Cancel) ?\");\n\n    if (action) {\n        let name = prompt(\"Enter name:\", items[i].name);\n\n        if (name) {\n            items[i].name = name;\n\n            localStorage.clipboardItems = JSON.stringify(items);\n\n            updateClipboardDiv();\n        }\n    } else {\n        if (confirm(\"Are you sure you want to delete?\")) {\n            items.splice(i, 1);\n\n            localStorage.clipboardItems = JSON.stringify(items);\n\n            updateClipboardDiv();\n        }\n    }\n}\n\nfunction registerClipboardItemAction() {\n    window.clipboardItemAction = clipboardItemAction;\n    aleiLog(DEBUG, \"Registered Clipboard Item Action\");\n}\n\nfunction updateClipboardDiv() {\n    if (!localStorage.clipboardItems) {\n        localStorage.clipboardItems = \"[]\";\n    }\n\n    let items = JSON.parse(localStorage.clipboardItems);\n    let clipboardDiv = document.getElementById(\"clipboardDiv\");\n    let mrdimlights = document.getElementById(\"mrdimlights\");\n\n    clipboardDiv.style.display = \"block\";\n    mrdimlights.style.display = \"block\";\n\n    let html = `\n\t\t<div id=\"mrtitle\">\n\t\t\t<span>Object clipboard</span>\n\t\t\t<closebox onclick=\"document.getElementById('clipboardDiv').style.display = 'none'; document.getElementById('mrdimlights').style.display = 'none';\">x</closebox>\n\t\t</div>\n\n\t\t<div id=\"mrbox\" class=\"objbox\" style=\"height: calc(100% - 32px); box-sizing: border-box;\">\n\t`;\n\n    let originalES = window.es;\n    let cs = {} // CS: Current Settings, because we will change settings for rendering images\n    cs.theme = THEME;\n    cs.grid_opacity = GRID_ALPHA;\n    cs.showConnections = SHOW_CONNECTIONS;\n    //\n    cs.dtx = dis_to_x;\n    cs.dty = dis_to_y;\n    //\n    cs.dfx = dis_from_x;\n    cs.dfy = dis_from_y;\n    //\n    cs.ctm = ConsoleTraceMessages;\n    cs.zoom = zoom;\n\n    window.es = [];\n    for (let i = 0; i < items.length; i++) {\n        __pasteObjectClipboard(items[i]);\n        html += `\n\t\t\t<div class=\"img_option\" style=\"width: auto;\" oncontextmenu=\"clipboardItemAction(` + i + `)\" onclick=\"pasteFromPermanentClipboard(` + i + `);\">\n\t\t\t\t<img src=\"` + getSelectionImage() + `\" style=\"max-width: 100px; max-height: 100px;\">\n\t\t\t\t<div>` + items[i].name + `</div>\n\t\t\t</div>\n\t\t`;\n    }\n\n    clipboardDiv.innerHTML = html + \"</div>\";\n    window.es = originalES;\n    THEME = cs.theme;\n    GRID_ALPHA = cs.grid_opacity;\n    SHOW_CONNECTIONS = cs.showConnections;\n    dis_to_x = cs.dtx;\n    dis_to_y = cs.dty;\n    dis_from_x = cs.dfx;\n    dis_from_y = cs.dfy;\n    ConsoleTraceMessages = cs.ctm;\n    zoom = cs.zoom;\n    need_redraw = 1;\n    zoom_validate();\n}\n\nfunction __pasteObjectClipboard(item) {\n    sessionStorage.permanent_clipboard = item.data;\n    PasteFromClipBoard(\"permanent_clipboard\");\n}\n\nfunction pasteFromPermanentClipboard(i) {\n    let items = JSON.parse(localStorage.clipboardItems);\n\n    sessionStorage.permanent_clipboard = items[i].data;\n\n    PasteFromClipBoard(\"permanent_clipboard\");\n\n    let clipboardDiv = document.getElementById(\"clipboardDiv\");\n    let mrdimlights = document.getElementById(\"mrdimlights\");\n\n    clipboardDiv.style.display = \"none\";\n    mrdimlights.style.display = \"none\";\n\n    NewNote(\"Objects pasted from permanent clipboard.\", note_passive);\n}\n\nfunction copyToPermanentClipboard() {\n    try {\n        let selection = getSelection();\n\n        if (selection.length != 0) {\n            CopyToClipBoard(\"permanent_clipboard\");\n\n            let items = JSON.parse(localStorage.clipboardItems);\n\n            items.push({\n                name: \"Selection\",\n                data: sessionStorage.permanent_clipboard\n            });\n\n            localStorage.clipboardItems = JSON.stringify(items);\n\n            NewNote(\"Objects copied to permanent clipboard.\", note_passive);\n        } else {\n            updateClipboardDiv();\n        }\n    } catch (err) {\n        console.error(err);\n        NewNote(\"Can't copy objects to permanent clipboard.<br>LocalStorage error?\", note_bad);\n    }\n}\n\nfunction changeTopRightText() {\n    let containerElem = document.getElementById(\"version_rights\");\n    let elem = containerElem.childNodes[0];\n\n    containerElem.style.width = \"170px\";\n    elem.style.width = \"160px\";\n\n    elem.innerHTML = \"Plazma Burst 2 Level Editor v1.4<br>ALE Improvements v\" + GM_info.script.version;\n}\n\nfunction sortObjects() {\n    es.sort((a, b) => a.pm.__zIndex - b.pm.__zIndex);\n}\n\nfunction addDecorButtons() {\n    let rparams = document.getElementById(\"rparams\");\n    let selection = getSelection();\n\n    if (rparams && selection.length == 1) {\n        let getImageSize_button = '<a onclick=\"getImageSize();\" class=\"tool_btn tool_wid\" style=\"display: block; width: 100%; margin-top: 4px;\">Get image size</a>';\n        let centerDecorationX_button = '<a onclick=\"centerImageX();\" class=\"tool_btn tool_wid\" style=\"display: block; width: 100%; margin-top: 4px;\">Center decoration X</a>';\n        let centerDecorationY_button = '<a onclick=\"centerImageY();\" class=\"tool_btn tool_wid\" style=\"display: block; width: 100%; margin-top: 4px;\">Center decoration Y</a>';\n\n        if (selection[0]._class == \"bg\") {\n            rparams.innerHTML += getImageSize_button;\n        }\n\n        if (selection[0]._class == \"decor\") {\n            rparams.innerHTML += getImageSize_button;\n            rparams.innerHTML += centerDecorationX_button;\n            rparams.innerHTML += centerDecorationY_button;\n        }\n    }\n}\n\nfunction getImageSize() {\n    let selection = getSelection();\n    let id;\n\n    if (selection[0]._class == \"bg\") {\n        id = selection[0].pm.m;\n    }\n\n    if (selection[0]._class == \"decor\") {\n        id = selection[0].pm.model;\n    }\n\n    if (typeof id == \"string\") {\n        let img = document.createElement(\"img\");\n\n        img.onload = function() {\n            let w = img.width;\n            let h = img.height;\n\n            img.remove();\n\n            alert(\"W: \" + w + \"\\nH: \" + h);\n        }\n\n        img.onerror = function() {\n            img.remove();\n\n            alert(\"Image not found.\");\n        }\n\n        img.src = \"https://www.plazmaburst2.com/mimage_cache.php?image_id=\" + id.slice(1);\n    } else {\n        alert(\"Image not found.\");\n    }\n}\n\nfunction getImageData() {\n    return new Promise((res, err) => {\n        let selection = getSelection();\n        let id;\n\n        if (selection[0]._class == \"bg\") {\n            id = selection[0].pm.m;\n        }\n\n        if (selection[0]._class == \"decor\") {\n            id = selection[0].pm.model;\n        }\n\n        if (typeof id == \"string\") {\n            let img = document.createElement(\"img\");\n\n            img.onload = function() {\n                let w = img.width;\n                let h = img.height;\n\n                let canvas = document.createElement(\"canvas\");\n                let ctx = canvas.getContext(\"2d\");\n\n                canvas.width = img.width;\n                canvas.height = img.height;\n\n                ctx.beginPath();\n                ctx.drawImage(img, 0, 0);\n                ctx.closePath();\n\n                res([ctx.getImageData(0, 0, w, h).data, w]);\n            }\n\n            img.onerror = function() {\n                img.remove();\n\n                alert(\"Image not found.\");\n\n                res(1);\n            }\n\n            img.src = \"https://www.plazmaburst2.com/mimage_cache.php?image_id=\" + id.slice(1);\n        } else {\n            alert(\"Image not found.\");\n\n            res(1);\n        }\n    });\n}\n\nfunction arrMin(arr) {\n    let min = Infinity;\n\n    for (let i = 0; i < arr.length; i++) {\n        if (arr[i] < min) {\n            min = arr[i];\n        }\n    }\n\n    return min;\n}\n\nfunction arrMax(arr) {\n    let max = -Infinity;\n\n    for (let i = 0; i < arr.length; i++) {\n        if (arr[i] > max) {\n            max = arr[i];\n        }\n    }\n\n    return max;\n}\n\nfunction getImagePosition(data, w) {\n    let arrX = [];\n    let arrY = [];\n\n    let minX;\n    let minY;\n    let maxX;\n    let maxY;\n\n    let centerX = 0;\n    let centerY = 0;\n\n    if (data != 1) {\n        for (let i = 0; i < data.length; i += 4) {\n            if (data[i + 3] >= 3) {\n                let x = (i / 4) % w;\n                let y = Math.floor(i / 4 / w);\n\n                arrX.push(x);\n                arrY.push(y);\n            }\n        }\n\n        minX = arrMin(arrX);\n        minY = arrMin(arrY);\n        maxX = arrMax(arrX);\n        maxY = arrMax(arrY);\n\n        centerX = (minX + maxX) / 2;\n        centerY = (minY + maxY) / 2;\n    }\n\n    return {\n        x: centerX,\n        y: centerY\n    }\n}\n\nfunction setDecorOffset(x, y) {\n    let selection = getSelection();\n\n    selection[0].pm.u = x;\n    selection[0].pm.v = y;\n}\n\nfunction centerImageX() {\n    let selection = getSelection();\n\n    if (selection.length == 1) {\n        if (selection[0]._class == \"decor\") {\n            getImageData().then(res => {\n                if (res != 1) {\n                    let center = getImagePosition(res[0], res[1]);\n                    let x = center.x;\n\n                    setDecorOffset(-x, selection[0].pm.v);\n                }\n            });\n        }\n    }\n\n    need_redraw = 1;\n    need_GUIParams_update = 1;\n}\n\nfunction centerImageY() {\n    let selection = getSelection();\n\n    if (selection.length == 1) {\n        if (selection[0]._class == \"decor\") {\n            getImageData().then(res => {\n                if (res != 1) {\n                    let center = getImagePosition(res[0], res[1]);\n                    let y = center.y;\n\n                    setDecorOffset(selection[0].pm.u, -y);\n                }\n            });\n        }\n    }\n\n    need_redraw = 1;\n    need_GUIParams_update = 1;\n}\n\nfunction imageFunctions() {\n    window.getImageSize = getImageSize;\n    window.centerImageX = centerImageX;\n    window.centerImageY = centerImageY;\n}\n\nlet newUpdate = 0;\n\nlet targetElement;\n\ndocument.addEventListener(\"mousedown\", e => {\n    targetElement = e.target;\n});\n\ndocument.addEventListener(\"keydown\", e => {\n    if (e.ctrlKey && e.code == \"KeyS\") {\n        e.preventDefault();\n        document.getElementsByClassName(\"field_btn\")[0].click();\n    }\n\n    if (e.ctrlKey && e.code == \"KeyF\") {\n        e.preventDefault();\n\n        let name = prompt(\"Find objects:\", \"\");\n\n        if (name !== null && name !== \"\") {\n            let notFound = findObjects(name);\n\n            if (notFound) {\n                alert(\"Nothing found.\");\n            }\n        }\n    }\n\n    if (e.code == \"KeyR\" && targetElement != \"[object HTMLInputElement]\" && targetElement.id != \"opcode_field\") {\n        if (!isOnlyTriggerSelected()) {\n            rotateObjects();\n        }\n    }\n\n    if (e.ctrlKey && e.code == \"KeyR\") {\n        if (isOnlyTriggerSelected() && !isNothingSelected()) {\n            e.preventDefault();\n\n            reverseTriggerActions();\n            unselectTriggerActions();\n        }\n    }\n\n    if ((e.code == \"Minus\" || e.code == \"NumpadSubtract\") && e.ctrlKey && canvas_focus) {\n        e.preventDefault();\n\n        zoom *= 2;\n        zoom_validate();\n        need_redraw = 1;\n    }\n\n    if ((e.code == \"Equal\" || e.code == \"NumpadAdd\") && e.ctrlKey && canvas_focus) {\n        e.preventDefault();\n\n        zoom *= 0.5;\n        zoom_validate();\n        need_redraw = 1;\n    }\n\n    if (e.ctrlKey && e.altKey) {\n        e.preventDefault();\n\n        zoom = 1;\n        zoom_validate();\n        need_redraw = 1;\n    }\n\n    if (e.code == \"KeyH\" && e.ctrlKey) {\n        e.preventDefault();\n\n        if (targetElement.id === \"opcode_field\") {\n            let value = targetElement.value;\n\n            let str1 = prompt(\"Enter string to replace from:\", \"\");\n            if (!str1) return;\n\n            let str2 = prompt(\"Enter string to replace to:\", str1);\n            if (!str2) return;\n\n            targetElement.value = value.replaceAll(str1, str2);\n        }\n    }\n\n    if (e.code == \"Enter\" && targetElement != \"[object HTMLInputElement]\" && targetElement.id != \"opcode_field\" && canvas_focus) {\n        let selected = getSelection();\n\n        if (selected.length != 0) {\n            let param = prompt(\"Enter parameter name:\", \"\");\n\n            if (param) {\n                let expression = prompt(\"Enter expression:\", \"\");\n\n                if (expression) {\n                    param = param.toLowerCase().replace(\"width\", \"w\").replace(\"height\", \"h\");\n\n                    for (let i = 0; i < selected.length; i++) {\n                        let x = selected[i].pm.x;\n                        let y = selected[i].pm.y;\n                        let w = selected[i].pm.w;\n                        let h = selected[i].pm.h;\n\n                        if (x === undefined) {\n                            x = 0;\n                        }\n\n                        if (y === undefined) {\n                            y = 0;\n                        }\n\n                        if (w === undefined) {\n                            w = 0;\n                        }\n\n                        if (h === undefined) {\n                            h = 0;\n                        }\n\n                        if (selected[i].pm[param] !== undefined) {\n                            let parsed = alescriptParse(expression, [x, y, w, h, i]);\n\n                            if (typeof parsed == \"number\") {\n                                for (let j = 0; j < selected.length; j++) {\n                                    selected[j].selected = 0;\n                                }\n\n                                selected[i].selected = 1;\n\n                                UpdatePhysicalParam(param, parsed);\n                            }\n\n                            for (let j = 0; j < selected.length; j++) {\n                                selected[j].selected = 1;\n                            }\n                        }\n                    }\n\n                    need_GUIParams_update = 1;\n                }\n            }\n        }\n    }\n\n    if (e.altKey) {\n        e.preventDefault();\n    }\n\n    if (e.altKey && targetElement == \"[object HTMLInputElement]\") {\n        let selected = getSelection();\n\n        if (selected.length == 1) {\n            let x = selected[0].pm.x;\n            let y = selected[0].pm.y;\n            let w = selected[0].pm.w;\n            let h = selected[0].pm.h;\n\n            if (x === undefined) {\n                x = 0;\n            }\n\n            if (y === undefined) {\n                y = 0;\n            }\n\n            if (w === undefined) {\n                w = 0;\n            }\n\n            if (h === undefined) {\n                h = 0;\n            }\n\n            let parsed = alescriptParse(targetElement.value, [x, y, w, h, i]);\n\n            if (typeof parsed == \"number\") {\n                targetElement.value = parsed;\n            }\n        }\n    }\n\n    if (e.ctrlKey && e.code == \"KeyP\") {\n        e.preventDefault();\n\n        copyToPermanentClipboard();\n    }\n\n    if (e.ctrlKey && e.shiftKey) {\n        if (newUpdate) {\n            let wnd = new Object();\n\n            window.onblur = function() {\n                setTimeout(() => {\n                    wnd.close();\n                }, 1000);\n            }\n\n            window.onfocus = function() {\n                location.reload();\n            }\n\n            wnd = window.open(\"https://github.com/LisABC/ALEI/raw/main/alei.user.js\");\n        }\n    }\n});\n\nfunction doTooltip() {\n    let tooltip = document.createElement(\"p\");\n\n    tooltip.style.fontSize = \"16px\";\n    tooltip.style.fontFamily = \"monospace\";\n    tooltip.style.color = \"#eee\";\n    tooltip.style.backgroundColor = \"#000\";\n    tooltip.style.padding = \"10px\";\n    tooltip.style.width = \"fit-content\";\n    tooltip.style.borderRadius = \"4px\";\n    tooltip.style.wordBreak = \"break-all\";\n    tooltip.style.position = \"absolute\";\n    tooltip.style.left = \"100px\";\n    tooltip.style.top = \"-100px\";\n\n    document.body.append(tooltip);\n\n    document.addEventListener(\"mousemove\", e => {\n        if (e.target.title) {\n            e.target.dataset.title = e.target.title;\n            e.target.title = \"\";\n        }\n\n        if (e.target.parentElement.title) {\n            e.target.parentElement.dataset.title = e.target.parentElement.title;\n            e.target.parentElement.title = \"\";\n        }\n        let leftOffset = 150\n\n        if (e.target.dataset.title) {\n            let to = e.target.dataset.title.length\n            tooltip.style.left = to + leftOffset + e.clientX + 20 + \"px\";\n            tooltip.innerHTML = e.target.dataset.title;\n\n            if (tooltip.getBoundingClientRect().height != 31) {\n                tooltip.style.left = to + leftOffset + e.clientX - 20 - tooltip.getBoundingClientRect().width + \"px\";\n            }\n        } else if (e.target.parentElement.dataset.title) {\n            let to = e.target.parentElement.dataset.title.length\n            tooltip.style.left = to + leftOffset + e.clientX + 20 + \"px\";\n            tooltip.style.top = e.clientY + \"px\";\n            tooltip.innerHTML = e.target.parentElement.dataset.title;\n\n            if (tooltip.getBoundingClientRect().height != 31) {\n                tooltip.style.left = to + leftOffset + e.clientX - 20 - tooltip.getBoundingClientRect().width + \"px\";\n            }\n        } else {\n            tooltip.style.left = -100 + leftOffset + \"px\";\n            tooltip.style.top = \"-100px\";\n        }\n    });\n    aleiLog(DEBUG, \"Added tooltip.\")\n}\n\nfunction patchDecorUpload() {\n    // Allows for multiple uploads.\n    let imageLoader = $id(\"imageLoader\");\n    // First we make it allow multiple files and remove original event listener.\n    imageLoader.setAttribute(\"multiple\", true);\n    imageLoader.removeEventListener(\"change\", handleImage);\n    // Then we register our own.\n    imageLoader.addEventListener(\"change\", function(e) {\n        let files = e.target.files;\n        NewNote(`ALEI: Will upload ${files.length} bg/decor(s).`, \"#2595FF\");\n        for (let file of files) {\n            let arg = {target: {files: [file]}};\n            handleImage(arg); // Call original function\n        }\n    }, false)\n}\n\nfunction setParameter(index, value) {\n    let rightParams = document.getElementById(\"rparams\");\n\n    if (index < rightParams.childNodes.length) {\n        rightParams.childNodes[index].childNodes[1].innerHTML = value;\n    }\n}\n\nfunction getSelection() {\n    let objects = [];\n\n    for (let i = 0; i < es.length; i++) {\n        if (es[i].selected && es[i].exists) {\n            objects.push(es[i]);\n        }\n    }\n\n    return objects;\n}\n\nfunction areObjectsOfSameType(objects) {\n    let same = 1;\n\n    for (let i = 0; i < objects.length; i++) {\n        if (objects[i]._class != objects[0]._class) {\n            same = 0;\n        }\n    }\n\n    return same;\n}\n\nfunction removeSameItems(array) {\n    return Array.from(new Set(array));\n}\n\nfunction removeItems(array, items) {\n    let copy = JSON.parse(JSON.stringify(array));\n\n    for (let i = 0; i < items.length; i++) {\n        copy.splice(copy.indexOf(items[i]), 1);\n    }\n\n    return copy;\n}\n\nfunction parameterNamesToIndexes(parameters, objectParameters) {\n    let indexes = [];\n\n    for (let i = 0; i < parameters.length; i++) {\n        indexes.push(objectParameters.indexOf(parameters[i]));\n    }\n\n    return indexes;\n}\n\nfunction getSameParameters(objects) {\n    let differentParameters = [];\n    let parameters = Object.keys(objects[0].pm);\n\n    for (let i = 0; i < objects.length; i++) {\n        for (let j = 0; j < parameters.length; j++) {\n            if (objects[i].pm[parameters[j]] != objects[0].pm[parameters[j]]) {\n                differentParameters.push(parameters[j]);\n            }\n        }\n    }\n\n    differentParameters = removeSameItems(differentParameters);\n    differentParameters = removeItems(parameters, differentParameters);\n\n    return parameterNamesToIndexes(differentParameters, parameters);\n}\n\nfunction toBoolean(str) {\n    if (isNaN(Number(str))) {\n        return str == \"true\";\n    } else {\n        return Boolean(str);\n    }\n}\n\nfunction fixIndex(index, objectType) {\n    let fixedIndex = index;\n\n    if (objectType == \"trigger\") {\n        if (index > 4) {\n            fixedIndex = index + Math.floor((index - 2) / 3);\n        }\n    }\n\n    return fixedIndex;\n}\n\nconst parameterMap = {\n    \"box\": {\"m\": \"box_model\"},\n    \"door\": {\n        \"moving\": \"bool\",\n        \"vis\": \"bool\"\n    },\n    \"region\": {\"use_on\": \"region_activation\"},\n    \"decor\": {\n        \"f\": \"draw_in_front\",\n        \"model\": \"decor_model\"\n    },\n    \"bg\": {\n        \"s\": \"bool\",\n        \"f\": \"draw_in_front\",\n        \"m\": \"bg_model\"\n    },\n    \"water\": {\"friction\": \"bool\"},\n    \"trigger\": {\"enabled\": \"bool\"},\n    \"timer\": {\"enabled\": \"bool\"},\n    \"gun\": {\n        \"command\": \"team+any\",\n        \"upg\": \"gun_upgrade\",\n        \"model\": \"gun_model\"\n    },\n    \"barrel\": {\"model\": \"barrel_model\"},\n    \"lamp\": {\"flare\": \"bool\"},\n    \"vehicle\": {\"model\": \"vehicle_model\"}\n}\n\nfunction fixParameterValue(name, value, objectType) {\n    let fixedValue;\n\n    if (VAL_TABLE[name]) {\n        fixedValue = VAL_TABLE[name][value];\n    } else {\n        if (parameterMap[objectType] && parameterMap[objectType][name]) {\n            fixedValue = VAL_TABLE[ parameterMap[objectType][name] ][value];\n        }else if (name.slice(0, 8) == \"actions_\" && name.slice(-5) == \"_type\") {\n            fixedValue = VAL_TABLE[\"trigger_type\"][value];\n        }else {\n            fixedValue = value;\n        }\n    }\n\n    return fixedValue;\n}\n\nfunction setSameParameters() {\n    let objects = getSelection();\n\n    if (areObjectsOfSameType(objects) && objects.length >= 2) {\n        let indexes = getSameParameters(objects);\n        let parameters = Object.keys(objects[0].pm);\n\n        for (let i = 0; i < indexes.length; i++) {\n            let name = parameters[indexes[i]];\n            let value = objects[0].pm[parameters[indexes[i]]];\n            let objectType = objects[0]._class;\n\n            setParameter(fixIndex(indexes[i], objectType), fixParameterValue(name, value, objectType));\n        }\n    }\n}\n\nfunction assignObjectIDs() {\n    if (!aleiSettings.showIDs) return;\n    let idmap = {};\n    for (let element of es) {\n        if (!element.exists) continue;\n        if (idmap[element._class] === undefined) idmap[element._class] = -1;\n\n        idmap[element._class] += 1;\n        element.aleiID = idmap[element._class];\n    }\n}\n\nfunction assignZIndex() {\n    for (let i = 0; i < es.length; i++) {\n        if (es[i].pm.__zIndex === undefined) {\n            es[i].pm.__zIndex = 1;\n        }\n    }\n}\n\nfunction patchANI() {\n    let oldAni = ani;\n    window.ani = function() {\n        let ngpu = need_GUIParams_update;\n        oldAni();\n        if (ngpu) {\n            assignObjectIDs();\n            assignZIndex();\n            if (aleiSettings.showSameParameters) {\n                setSameParameters();;\n            }\n        }\n    }\n    aleiLog(DEBUG, \"Patched ANI\");\n}\n\n///////////////////////////////\n\nfunction updateBoxSplitterSize() {\n    let obj = $id(\"gui_objbox\");\n    let rect = obj.getBoundingClientRect();\n    let style = splitter2.style;\n    style.setProperty(\"width\", rect.width);\n    style.setProperty(\"left\", rect.x);\n    style.setProperty(\"top\", rect.bottom);\n}\n\nfunction addObjBoxResize() {\n    let obj = $id(\"gui_objbox\");\n    let splitter = document.createElement(\"div\");\n    window.splitter2 = splitter;\n    let style = splitter.style;\n    $id(\"floattag\").appendChild(splitter);\n\n    style.setProperty(\"position\", \"absolute\");\n    style.setProperty(\"height\", \"5px\");\n    style.setProperty(\"cursor\", \"s-resize\");\n\n    updateBoxSplitterSize();\n\n    let splitterClicking = false;\n    splitter.onmousedown = ((e) => {splitterClicking = true});\n    ROOT_ELEMENT.addEventListener(\"mouseup\", (e) => {splitterClicking = false});\n    ROOT_ELEMENT.addEventListener(\"mousemove\", (e) => {\n        if (!splitterClicking) return;\n\n        let new_height = e.clientY - 90;\n        obj.style.height = new_height;\n        updateBoxSplitterSize();\n        ShowHideObjectBox();\n        ShowHideObjectBox();\n    });\n    aleiLog(DEBUG, \"Added splitter for object box.\");\n}\n\nfunction patch_m_down() {\n    let og_mdown = window.m_down;\n    window.m_down = function(e) {\n        let previousEsLength = es.length;\n        og_mdown(e);\n        if (es.length > previousEsLength) { // New element is made.\n            assignObjectIDs();\n            assignZIndex();\n            sortObjects();\n            let element = es[es.length - 1];\n            if (!(\"x\" in element.pm)) return;\n            // We now have to do job of fixPos, we cannot set fixPos to have it argument-based directly because of scoping\n            // So we have to do it ourselves.\n            let pm = element.pm;\n            let round = function(num) {\n                return Math.round(num / GRID_SNAPPING) * GRID_SNAPPING\n            }\n            pm.x = round(pm.x);\n            pm.y = round(pm.y);\n            if (element._isresizable) {\n                pm.w = round(pm.w);\n                pm.h = round(pm.h);\n            }\n            // Now we just update.\n            window.need_GUIParams_update = true;\n            UpdateGUIObjectsList();\n        }\n    }\n}\n\nfunction patchEntityClass() {\n    let og_E = E;\n    window.E = function(_class) {\n        let result = new og_E(_class);\n        // Adding property.\n        if(_class == \"water\") result.pm.attach = -1;\n        else if(_class == \"decor\") result.pm.text = \"Hello World!\";\n        else if(_class == \"trigger\") {\n            let entries = Object.entries(result.pm);\n            entries.splice(5, 0, [\"execute\", false]);\n            result.pm = Object.fromEntries(entries);\n        }\n        else if(_class == \"region\") result.pm.uses_timer = false;\n\n        result.fixPos = function() {}; // For proper snapping.\n        return result;\n    }\n    aleiLog(DEBUG, \"Patched entity.\");\n}\n\nfunction PasteFromClipBoard(ClipName) {\n    var clipboard = new Object();\n    if (sessionStorage[ClipName] == undefined) {\n        return false;\n    }\n    clipboard = unserialize(sessionStorage[ClipName]);\n    lcz();\n    for (var i = 0; i < es.length; i++)\n        if (es[i].exists) {\n            if (es[i].selected) {\n                ldn('es[' + i + '].selected=false;');\n                lnd('es[' + i + '].selected=true;');\n                es[i].selected = false;\n            }\n        } var min_x = 0;\n    var max_x = 0;\n    var min_y = 0;\n    var max_y = 0;\n    i = 0;\n    var from_obj = es.length;\n    while (typeof(clipboard[i]) !== 'undefined') {\n        var newparam = es.length;\n        ldn('es[' + newparam + '].exists=true;');\n        lnd('es[' + newparam + '].exists=false;');\n        es[newparam] = new E(clipboard[i]._class);\n        for (param in clipboard[i]) {\n            es[newparam][param] = clipboard[i][param];\n        }\n        if (typeof(es[newparam].pm.x) !== 'undefined')\n            if (typeof(es[newparam].pm.y) !== 'undefined') {\n                if (i == 0) {\n                    min_x = es[newparam].pm.x;\n                    min_y = es[newparam].pm.y;\n                    max_x = es[newparam].pm.x;\n                    max_y = es[newparam].pm.y;\n                    if (typeof(es[newparam].pm.w) !== 'undefined')\n                        if (typeof(es[newparam].pm.h) !== 'undefined') {\n                            min_x += es[newparam].pm.w / 2;\n                            max_x += es[newparam].pm.w / 2;\n                            min_y += es[newparam].pm.h / 2;\n                            max_y += es[newparam].pm.h / 2;\n                        }\n                } else {\n                    min_x = Math.min(min_x, es[newparam].pm.x);\n                    min_y = Math.min(min_y, es[newparam].pm.y);\n                    max_x = Math.max(max_x, es[newparam].pm.x);\n                    max_y = Math.max(max_y, es[newparam].pm.y);\n                    if (typeof(es[newparam].pm.w) !== 'undefined')\n                        if (typeof(es[newparam].pm.h) !== 'undefined') {\n                            max_x = Math.max(max_x, es[newparam].pm.x + es[newparam].pm.w);\n                            max_y = Math.max(max_y, es[newparam].pm.y + es[newparam].pm.h);\n                        }\n                }\n            } i++;\n    }\n    ldn('m_drag_selected=true;');\n    ldn('paint_draw_mode=true;');\n    ldn('quick_pick_ignore_one_click=true;');\n    lnd('m_drag_selected=false;');\n    lnd('paint_draw_mode=false;');\n    lnd('quick_pick_ignore_one_click=false;');\n    ldis = true;\n    paint_draw_mode = true;\n    quick_pick_ignore_one_click = true;\n    lmdrwa = lmwa;\n    lmdrwb = lmwb;\n    // Original code by Prosu\n    let m_pos_x = lmwa;\n    let m_pos_y = lmwb;\n\n    m_drag_x = mouse_x;\n    m_drag_y = mouse_y;\n    m_down_x = m_pos_x;\n    m_down_y = m_pos_y;\n    var x1 = Math.round((m_pos_x) / GRID_SNAPPING) * GRID_SNAPPING;\n    var y1 = Math.round((m_pos_y) / GRID_SNAPPING) * GRID_SNAPPING;\n    var lo_x = Math.round((x1 - (min_x + max_x) / 2) / GRID_SNAPPING) * GRID_SNAPPING;\n    var lo_y = Math.round((y1 - (min_y + max_y) / 2) / GRID_SNAPPING) * GRID_SNAPPING;\n\n    for (var i2 = from_obj; i2 < es.length; i2++) {\n        if (typeof(es[i2].pm.uid) !== 'undefined') {\n            var old_uid = es[i2].pm.uid;\n            es[i2].exists = false;\n            es[i2].pm.uid = RandomizeName(es[i2].pm.uid);\n            es[i2].exists = true;\n            for (var i3 = from_obj; i3 < es.length; i3++) {\n                for (param in es[i3].pm) {\n                    if (typeof(es[i3].pm[param]) == 'string') {\n                        if (es[i3].pm[param] == old_uid) {\n                            es[i3].pm[param] = es[i2].pm.uid;\n                        }\n                    }\n                }\n            }\n        }\n        if (typeof(es[i2].pm.x) !== 'undefined')\n            if (typeof(es[i2].pm.y) !== 'undefined') {\n                lnd('es[' + i2 + '].pm.x=' + es[i2].pm.x + ';');\n                lnd('es[' + i2 + '].pm.y=' + es[i2].pm.y + ';');\n                es[i2].pm.x += lo_x;\n                es[i2].pm.y += lo_y;\n                es[i2].fixPos();\n                ldn('es[' + i2 + '].pm.x=' + es[i2].pm.x + ';');\n                ldn('es[' + i2 + '].pm.y=' + es[i2].pm.y + ';');\n            }\n    }\n    // Again by Prosu\n    x1 = Math.round((m_pos_x - m_down_x) / GRID_SNAPPING) * GRID_SNAPPING;\n    y1 = Math.round((m_pos_y - m_down_y) / GRID_SNAPPING) * GRID_SNAPPING;\n    for (var i = 0; i < es.length; i++) {\n        if (es[i]._isphysical && es[i].exists && es[i].selected && (MatchLayer(es[i]) || paint_draw_mode)) {\n            es[i].pm.x += x1;\n            es[i].pm.y += y1;\n        }\n    }\n    m_down_x += x1;\n    m_down_y += y1;\n    lfz(false);\n    return true;\n}\n\nfunction ServerRequest_handleMapData(mapCode) {\n    // Branch of patchServerRequest\n    // Made to deal with map source related things.\n    aleiLog(DEBUG, \"Parsing map source now.\");\n\n    const objectKeyValueRegex = /(\\w+)=((-?\\d+(\\.\\d+)?)|(\"[ -~]*\")|true|false)/;\n    const objectCreationRegex = /q=es\\[\\d+\\]=new E\\(\"(\\w+)\"\\)/;\n\n    let expressions = mapCode.split(\";\\n\");\n\n    let currentElement = null;\n\n    window.es = new Array(); // clear.\n    let index = 2; // We skip var q; and es = new Array();\n    for (;index < expressions.length; index++) {\n        let expression = expressions[index];\n\n        // Skip if it's just only tab or newlines\n        if(expression.replaceAll(\"\\n\", \"\").replaceAll(\"\\t\", \"\").length == 0) {continue};\n\n        // Map ID related stuff.\n        if (expression.indexOf(\"mapid = '\") != -1) {\n            window.mapid = expression.split(\" = \")[1].slice(1, -1);\n            mapid_field.value = mapid;\n            continue;\n        }\n        else if (expression == \"\\t\\tmapid_field.value = mapid\") {continue;}\n        else if (expression.indexOf(\"maprights.innerHTML='\") != -1) {\n            let rights = expression.split(\";\")[0].split(\".innerHTML=\")[1].slice(1, -1);\n            maprights.value = rights;\n            NewNote(`Map '${mapid}' has been successfully loaded.`, note_good);\n            assignZIndex();\n            sortObjects();\n            continue\n        }\n        // Actual mapdata.\n        if(expression.indexOf(\";q=q.pm;\") != -1) { // Creation which is q=es[...]=new E(...);q=q.pm;q.(...)=(...);\n            let creation = objectCreationRegex.exec(expression);\n            currentElement = new E(creation[1]);\n            es[es.length] = currentElement;\n\n            let splt = expression.split(\";\");\n            if (splt.length > 3) {\n                // There is supposed to be only 3 ;'s\n                // initializing;setting;firstProperty\n                // Assuming that server only gives first property and does not send more than 1 in creation line\n                aleiLog(WARN, `Expected 3 items, got ${splt.length} - ${splt}`);\n                continue;\n            }\n            expression = splt[2];\n        };\n        // Key value\n        // In format of q.(___)=(___);\n        let matchKeyValue = objectKeyValueRegex.exec(expression);\n\n        if (matchKeyValue === null) {\n            aleiLog(WARN, `Unable to figure out what kind of code is \"${expression}\", you MIGHT have issues.`);\n            continue;\n        }\n        let key = matchKeyValue[1];\n        let value = matchKeyValue[2].replaceAll(\"\\\\/\", \"/\");\n        if (value[0] != '\"') { // Not a string.\n            if (value == \"true\") value = true;\n            else if(value == \"false\") value = false;\n            else if(value.indexOf(\".\") != -1) value = parseFloat(value);\n            else value = parseInt(value);\n        } else {\n            // Is a string. We just strip quotation marks and fix apostrophes.\n            value = value.slice(1, -1).replaceAll(\"\\\\'\", \"'\");\n        }\n        currentElement.pm[key] = value;\n\n    }\n}\n\nfunction handleServerRequestResponse(request, operation, response) {\n    if (response.indexOf(\"var es = new Array();\") != -1) {\n        ServerRequest_handleMapData(response);\n    }else if (response.indexOf(\"knownmaps = [\") !== -1) {\n        window.knownmaps = [];\n        for (let map of response.match(/\"(.*?)\"/g)) {\n            knownmaps.push(map.slice(1, -1))\n        }\n        aleiLog(DEBUG, `Updated knownmaps with ${knownmaps.length} maps`);\n    }else {\n        aleiLog(DEBUG2, `Evaling for request ${ANSI_YELLOW}\"${request}\"${ANSI_RESET} with operation of ${ANSI_YELLOW}\"${operation}\"${ANSI_RESET}: ${response}`)\n        try {JS_eval(response);}\n        catch(e) {NewNote(\"Eval error!\", note_bad); console.error(e); aleiLog(INFO, `Eval Error from ${request}, for op ${operation} whose response is ${response}`)}\n    };\n}\n\nfunction makeRequest(method, url, data) {\n    return new Promise(function (resolve, reject) {\n        let xhr = new XMLHttpRequest();\n        xhr.open(method, url);\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        xhr.onload = function () {\n            if (this.status >= 200 && this.status < 300) {\n                resolve({status: 200, response: xhr.response});\n            } else {\n                reject({\n                    status: this.status,\n                    statusText: xhr.statusText\n                });\n            }\n        };\n        xhr.onerror = function () {\n            reject({\n                status: this.status,\n                statusText: xhr.statusText\n            });\n        };\n        xhr.send(data);\n    });\n}\n\nfunction updateDecorList() {\n    try {\n        let list_native = $id(\"list_native\");\n        for(let i = 0; i < ALEI_decors.length; i++) {\n            let decor = ALEI_decors[i];\n            let decor_model = decor[0];\n            let decor_name = decor[1];\n            let decor_image = decor[2];\n            list_native.innerHTML += `\n                    <div class=\"img_option\" onClick=\"CustomImageSelected('${decor_model}', '${decor_name}' )\">\n                       <div class=\"imgdiv\" style=\"background:url(${decor_image})\"></div>\n                       <div>\n                         ${decor_name}\n                       </div>\n                    </div>\n                    `\n        }\n        aleiLog(DEBUG, \"Updated decor list.\");\n    }\n    catch(e) {} // We assume we are not in decor list yet.\n}\n\nasync function ALEI_ServerRequest(request, operation, callback = null) {\n    let response = await makeRequest(\"POST\", `e_server.php?a=${request_a}`, request);\n    if (response.status != 200) {\n        if (operation == 'save') NewNote('Oops! Error occoured during saving. Usually it may be happening due to connection problems. Map will be temporary saved to your computer\\'s LocalStorage', note_bad);\n        else if (operation == 'load') NewNote('Oops! Error occoured durning loading. Usually it may be happening due to connection problems.', note_bad)\n        return;\n    }\n    try {\n        handleServerRequestResponse(request, operation, response.response);\n        if (request.indexOf(\"a=get_images\") != -1 && request.indexOf(\"for_class=decor_model\") != -1) {\n            updateDecorList();\n        }\n        window.ImageContext = ImageContext;\n        if (operation == 'save' || operation == 'load') {\n            changes_made = false;\n            if (operation == 'load') {\n                need_redraw = true;\n                need_GUIParams_update = true;\n                ClearUndos();\n            }\n        }\n    } catch (e) {\n        console.error(e);\n        NewNote('Server responds with unclear message. Looks like one of recent actions wasn\\'t successful.', note_bad);\n        debugger;\n    }\n    if (callback != null) {\n        callback();\n    }\n}\n\nlet _serverRequestPatched = false;\nfunction patchServerRequest() {\n    // This code just exists to prevent logging more than once\n    if (_serverRequestPatched) return;\n    _serverRequestPatched = true;\n    // Patches ServerRequest function.\n    // vanilla ServerRequest function literally eval()'s every single thing that server sends.\n    // Which opens up to expected vulnerabilities.\n    // Hopefully in future, ALEI will completely get rid of eval.\n    window.ServerRequest = ALEI_ServerRequest;\n    aleiLog(DEBUG, \"Patched ServerRequest\");\n}\n\nwindow.eval = function(code) { // Temporarily overriding eval so we can patch ServerRequest as early as possible\n    if (window.ServerRequest !== undefined) { // ServerRequest is defined.\n        handleServerRequestResponse(null, null, code);\n        patchServerRequest();\n        // We are pretty much done, we have patched ServerRequest, so just roll with old eval.\n        // Oh and a note for myself incase i confuse myself: vanilla ServerRequest is synchronous\n        window.eval = JS_eval;\n    } else {\n        // Is not defined.\n        // Is this even possible in normal circumstances?\n        console.log(code);\n        debugger;\n    }\n};\n\nfunction patchUpdateGUIParams() {\n    let code = window.UpdateGUIParams.toString().replace(\"if ( i >= 4 && (i-4) % 3 == 0 ) {\", \"if (shouldAddSeparatorInGUIParams(i)) {\");\n    code = \"(\" + code + \")\"; //putting it in parentheses to make it a function expression. the function can then be assigned directly from eval\n    let origUGP = eval(code);\n    let origGPV = window.GenParamVal;\n\n    window.GenParamValEscapeDoubleQuotes = false;\n\n    // replaces GenParamVal behaviour of when base == \"nochange\". only difference is that it escapes double quotes.\n    // also it only escapes double quotes when it's used within UpdateGUIParams.\n    // the original function would return value if FORCE_TEXT_OPTIONS == true even if base == \"nochange\". so this works slightly differently, not sure if that's intentional\n    window.GenParamVal = function(base, value) {\n        if (GenParamValEscapeDoubleQuotes && base == \"nochange\") {\n            let valueWithQuotesEscaped = `${value}`.replaceAll('\"', \"&quot;\");\n            return `<pvalue real=\"${valueWithQuotesEscaped}\">- not used -</pvalue>`;\n        }\n        return origGPV(base, value);\n    }\n\n    window.shouldAddSeparatorInGUIParams = function(i) {\n        let selected = getSelection();\n        let shouldDisplayID = (selected.length == 1) && aleiSettings.showIDs;\n        let startSeparatorFrom = 5;\n        if (shouldDisplayID) {\n            startSeparatorFrom = 6;\n        }\n        return i >= startSeparatorFrom && (i - startSeparatorFrom) % 3 == 0\n    }\n\n    window.UpdateGUIParams = function() {\n        GenParamValEscapeDoubleQuotes = true;\n        let zIndexSave = [];\n        \n        let selected = getSelection();\n        let shouldDisplayID = (selected.length == 1) && aleiSettings.showIDs;\n        let shouldDisplayZIndex = (selected.length >= 1) && aleiSettings.showZIndex;\n        \n        for (let i = 0; i < selected.length; i++) {\n            if (selected[i]._class == \"trigger\") {\n                shouldDisplayZIndex = 0;\n            }\n        }\n        \n        if (shouldDisplayID) {\n            let entries = Object.entries(selected[0].pm);\n            entries.splice(0, 0, [\"__id\",  selected[0].aleiID ]);\n            selected[0].pm = Object.fromEntries(entries);\n        }\n        \n        if (!shouldDisplayZIndex) {\n            for (let i = 0; i < selected.length; i++) {\n                zIndexSave.push(selected[i].pm.__zIndex);\n\n                delete selected[i].pm.__zIndex;\n            }\n        }\n\n        if((selected.length == 1) && (selected[0]._class == \"region\")) {\n            if([true, \"true\"].indexOf(selected[0].pm.uses_timer) != -1) {\n                param_type[REGION_EXECUTE_PARAM_ID][1] = \"timer+none\";\n            } else {\n                param_type[REGION_EXECUTE_PARAM_ID][1] = \"trigger+none\";\n            }\n        }\n\n        origUGP();\n\n        if (shouldDisplayID) delete selected[0].pm.__id;\n\n        if (!shouldDisplayZIndex) {\n            for (let i = 0; i < selected.length; i++) {\n                selected[i].pm.__zIndex = zIndexSave.shift();\n            }\n        }\n\n        addDecorButtons();\n\n        GenParamValEscapeDoubleQuotes = false;\n    }\n    aleiLog(DEBUG, \"Patched UpdateGUIParams\");\n}\n\nfunction patchEvalSet() {\n    window.EvalSet = function(key, value) {\n        // No evaling. Death to eval! (except for when i want to use it...)\n        window[key] = value;\n        UpdateTools();\n    }\n    aleiLog(DEBUG, \"Patched EvalSet\");\n}\n\nwindow.ALEI_settingsMenu = undefined;\n\n\n/*\nTODO: Text field for those.\nlet aleiSettings = {\n    triggerEditTextSize:readStorage(\"ALEI_EditTextSize\",      \"12px\",  (val) => val + \"px\"  ),\n    starsImage:         readStorage(\"ALEI_StarImage\",    \"stars2.jpg\", (val) => val         ),\n}\n*/\n\nfunction createALEISettingsMenu() {\n    let mainWindow = document.createElement(\"div\");\n    mainWindow.setAttribute(\"class\", \"mrpopup\");\n\n    let title = document.createElement(\"div\");\n    title.innerHTML = \"ALEI Setting\";\n    title.setAttribute(\"id\", \"mrtitle\"); // Eric, what is this crap ?\n    mainWindow.appendChild(title);\n\n\n    let box = document.createElement(\"div\");\n    box.setAttribute(\"id\", \"mrbox\");\n    mainWindow.appendChild(box);\n\n    // Style class.\n    let aleiStyles = document.createElement(\"style\");\n    aleiStyles.innerHTML = `\n    .ALEI_settingMenuText {\n        font-size: 14px;\n        width: 150px;\n        height: 20px;\n        background-color: #476082;\n        color: #bfcad9;\n        border-radius: 4px;\n        text-align: center;\n        display: inline-block;\n    }\n    .ALEI_settingsMenuButton {\n        background-color: #26354a;\n        color: #c1c9d3;\n        border-radius: 5px;\n        border: 1px solid #26354a;\n        width: 70px;\n        height: 20px;\n        font-size: 14px;\n        text-align: center;\n        display: inline-block;\n        margin-right: 4px;\n    }\n    .ALEI_settingsMenuButton:hover {\n        background-color: #596a83;\n        color: #f5faff;\n    }\n    .ALEI_settingMenuButtonClicked {\n        background-color: #91a5c1;\n        color: #fbfbfb;\n    }\n    `\n    document.head.appendChild(aleiStyles);\n\n    // Convenience functions.\n    function addText(text, requiresRestart = false) {\n        let div = document.createElement(\"div\");\n        div.innerHTML = text;\n        if (requiresRestart) {\n            div.style.setProperty(\"color\", \"#FFFF00\");\n        }\n        div.setAttribute(\"class\", \"ALEI_settingMenuText\");\n        box.innerHTML += \"<br>\";\n        box.innerHTML += div.outerHTML;\n    }\n    function registerButton(general, values, key) {\n        aleiSettingButtonsMap[general] = [values, key];\n    }\n    function addButton(display, identifier, callback, style = \"\") {\n        aleiButtonClicks[\"setting_\" + identifier] = callback;\n\n        let button = document.createElement(\"input\");\n        button.setAttribute(\"type\", \"button\");\n        button.setAttribute(\"id\", \"ALEI_\" + identifier);\n        button.setAttribute(\"value\", display);\n        button.setAttribute(\"onclick\", `aleiButtonClicks['setting_${identifier}'](); ALEI_settingUpdateButtons(); triggerActionsPreventError();`);\n        button.setAttribute(\"class\", \"ALEI_settingsMenuButton\");\n        button.setAttribute(\"style\", style);\n\n        box.innerHTML += button.outerHTML;\n    }\n    function addBinaryOption(truthyVal, falsyVal, storage, key, internalName, callback = () => {}) {\n        function _apply(val) {\n            writeStorage(storage, val);\n            aleiSettings[key] = val;\n        }\n        addButton(truthyVal, `${internalName}_true`, () => {_apply(true); callback(true)});\n        addButton(falsyVal, `${internalName}_false`, () => {_apply(false); callback(false)});\n    }\n\n    // Log level.\n    function logApply(val) {\n        writeStorage(\"ALEI_LogLevel\", val);\n        aleiSettings.logLevel = val;\n    }\n    box.innerHTML += \"NOTE: Settings in yellow text requires page refresh to be applied.<br>\";\n    addButton(\"Clear Backup\", \"clearMapBackups\", () => {\n        let removed = [];\n        for (let key of Object.keys(localStorage)) {\n            if(!(key.slice(0, \"pb2_map\".length) == \"pb2_map\")) continue;\n            removed.push(key);\n            localStorage.removeItem(key);\n        }\n        NewNote(`ALEI: Cleared backup, removed total ${removed.length} backups.`, \"#00FFFF\");\n        aleiLog(DEBUG2, `Removed backup of: ${removed}`);\n    }, \"width: 100px\");\n    box.innerHTML += \"<br>\";\n\n    registerButton(\"log\", [0, 1, 2], \"logLevel\");\n    addText(\"Log Level:\");\n    addButton(\"INFO\", \"log_0\", () => logApply(0));\n    addButton(\"DEBUG\", \"log_1\", () => logApply(1));\n    addButton(\"DEBUG2\", \"log_2\", () => logApply(2));\n\n    // Action IDs.\n    registerButton(\"actionid\", [true, false], \"showTriggerIDs\");\n    addText(\"Action IDs:\", true)\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowTriggerIDs\", \"showTriggerIDs\", \"actionid\")\n\n    // Tooltips.\n    registerButton(\"tooltip\", [true, false], \"enableTooltips\");\n    addText(\"Tooltips:\")\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowTooltips\", \"enableTooltips\", \"tooltip\")\n\n    // Object ID.\n    registerButton(\"showids\", [true, false], \"showIDs\");\n    addText(\"Object IDs:\")\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowIDs\", \"showIDs\", \"showids\")\n\n    // Z-Index.\n    registerButton(\"showzindex\", [true, false], \"showZIndex\");\n    addText(\"Object z-index:\");\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowZIndex\", \"showZIndex\", \"showzindex\")\n\n    // Show same parameters.\n    registerButton(\"sameparams\", [true, false], \"showSameParameters\");\n    addText(\"Same Parameters:\");\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowSameParameters\", \"showSameParameters\", \"sameparams\");\n\n    // Black theme.\n    registerButton(\"blackTheme\", [true, false], \"blackTheme\");\n    addText(\"Black theme:\", true);\n    addBinaryOption(\"Yes\", \"No\", \"ALEI_BlackTheme\", \"blackTheme\", \"blackTheme\");\n\n    // Change grid based on snapping\n    registerButton(\"changeGridBasedOnSnapping\", [true, false], \"gridBasedOnSnapping\");\n    addText(\"Grid by Snap:\");\n    addBinaryOption(\"Yes\", \"No\", \"ALEI_gridBasedOnSnapping\", \"gridBasedOnSnapping\", \"changeGridBasedOnSnapping\");\n\n    // Render object names\n    registerButton(\"showObjectNames\", [true, false], \"renderObjectNames\");\n    addText(\"Show object names: \");\n    addBinaryOption(\"Yes\", \"No\", \"ALEI_RenderObjectNames\", \"renderObjectNames\", \"showObjectNames\", (status) => ALEI_UpdateNameRenderSetting(status));\n\n    // Remap UID\n    registerButton(\"remapUID\", [true, false], \"rematchUID\");\n    addText(\"Remap UID: \");\n    addBinaryOption(\"Enabled\", \"Disabled\", \"ALEI_RemapUID\", \"rematchUID\", \"remapUID\", (status) => ALEI_UpdateRematchUIDSetting(status));\n\n    // Text affected by zoom\n    registerButton(\"textAffectedByZoomOption\", [true, false], \"textAffectedByZoom\");\n    addText(\"Text affected by zoom:\");\n    addBinaryOption(\"Yes\", \"No\", \"ALEI_TextAffectedByZoom\", \"textAffectedByZoom\", \"textAffectedByZoomOption\");\n    // TODO: Shorten those...\n\n    window.ALEI_settingsMenu = mainWindow;\n    document.body.appendChild(mainWindow);\n    ALEI_settingUpdateButtons();\n    aleiLog(DEBUG, \"Created settings window.\");\n}\n\nlet aleiSettingButtonsMap = {}\n\nwindow.ALEI_settingUpdateButtons = () => {\n    let defaultClass = \"ALEI_settingsMenuButton\";\n    let clickedClass = \"ALEI_settingsMenuButton ALEI_settingMenuButtonClicked\";\n\n    for (let entry of Object.entries(aleiSettingButtonsMap)) {\n        let identity = entry[0];\n        let values = entry[1][0];\n        let key = entry[1][1];\n\n        let currentVal = aleiSettings[key];\n        for (let value of values) {\n            $query(`#ALEI_${identity}_${value}`).setAttribute(\"class\", defaultClass);\n        }\n        $query(`#ALEI_${identity}_${currentVal}`).setAttribute(\"class\", clickedClass);\n    }\n}\n\n\nfunction showSettings() {\n    if (ALEI_settingsMenu === undefined) createALEISettingsMenu();\n\n    mrdimlights.style.display = 'block';\n    ALEI_settingsMenu.style.display = 'block';\n    dim_undo = \"ALEI_settingsMenu.style.display = 'none'\";\n};\n\nfunction patchTeamList() {\n    for (let entry of Object.entries(VAL_TABLE[\"team\"])) {\n        let teamID = parseInt(entry[0]);\n        let teamName = entry[1];\n\n        if (teamID < 0) {\n            teamName = teamName.replace(\"(no friendly fire)\", \"(No collision, Yes friendly fire)\")\n            VAL_TABLE[\"team\"][teamID] = teamName;\n        }\n\n        if (teamID === -1) continue;\n        VAL_TABLE[\"team+any\"][teamID] = teamName;\n    }\n    aleiLog(DEBUG, \"Edited team list..\");\n}\n\nfunction addProjectileModels() {\n    let projectileModels = VAL_TABLE[\"ALEI_projectileModels\"] = {\n        1: \"https://static.miraheze.org/plazmaburstwiki/6/6a/Lazer_1.png\",\n        2: \"https://static.miraheze.org/plazmaburstwiki/a/ae/Lazer_2.png\",\n        3: \"https://static.miraheze.org/plazmaburstwiki/0/06/Lazer_3.png\",\n        4: \"https://static.miraheze.org/plazmaburstwiki/d/de/Lazer_4.png\",\n        5: \"https://static.miraheze.org/plazmaburstwiki/8/8f/Lazer_5.png\",\n        6: \"https://static.miraheze.org/plazmaburstwiki/a/a0/Lazer_6.png\",\n        7: \"https://static.miraheze.org/plazmaburstwiki/7/71/Lazer_7.png\",\n        8: \"https://static.miraheze.org/plazmaburstwiki/c/c6/Lazer_8.png\",\n        9: \"https://static.miraheze.org/plazmaburstwiki/d/d2/Lazer_9.png\",\n        10: \"https://static.miraheze.org/plazmaburstwiki/5/5b/Lazer_10.png\",\n        11: \"https://static.miraheze.org/plazmaburstwiki/d/d2/Lazer_11.png\",\n        12: \"https://static.miraheze.org/plazmaburstwiki/2/2d/Lazer_12.png\",\n        13: \"https://static.miraheze.org/plazmaburstwiki/b/be/Lazer_13.png\",\n        14: \"https://static.miraheze.org/plazmaburstwiki/1/14/Lazer_14.png\",\n        15: \"\", // Empty projectile.\n        16: \"https://static.miraheze.org/plazmaburstwiki/7/7f/Lazer_16.png\",\n        17: \"https://static.miraheze.org/plazmaburstwiki/3/31/Lazer_17.png\",\n        18: \"https://static.miraheze.org/plazmaburstwiki/8/89/Lazer_18.png\",\n        19: \"https://static.miraheze.org/plazmaburstwiki/f/fe/Lazer_19.png\",\n        20: \"https://static.miraheze.org/plazmaburstwiki/1/1a/Lazer_20.png\",\n        21: \"https://static.miraheze.org/plazmaburstwiki/4/42/Lazer_21.png\",\n        22: \"https://static.miraheze.org/plazmaburstwiki/c/c0/Lazer_22.png\",\n        23: \"https://static.miraheze.org/plazmaburstwiki/d/d9/Lazer_23.png\",\n        24: \"https://static.miraheze.org/plazmaburstwiki/f/f5/Lazer_24.png\",\n        25: \"https://static.miraheze.org/plazmaburstwiki/7/7c/Lazer_25.png\",\n        26: \"https://static.miraheze.org/plazmaburstwiki/a/a7/Lazer_26.png\",\n        27: \"https://static.miraheze.org/plazmaburstwiki/3/30/Lazer_27.png\",\n        28: \"https://static.miraheze.org/plazmaburstwiki/3/3a/Lazer_28.png\",\n        29: \"https://static.miraheze.org/plazmaburstwiki/9/90/Lazer_29.png\",\n        30: \"https://static.miraheze.org/plazmaburstwiki/2/23/Lazer_30.png\",\n        31: \"https://static.miraheze.org/plazmaburstwiki/3/3a/Lazer_31.png\",\n        32: \"https://static.miraheze.org/plazmaburstwiki/f/f0/Lazer_32.png\",\n        33: \"https://static.miraheze.org/plazmaburstwiki/0/0d/Lazer_33.png\",\n        34: \"https://static.miraheze.org/plazmaburstwiki/c/c8/Lazer_34.png\",\n        35: \"https://static.miraheze.org/plazmaburstwiki/3/38/Lazer_35.png\",\n        36: \"https://static.miraheze.org/plazmaburstwiki/6/6d/Lazer_36.png\",\n        37: \"https://static.miraheze.org/plazmaburstwiki/a/a9/Lazer_37.png\",\n        38: \"https://static.miraheze.org/plazmaburstwiki/e/e7/Lazer_38.png\",\n        39: \"https://static.miraheze.org/plazmaburstwiki/6/6c/Lazer_39.png\",\n        40: \"https://static.miraheze.org/plazmaburstwiki/d/d4/Lazer_40.png\",\n        41: \"https://static.miraheze.org/plazmaburstwiki/5/5d/Lazer_41.png\",\n        42: \"https://static.miraheze.org/plazmaburstwiki/9/9d/Lazer_42.png\",\n        43: \"https://static.miraheze.org/plazmaburstwiki/7/79/Lazer_43.png\",\n        44: \"https://static.miraheze.org/plazmaburstwiki/6/6d/Lazer_44.png\",\n        45: \"https://static.miraheze.org/plazmaburstwiki/4/44/Lazer_45.png\",\n        46: \"https://static.miraheze.org/plazmaburstwiki/3/3b/Lazer_46.png\",\n        47: \"https://static.miraheze.org/plazmaburstwiki/8/84/Lazer_47.png\",\n        48: \"https://static.miraheze.org/plazmaburstwiki/7/75/Lazer_48.png\",\n        49: \"https://static.miraheze.org/plazmaburstwiki/0/08/Lazer_49.png\",\n        50: \"https://static.miraheze.org/plazmaburstwiki/4/41/Lazer_50.png\",\n        51: \"https://static.miraheze.org/plazmaburstwiki/9/92/Lazer_51.png\",\n        52: \"https://static.miraheze.org/plazmaburstwiki/9/92/Lazer_52.png\",\n        53: \"https://static.miraheze.org/plazmaburstwiki/7/70/Lazer_53.png\",\n        54: \"https://static.miraheze.org/plazmaburstwiki/e/ee/Lazer_54.png\",\n        55: \"https://static.miraheze.org/plazmaburstwiki/d/d1/Lazer_55.png\"\n    };\n    for (let i = 1; i < 56; i++) {\n        projectileModels[i] = `<img src=\\'${projectileModels[i]}\\' style=\\'width: 60px; height: 20px\\'/>`;\n    }\n    aleiLog(DEBUG, \"Loaded projectile models.\");\n}\n\nfunction patchSpecialValue() {\n    let _OG = window.special_value;\n    window.special_value = (base, value) => {\n        if ([\"ALEI_projectileModels\"].indexOf(base) !== -1) {\n            let returning = VAL_TABLE[base][value];\n            if (returning === undefined) return ERROR_VALUE;\n            else return returning;\n        } else if(base == \"trigger+none\") { // I actually do not have to do this, but i will do it to get rid of annoyance\n            if(value == -1) return VAL_TABLE[\"trigger+none\"][-1];\n            return special_value(\"trigger\", value);\n        }else if(base == \"timer+none\") {\n            if(value == -1) return VAL_TABLE[\"timer+none\"][-1];\n            return special_value(\"timer\", value);\n        }else return _OG(base, value);\n    }\n    aleiLog(DEBUG, \"Patched SpecialValue\");\n}\n\nfunction notifyUpdate(version) {\n    newUpdate = 1;\n\n    aleiLog(INFO, `New update: ${version}`);\n    NewNote(`ALEI: There is new update: ${version}, you are currently in ${GM_info.script.version}<br>Press Ctrl + Shift to update`, \"#FFFFFF\");\n}\n\nfunction notifyIfTheresUpdate(script) {\n    let lines = script.split(\"\\n\");\n    let version;\n    for(let i = 0; i < lines.length; i++) {\n        let line = lines[i];\n        if(line.indexOf(\"@version\") == -1) continue;\n\n        let parts = line.split(\" \");\n        version = parts[parts.length - 1];\n        break;\n    }\n\n    let verParts = version.split(\".\");\n    let currentVerParts = GM_info.script.version.split(\".\");\n\n    // x.y.z > x.y(.0)\n    if(verParts.length > currentVerParts.length) return notifyUpdate(version);\n\n    let smallestLength = Math.min(verParts.length , currentVerParts.length)\n    for (let i = 0; i < smallestLength; i++) {\n        let verPart = parseInt(verParts[i]);\n        let currentVerPart = parseInt(currentVerParts[i]);\n\n        if(verPart > currentVerPart) return notifyUpdate(version);\n    }\n    aleiLog(INFO, \"No update detected.\");\n}\n\nasync function checkForUpdates() {\n    let resp = await GM.xmlHttpRequest({  url: GM_info.script.updateURL  }).catch(e => console.error(e));\n    notifyIfTheresUpdate(resp.responseText);\n}\n\nfunction ALEI_DoWorldScale() {\n    var newscale = prompt('Multiply selection size by % (percents)', 100);\n    if (newscale == null || newscale == 100) {} else {\n        var factor = Math.floor(newscale) / 100;\n        {\n            let snappingScript = `/GRID_SNAPPING)*GRID_SNAPPING;`\n            var roundwell = true;\n            lcz();\n            for (i = 0; i < es.length; i++)\n                if (es[i].exists)\n                    if (es[i].selected)\n                        if (MatchLayer(es[i])) {\n                            if (es[i].pm.w != undefined) {\n                                ldn('es[' + i + '].pm.w=Math.round(es[' + i + '].pm.w*' + factor + snappingScript);\n                                lnd('es[' + i + '].pm.w=' + es[i].pm.w + ';');\n                                if (es[i].pm.w * factor != Math.round(es[i].pm.w * factor / GRID_SNAPPING) * GRID_SNAPPING)\n                                    roundwell = false;\n                            }\n                            if (es[i].pm.h != undefined) {\n                                ldn('es[' + i + '].pm.h=Math.round(es[' + i + '].pm.h*' + factor + snappingScript);\n                                lnd('es[' + i + '].pm.h=' + es[i].pm.h + ';');\n                                if (es[i].pm.h * factor != Math.round(es[i].pm.h * factor / GRID_SNAPPING) * GRID_SNAPPING)\n                                    roundwell = false;\n                            }\n                            if (es[i].pm.x != undefined) {\n                                ldn('es[' + i + '].pm.x=Math.round(es[' + i + '].pm.x*' + factor + snappingScript);\n                                lnd('es[' + i + '].pm.x=' + es[i].pm.x + ';');\n                                if (es[i].pm.x * factor != Math.round(es[i].pm.x * factor / GRID_SNAPPING) * GRID_SNAPPING)\n                                    roundwell = false;\n                            }\n                            if (es[i].pm.y != undefined) {\n                                ldn('es[' + i + '].pm.y=Math.round(es[' + i + '].pm.y*' + factor + snappingScript);\n                                lnd('es[' + i + '].pm.y=' + es[i].pm.y + ';');\n                                if (es[i].pm.y * factor != Math.round(es[i].pm.y * factor / GRID_SNAPPING) * GRID_SNAPPING)\n                                    roundwell = false;\n                            }\n                        }\n            lfz(true);\n            NewNote('Operation complete:<br><br>Selected objects scaled by ' + factor + ' (' + newscale + '% of original size)', note_passive);\n            if (!roundwell)\n                NewNote('Note: Position and/or dimensions of some objects were not scaled properly due to Level Editor rounding rules', note_neutral);\n            need_GUIParams_update = true;\n            need_redraw = true;\n            UpdateTools();\n        }\n    }\n}\nfunction patchPercentageTool() {\n    window.DoWorldScale = ALEI_DoWorldScale;\n    aleiLog(DEBUG, \"Patched percentage tool\");\n}\n\nfunction _encodeXMLChars(value) {\n    return value.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\").replaceAll('\"', \"&quot;\")\n}\n\nfunction patchCompileTrigger() {\n    let _og = window.CompileTrigger;\n    window.CompileTrigger = () => {\n        let result = _og();\n        let selected = getSelection();\n        for (let i = 0; i < selected.length; i++) {\n            let obj = selected[i];\n            let keys = Object.keys(obj.pm);\n\n            for (let j = 0; j < keys.length; j++) {\n                if (typeof obj.pm[keys[j]] == \"string\") {\n                    obj.pm[keys[j]] = _encodeXMLChars(obj.pm[keys[j]]);\n                }\n            }\n        }\n        return result;\n    }\n    aleiLog(DEBUG, \"Patched CompileTrigger\");\n}\n\nfunction addPasteFromPermanentClipboard() {\n    window.pasteFromPermanentClipboard = pasteFromPermanentClipboard;\n}\n\nlet selectedTriggerActions = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\nlet hoveredTriggerAction = -1;\nlet triggerActionsClipboard = [];\n\nfunction getTriggerActionElements() {\n    let arr = [];\n    let elems = document.getElementsByClassName(\"p_i\");\n    let i = 6;\n\n    if (aleiSettings.showIDs) {\n        i++;\n    }\n\n    for (; i < elems.length; i++) {\n        arr.push(elems[i].childNodes[0]);\n    }\n\n    return arr;\n}\n\nfunction addEventListeners() {\n    let elems = getTriggerActionElements();\n\n    for (let i = 0; i < elems.length; i++) {\n        let elem = elems[i];\n\n        elem.onmousedown = function() {\n            selectedTriggerActions[Math.floor(i / 3)] ^= 1;\n            updateTriggerActionElements();\n        }\n\n        elem.onmouseenter = function() {\n            hoveredTriggerAction = Math.floor(i / 3);\n            updateTriggerActionElements();\n        }\n\n        elem.onmouseleave = function() {\n            hoveredTriggerAction = -1;\n            updateTriggerActionElements();\n        }\n    }\n}\n\nfunction updateTriggerActionElements() {\n    let elems = getTriggerActionElements();\n\n    // TODO: Make those colors not hardcoded, prolly never will do.\n    for (let i = 0; i < 10; i++) {\n        // Not selected\n        let color = \"\";\n\n        // Selected.\n        if (selectedTriggerActions[i]) {\n            color = \"rgb(45, 65, 95)\";\n            if (THEME != 0) color = \"rgb(27, 27, 27)\"; // rgb(37, 37, 37)\n        }\n\n        elems[i * 3 + 0].style.backgroundColor = color;\n        elems[i * 3 + 1].style.backgroundColor = color;\n        elems[i * 3 + 2].style.backgroundColor = color;\n    }\n\n    // Hover.\n    if (hoveredTriggerAction != -1) {\n        if (!selectedTriggerActions[hoveredTriggerAction]) {\n            let color = \"rgb(65, 85, 130)\";\n\n            if (THEME != 0) color = \"rgb(47, 47, 47)\"\n\n            elems[hoveredTriggerAction * 3 + 0].style.backgroundColor = color;\n            elems[hoveredTriggerAction * 3 + 1].style.backgroundColor = color;\n            elems[hoveredTriggerAction * 3 + 2].style.backgroundColor = color;\n        }\n    }\n}\n\nfunction isOnlyTriggerSelected() {\n    let result = 0;\n    let selection = getSelection();\n\n    if (selection.length == 1 && selection[0]._class == \"trigger\") {\n        result = 1;\n    }\n\n    return result;\n}\n\nfunction getTriggerActions() {\n    edit_triggers_as_text = 1;\n\n    UpdateGUIParams();\n\n    let textarea = document.getElementById(\"opcode_field\");\n    let arr = textarea.value.split(\"\\n\").slice(4);\n\n    while (arr.length < 10) {\n        arr.push(\"\");\n    }\n\n    edit_triggers_as_text = 0;\n    UpdateGUIParams();\n\n    return arr;\n}\n\nfunction copyTriggerActions() {\n    let actions = getTriggerActions();\n\n    triggerActionsClipboard = [];\n\n    for (let i = 0; i < 10; i++) {\n        if (selectedTriggerActions[i]) {\n            triggerActionsClipboard.push(actions[i]);\n        }\n    }\n}\n\nfunction isNothingSelected() {\n    return !selectedTriggerActions.includes(1);\n}\n\nfunction isOnlyOneTriggerActionSelected() {\n    return selectedTriggerActions.indexOf(1) == selectedTriggerActions.lastIndexOf(1) && !isNothingSelected();\n}\n\nfunction getSelectedTriggerAction() {\n    return selectedTriggerActions.indexOf(1);\n}\n\nfunction getTriggerInfo() {\n    edit_triggers_as_text = 1;\n    UpdateGUIParams();\n\n    let textarea = document.getElementById(\"opcode_field\");\n    let arr = textarea.value.split(\"\\n\").slice(0, 3);\n\n    return arr;\n}\n\nfunction pasteTriggerActions() {\n    // TODO: Make this bit more specific\n    // As in, if i copy 2 actions, and i select another 2 actions, it should paste to those 2 actions i selected\n    // And not add to end of it.\n    let actions = getTriggerActions();\n    let index = getSelectedTriggerAction();\n    let clipboard = triggerActionsClipboard.join(\"\\n\");\n    let info = getTriggerInfo();\n\n    edit_triggers_as_text = 1;\n    UpdateGUIParams();\n\n    if (isNothingSelected()) { // Adds action at end of no action was selected.\n        index = actions.length - 1;\n        actions[index] = actions[index] + \"\\n\" + clipboard;\n    }\n\n    if (isOnlyOneTriggerActionSelected()) { // Adds action before the action that was selected.\n        actions[index] = clipboard + \"\\n\" + actions[index];\n    }\n\n    let textarea = document.getElementById(\"opcode_field\");\n\n    textarea.value = info.concat(actions).join(\"\\n\");\n\n    CompileTrigger();\n\n    edit_triggers_as_text = 0;\n    UpdateGUIParams();\n}\n\nfunction deleteTriggerActions() {\n    let actions = getTriggerActions();\n    let info = getTriggerInfo();\n\n    edit_triggers_as_text = 1;\n    UpdateGUIParams();\n\n    for (let i = 0; i < 10; i++) {\n        if (selectedTriggerActions[i]) {\n            actions[i] = \"\";\n        }\n    }\n\n    let textarea = document.getElementById(\"opcode_field\");\n\n    textarea.value = info.concat(actions).join(\"\\n\");\n\n    CompileTrigger();\n\n    edit_triggers_as_text = 0;\n    UpdateGUIParams();\n}\n\nfunction reverseTriggerActions() {\n    let actions1 = getTriggerActions();\n    let actions2 = [];\n    let indexes = [];\n    let info = getTriggerInfo();\n\n    edit_triggers_as_text = 1;\n    UpdateGUIParams();\n\n    for (let i = 0; i < 10; i++) {\n        if (selectedTriggerActions[i]) {\n            actions2.push(actions1[i]);\n            indexes.push(i);\n        }\n    }\n\n    indexes.reverse();\n\n    for (let i = 0; i < actions2.length; i++) {\n        let index = indexes[i];\n        let action = actions2[i];\n\n        actions1[index] = action;\n    }\n\n    let textarea = document.getElementById(\"opcode_field\");\n\n    textarea.value = info.concat(actions1).join(\"\\n\");\n\n    displayOperationCompleteNotes = false;\n    CompileTrigger();\n    displayOperationCompleteNotes = true;\n    NewNote(\"Reversed actions.\", \"#FFFFFF\");\n\n    edit_triggers_as_text = 0;\n    UpdateGUIParams();\n}\n\nfunction unselectTriggerActions() {\n    selectedTriggerActions = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n    hoveredTriggerAction = -1;\n    updateTriggerActionElements();\n}\n\nfunction triggerActionsPreventError() {\n    selectedTriggerActions = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n    hoveredTriggerAction = -1;\n    UpdateGUIParams();\n}\n\nfunction patchClipboardFunctions() {\n    let old_CopyToClipBoard = CopyToClipBoard;\n    let old_PasteFromClipBoard = PasteFromClipBoard;\n    let old_DeleteSelection = DeleteSelection;\n    let old_UpdateGUIParams = UpdateGUIParams;\n    let old_DO_UNDO = DO_UNDO;\n    let old_DO_REDO = DO_REDO;\n\n    window.CopyToClipBoard = function(param) {\n        if (isNothingSelected()) {\n            let result = old_CopyToClipBoard(param);\n            triggerActionsClipboard = [];\n            return result;\n        } else {\n            copyTriggerActions();\n            unselectTriggerActions();\n            return true;\n        }\n    }\n\n    window.PasteFromClipBoard = function(param) {\n        if (triggerActionsClipboard.length == 0) {\n            let result = old_PasteFromClipBoard(param);\n            UpdateGUIParams();\n            return result;\n        } else {\n            displayOperationCompleteNotes = false;\n            pasteTriggerActions();\n            unselectTriggerActions();\n            displayOperationCompleteNotes = true;\n            return true;\n        }\n    }\n\n    window.DeleteSelection = function() {\n        if (isNothingSelected()) {\n            old_DeleteSelection();\n        } else {\n            displayOperationCompleteNotes = false;\n            deleteTriggerActions();\n            unselectTriggerActions();\n            NewNote(\"Deleted trigger actions.\", \"#FFFFFF\");\n            displayOperationCompleteNotes = true;\n        }\n    }\n\n    window.UpdateGUIParams = function() {\n        old_UpdateGUIParams();\n\n        if (!isOnlyTriggerSelected()) {\n            selectedTriggerActions = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            hoveredTriggerAction = -1;\n        } else if (!edit_triggers_as_text) {\n            addEventListeners();\n            updateTriggerActionElements();\n        }\n    }\n\n    window.DO_UNDO = function() {\n        try {\n            old_DO_UNDO();\n        } catch (err) {\n            NewNote(\"Can't undo action.\", note_bad);\n        }\n    }\n\n    window.DO_REDO = function() {\n        try {\n            old_DO_REDO();\n        } catch (err) {\n            NewNote(\"Can't redo action.\", note_bad);\n        }\n    }\n\n    window.triggerActionsPreventError = triggerActionsPreventError;\n    aleiLog(DEBUG, \"Patched clipboard related functions.\");\n}\n\nfunction patchDrawGrid() {\n    let old_lg = lg;\n\n    window.lg = function(param1, param2) {\n        if(aleiSettings.gridBasedOnSnapping) {\n            old_lg(param1 * (GRID_SNAPPING / 10), Math.min(param2 * Math.max(GRID_SNAPPING / 10, 1), 1));\n        } else {\n            old_lg(param1, param2)\n        }\n    }\n    aleiLog(DEBUG, \"Patched LG\");\n}\n\nfunction patchNewNote() {\n    let old = NewNote;\n    window.NewNote = (text, color) => {\n        if (displayOperationCompleteNotes) return old(text, color);\n        if (text.slice(0, \"Operation complete:<br><br>\".length) != \"Operation complete:<br><br>\") return old(text, color);\n    }\n}\n\nvar zoomedTextScaleMultiply = 1.4 // TODO: could probs add some way to change this\n\nfunction ALEI_renderObjectNameText(ctx, text, centerx, centery, dim) { //centerx and centery refer to the text center position on the screen\n    if (!aleiSettings.textAffectedByZoom) {\n        ctx.fillText(text, centerx - dim.width/2, centery + 3);\n    }\n    else {\n        let textScale = 1 / zoom //inverse cuz smaller zoom means more zoom for some reason\n        textScale *= zoomedTextScaleMultiply; // text size would get too small without this\n        if (textScale > 1) {\n            textScale = 1;\n        }\n        let target_width_in_world = dim.width\n        let width_on_screen = target_width_in_world * textScale;//w2s_w(dim.width);\n        let x = centerx - width_on_screen/2;\n        let y = centery + 3 * textScale;\n        ctx.translate(x, y); // things scale around the origin so this moves the origin to the text position\n        ctx.scale(textScale, textScale);\n        ctx.fillText(text, 0, 0);\n        ctx.scale(1/textScale, 1/textScale);\n        ctx.translate(-x, -y);\n    }\n}\n\nfunction patchRender() {\n    let oldCodeSnippet = \"ctx.fillText(fillText, x3, y3+8 + (dim.height-10)/2);\";\n    let newCodeSnippet = \"ALEI_renderObjectNameText(ctx, fillText, capx, capy, dim);\"; //capx and capy represent the text center position\n    let code = ALE_Render.toString().replace(oldCodeSnippet, newCodeSnippet);\n    //vanilla code would make an implicit global \"property\". this whole patching thing somehow makes Render run in strict mode and it throws an error if it isn't fixed here\n    code = code.replace(\"for ( property in es[i].pm )\", \"for (var property in es[i].pm)\")\n    code = \"(\" + code + \")\";\n    window.Render = eval(code);\n    aleiLog(DEBUG, \"Patched Render\");\n}\n\nlet ALE_start = (async function() {\n    'use strict';\n\n    VAL_TABLE = special_values_table;\n    ROOT_ELEMENT = document.documentElement;\n    stylesheets = document.styleSheets;\n    ALE_Render = Render;\n    // Handling rest of things\n    addPropertyPanelResize();\n    addObjBoxResize();\n\n    updateStyles();\n    updateSkins();\n    updateSounds();\n    updateVoicePresets();\n    updateParameters();\n    updateOffsets();\n    updateObjects();\n    updateButtons();\n    patch_m_down();\n    addSessionSync();\n    addTriggerIDs();\n    patchShowHideButton();\n    optimize();\n    patchUpdateTools();\n    patchDecorUpload();\n    patchEntityClass();\n    patchNewNote();\n    patchEvalSet();\n    // Allowing for spaces in parameters.\n    window.UpdatePhysicalParam = UpdatePhysicalParam;\n    window.PasteFromClipBoard = PasteFromClipBoard;\n    patchANI();\n    // Tooltip.\n    if(aleiSettings.enableTooltips) {\n        doTooltip();\n    }\n    patchServerRequest();\n    patchUpdateGUIParams();\n    patchTeamList();\n    patchRandomizeName();\n    patchAllowedCharacters();\n    if (aleiSettings.blackTheme) {\n        blackTheme();\n    }\n    addProjectileModels();\n    patchSpecialValue();\n    UpdateTools();\n    patchPercentageTool();\n    patchCompileTrigger();\n    createClipboardDiv();\n    addPasteFromPermanentClipboard();\n    registerClipboardItemAction();\n    patchClipboardFunctions();\n    patchDrawGrid();\n    patchRender();\n    imageFunctions();\n\n    if(isNative) {\n        checkForUpdates();\n        changeTopRightText();\n    }\n\n    aleiLog(DEBUG2, \"Settings: \" + JSON.stringify(aleiSettings));\n    if(aleiSettings.renderObjectName == false) ALEI_UpdateNameRenderSetting(false);\n\n    NewNote(\"ALEI: Welcome!\", \"#7777FF\");\n    aleiLog(INFO, `Welcome!`);\n    if(isNative) {\n        aleiLog(INFO, `TamperMonkey Version: ${GM_info.version} ALEI Version: ${GM_info.script.version}`);\n    } else {\n        let message = \"You are running ALEI not under tampermonkey, this is not native ALEI, please load ALEI by tampermonkey when possible.\";\n        NewNote(`ALEI: ${message}`, \"#FFFF00\");\n        NewNote(`ALEI: Check https://github.com/LisABC/ALEI for more details.`, \"#FFFF00\");\n        aleiLog(INFO, message);\n    }\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", () => ALE_start());\n"],"names":["isNumber","str","number","isNaN","Number","isOperator","includes","isGroup","operatorOrder","order","calc","x","y","z","result","Math","sin","cos","atan2","floor","random","round","parse","vars","num","i","length","splice","concatNumbers","replaceAll","split","arr","j","from","to","replace","String","PI","negativeNumbers","simpleGroups","chr","convertToObjects","groupOrder","createGroupOrders","removeGroupChars","createOperatorOrders","createOrders","orders","push","getOrders","sort","simplifyOrders","replaceOrders","maxOrder","getMaxOrder","loop","saveOrder","newstr","index","exec","toFixed","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","window","unsafeWindow","isNative","GM_info","e","$id","id","document","getElementById","$query","selector","querySelector","Hello_IgnoreThisError_ItIsIntentional","ROOT_ELEMENT","documentElement","stylesheets","styleSheets","VAL_TABLE","displayOperationCompleteNotes","REGION_EXECUTE_PARAM_ID","INFO","DEBUG","DEBUG2","WARN","ANSI_RESET","ANSI_RED","ANSI_GREY","ANSI_YELLOW","ANSI_GREEN","ANSI_CYAN","readStorage","defaultValue","func","localStorage","removeItem","aleiSettings","rightPanelSize","val","triggerEditTextSize","starsImage","logLevel","parseInt","showTriggerIDs","enableTooltips","showSameParameters","rematchUID","showIDs","blackTheme","gridBasedOnSnapping","showZIndex","renderObjectNames","textAffectedByZoom","writeStorage","value","NewNote","note_bad","console","error","levelToNameMap","aleiLog","level","text","warn","log","JS_setTimeout","setTimeout","JS_eval","eval","ALE_Render","aleiSessionID","aleiSessionList","updateParameters","add","type","name","objType","param_type","param","Array","updateSounds","SVTS","voices","Grosk","drohnentroop","drohnenfem","elurra","ferro","serkova","phantom","entry","entries","character","charVoices","charName","voice","updateVoicePresets","VP","updateStyles","i1","styleSheet","i2","rules","rule","selectorText","style","setProperty","_th","THEME","ThemeSet","THEME_BLUE","updateSkins","charlists","li","charID","paddedCharID","toString","padStart","src","_turnLinkIntoSkinSpan","img_chars_full","Image","ids","keys","map","fetchSkinsFrom","max","async","startingID","requestsRunning","skinsAdded","requestSkin","GM","xmlHttpRequest","url","catch","status","requestBatch","promises","Promise","all","fromID","optimize","f","ms","ani","requestAnimationFrame","_browseImages","BrowseImages","ogImageLists","for_class","current_value","callback","ost","ServerRequest","req","op","ALEI_ServerRequest","then","image_list","innerHTML","updateVehicles","_SVTV","vehicles","vehicle","model","image","img_vehicles","updateGuns","guns","gun","gun_model","gun_name","gun_image","img_guns","updateDecors","img_decors","CACHED_DECORS","decors","decor","decor_model","decor_name","decor_image","CUSTOM_IMAGES_APPROVED","ALEI_decors","updateOffsets","toosc","ThinkOfOffsetClass","tc","esi","offsets","pm","veh_hh","w","h","hakase","off","lo_x","lo_y","lo_w","lo_h","updateTriggers","addTrigger","updateObjects","updateButtons","topPanel","childs","children","setAttribute","appendBack","removeChild","outerHTML","createButton","internalName","onClick","button","createElement","aleiButtonClicks","pad","appendChild","bigPad","exportXML","confirm","fileInput","onchange","files","reader","FileReader","onload","insertXML","remove","readAsText","alert","click","xml","prompt","showSettings","mapid_field","mapid","addClipboardSync","clipboard_channel","BroadcastChannel","onmessage","msg","data","kind","recipient","clip_name","clip_data","sessionStorage","min","session_id","postMessage","ALE_CopyToClipBoard","CopyToClipBoard","addSessionSync","session_channel","indexOf","resolve","addEventListener","event","addPropertyPanelResize","splitter_is_down","splitter","root","position","width","top","height","cursor","right_panel","clientWidth","new_width","clientX","right","updateBoxSplitterSize","splitter_resize","addTriggerIDs","SVTTP","patchShowHideButton","og","ShowHideObjectBox","rparams","heightOffset","true","false","ObjectBox_visible","getBoundingClientRect","addSnappingOptions_helper","newHTML","snappingOptions","snappingIndex","snapping","element","toolClass","GRID_SNAPPING","addRematchUIOptions_helper","evaluate","left_panel","XPathResult","ANY_TYPE","iterateNext","addPreviewNamesOptions_helper","prevElement","headerText","buttonHTML","addButton","_class","onToolUpdate","patchUpdateTools","ut","UpdateTools","tryToNumber","objects","DOMParser","parseFromString","querySelectorAll","object","tagName","eo","E","attributes","es","need_redraw","need_GUIParams_update","exportSelection","download","selected","compi_obj","exists","href","escape","ALEI_CustomSnapping","GridSnappingSet","ALEI_UpdateRematchUIDSetting","ALEI_UpdateNameRenderSetting","ENABLE_TEXT","_ignoredKeys","updateUIDReferences","oldName","newName","properties","splt","item","trim","join","UpdatePhysicalParam","paramname","chvalue","lcz","layer_mismatch","list_changes","elems","MatchLayer","uid","lup","lnd","ldn","_encodeXMLChars","uses_timer","note_passive","note_neutral","lfz","sortObjects","imageContextMap","ImageContext","old_name","moderator_menu","awaiting_approval","login","approver","is_fav_menu","last_element","last_login","preventDefault","image_context","curlogin","left","clientY","display","image_context_cancel_pad","findObjects","exact","notFound","rotateObjects","minX","minY","getSelection","distX","distY","save","RandomizeName","oldname","unoriginal","newname","indof","lastIndexOf","copysuffix","substring","patchRandomizeName","patchAllowedCharacters","allowed_string_chars","getRuleBySelector","setStyle","getObjectBox","bo_x","bo_y","bo_w","bo_h","getSelectionImage","selection","maxX","maxY","box","GRID_ALPHA","SHOW_CONNECTIONS","zoom","zoom_validate","sw","dis_to_x","dis_from_x","sh","dis_to_y","dis_from_y","ConsoleTraceMessages","Render","ctx","getImageData","canvas","ctx2","getContext","canvas2","ctx3","beginPath","putImageData","closePath","prevW","prevH","divide","scale","drawImage","toDataURL","createClipboardDiv","clipboardDiv","mrdimlights","className","body","append","clipboardItemAction","items","JSON","clipboardItems","stringify","updateClipboardDiv","registerClipboardItemAction","html","originalES","cs","theme","grid_opacity","showConnections","dtx","dty","dfx","dfy","ctm","__pasteObjectClipboard","permanent_clipboard","PasteFromClipBoard","pasteFromPermanentClipboard","copyToPermanentClipboard","err","changeTopRightText","containerElem","elem","childNodes","script","version","a","b","__zIndex","addDecorButtons","getImageSize_button","centerDecorationX_button","centerDecorationY_button","getImageSize","m","img","onerror","slice","res","arrMin","Infinity","arrMax","getImagePosition","arrX","arrY","centerX","centerY","setDecorOffset","u","v","centerImageX","centerImageY","imageFunctions","aleiContextRenameImage","CloseImageContext","last_for_class","aleiContextDeleteImage","opacity","newUpdate","targetElement","doTooltip","tooltip","fontSize","fontFamily","color","backgroundColor","padding","borderRadius","wordBreak","target","title","dataset","parentElement","leftOffset","patchDecorUpload","imageLoader","removeEventListener","handleImage","file","setParameter","rightParams","areObjectsOfSameType","same","removeSameItems","array","Set","removeItems","copy","parameterNamesToIndexes","parameters","objectParameters","indexes","getSameParameters","differentParameters","toBoolean","Boolean","fixIndex","objectType","fixedIndex","ctrlKey","code","getElementsByClassName","isOnlyTriggerSelected","isNothingSelected","reverseTriggerActions","unselectTriggerActions","canvas_focus","altKey","str1","str2","expression","toLowerCase","parsed","shiftKey","wnd","onblur","close","onfocus","location","reload","open","parameterMap","fixParameterValue","fixedValue","setSameParameters","assignObjectIDs","idmap","aleiID","assignZIndex","patchANI","oldAni","ngpu","rect","splitter2","bottom","addObjBoxResize","splitterClicking","onmousedown","new_height","patch_m_down","og_mdown","m_down","previousEsLength","_isresizable","UpdateGUIObjectsList","patchEntityClass","og_E","attach","fromEntries","fixPos","ClipName","clipboard","unserialize","min_x","max_x","min_y","max_y","from_obj","newparam","ldis","paint_draw_mode","quick_pick_ignore_one_click","lmdrwa","lmwa","lmdrwb","lmwb","m_pos_x","m_pos_y","m_drag_x","mouse_x","m_drag_y","mouse_y","m_down_x","m_down_y","x1","y1","old_uid","i3","_isphysical","ServerRequest_handleMapData","mapCode","objectKeyValueRegex","objectCreationRegex","expressions","currentElement","rights","maprights","note_good","creation","matchKeyValue","parseFloat","handleServerRequestResponse","request","operation","response","knownmaps","match","makeRequest","method","reject","xhr","XMLHttpRequest","setRequestHeader","this","statusText","send","updateDecorList","list_native","request_a","changes_made","ClearUndos","_serverRequestPatched","patchServerRequest","patchUpdateGUIParams","UpdateGUIParams","origUGP","origGPV","GenParamVal","GenParamValEscapeDoubleQuotes","base","shouldAddSeparatorInGUIParams","startSeparatorFrom","zIndexSave","shouldDisplayID","shouldDisplayZIndex","__id","shift","patchEvalSet","EvalSet","createALEISettingsMenu","mainWindow","aleiStyles","addText","requiresRestart","div","registerButton","general","values","aleiSettingButtonsMap","identifier","addBinaryOption","truthyVal","falsyVal","storage","_apply","logApply","head","removed","ALEI_settingsMenu","ALEI_settingUpdateButtons","dim_undo","patchTeamList","teamID","teamName","addProjectileModels","projectileModels","patchSpecialValue","_OG","special_value","returning","ERROR_VALUE","notifyUpdate","notifyIfTheresUpdate","lines","line","parts","verParts","currentVerParts","smallestLength","checkForUpdates","updateURL","responseText","ALEI_DoWorldScale","newscale","factor","snappingScript","roundwell","patchPercentageTool","DoWorldScale","patchCompileTrigger","_og","CompileTrigger","addPasteFromPermanentClipboard","identity","currentVal","selectedTriggerActions","hoveredTriggerAction","triggerActionsClipboard","getTriggerActionElements","addEventListeners","updateTriggerActionElements","onmouseenter","onmouseleave","getTriggerActions","edit_triggers_as_text","copyTriggerActions","actions","isOnlyOneTriggerActionSelected","getSelectedTriggerAction","getTriggerInfo","pasteTriggerActions","info","concat","deleteTriggerActions","actions1","actions2","reverse","action","triggerActionsPreventError","patchClipboardFunctions","old_CopyToClipBoard","old_PasteFromClipBoard","old_DeleteSelection","DeleteSelection","old_UpdateGUIParams","old_DO_UNDO","DO_UNDO","old_DO_REDO","DO_REDO","patchDrawGrid","old_lg","lg","param1","param2","patchNewNote","old","zoomedTextScaleMultiply","ALEI_renderObjectNameText","centerx","centery","dim","textScale","translate","fillText","patchRender","oldCodeSnippet","newCodeSnippet","ALE_start","special_values_table","renderObjectName","message"],"sourceRoot":""}