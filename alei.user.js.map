{"version":3,"file":"alei.user.js","mappings":"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","sources":["webpack://alei/./src/alescript.js","webpack://alei/webpack/bootstrap","webpack://alei/webpack/runtime/define property getters","webpack://alei/webpack/runtime/hasOwnProperty shorthand","webpack://alei/./src/main.js"],"sourcesContent":["function isNumber(str) {\r\n    let number = 0;\r\n\r\n    if ((!isNaN(Number(str)) && str !== \" \") || str == \".\") {\r\n        number = 1;\r\n    }\r\n\r\n    return number;\r\n}\r\n\r\nfunction isOperator(str) {\r\n    return \"+-*/%^SCANRF\".includes(str);\r\n}\r\n\r\nfunction isGroup(str) {\r\n    return \"()\".includes(str);\r\n}\r\n\r\nfunction split(str) {\r\n    return str.replaceAll(\" \", \"\").split(\"\");\r\n}\r\n\r\nfunction concatNumbers(str) {\r\n    let num = \"\";\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (isNumber(str[i])) {\r\n            num += str[i];\r\n        } else if (num.length != 0) {\r\n            str.splice(i - num.length, num.length, num);\r\n            i -= (num.length - 1);\r\n            num = \"\";\r\n        }\r\n    }\r\n\r\n    if (num.length != 0) {\r\n        str.splice(str.length - num.length, num.length, num);\r\n    }\r\n}\r\n\r\nfunction convertToObjects(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        str[i] = {\r\n            chr: str[i]\r\n        }\r\n    }\r\n}\r\n\r\nfunction createGroupOrders(str) {\r\n    let order = 1;\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str[i].chr == \"(\") {\r\n            order++;\r\n        }\r\n\r\n        if (str[i].chr == \")\") {\r\n            order--;\r\n        }\r\n\r\n        str[i].groupOrder = order;\r\n    }\r\n}\r\n\r\nfunction removeGroupChars(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (isGroup(str[i].chr)) {\r\n            str.splice(i, 1);\r\n            i--;\r\n        }\r\n    }\r\n}\r\n\r\nfunction operatorOrder(str) {\r\n    let order = 0;\r\n\r\n    if (\"+-\".includes(str)) {\r\n        order = 1;\r\n    }\r\n\r\n    if (\"*/%\".includes(str)) {\r\n        order = 2;\r\n    }\r\n\r\n    if (\"^SCANRF\".includes(str)) {\r\n        order = 3;\r\n    }\r\n\r\n    return order;\r\n}\r\n\r\nfunction createOperatorOrders(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (isOperator(str[i].chr)) {\r\n            let order = operatorOrder(str[i].chr);\r\n\r\n            str[i].operatorOrder = order;\r\n\r\n            if (str[i + 1].groupOrder == str[i].groupOrder) {\r\n                str[i + 1].operatorOrder = order;\r\n            }\r\n\r\n            if (!str[i - 1].operatorOrder || (str[i - 1].operatorOrder < str[i].operatorOrder && str[i - 1].groupOrder == str[i].groupOrder)) {\r\n                str[i - 1].operatorOrder = order;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction createOrders(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        str[i].order = str[i].groupOrder * 10 + str[i].operatorOrder;\r\n    }\r\n}\r\n\r\nfunction getOrders(str) {\r\n    let orders = [];\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        orders.push(str[i].order);\r\n    }\r\n\r\n    return orders;\r\n}\r\n\r\nfunction simplifyOrders(orders) {\r\n    let arr = [];\r\n    let order = 1;\r\n\r\n    orders.sort((x, y) => {\r\n        return y - x;\r\n    });\r\n\r\n    arr.push({\r\n        from: orders[0],\r\n        to: order\r\n    });\r\n\r\n    for (let i = 1; i < orders.length; i++) {\r\n        if (orders[i] != orders[i - 1]) {\r\n            order++;\r\n        }\r\n\r\n        arr.push({\r\n            from: orders[i],\r\n            to: order\r\n        });\r\n    }\r\n\r\n    return arr;\r\n}\r\n\r\nfunction replaceOrders(str) {\r\n    let orders = getOrders(str);\r\n    let arr = simplifyOrders(orders);\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        for (let j = 0; j < arr.length; j++) {\r\n            if (str[i].order == arr[j].from) {\r\n                str[i].order = arr[j].to;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction calc(x, y, z) {\r\n    let result;\r\n\r\n    x = Number(x);\r\n    z = Number(z);\r\n\r\n    if (y == \"+\") {\r\n        result = x + z;\r\n    }\r\n\r\n    if (y == \"-\") {\r\n        result = x - z;\r\n    }\r\n\r\n    if (y == \"*\") {\r\n        result = x * z;\r\n    }\r\n\r\n    if (y == \"/\") {\r\n        result = x / z;\r\n    }\r\n\r\n    if (y == \"%\") {\r\n        result = x % z;\r\n    }\r\n\r\n    if (y == \"^\") {\r\n        result = x ** z;\r\n    }\r\n\r\n    if (y == \"S\") {\r\n        result = Math.sin(x) * z;\r\n    }\r\n\r\n    if (y == \"C\") {\r\n        result = Math.cos(x) * z;\r\n    }\r\n\r\n    if (y == \"A\") {\r\n        result = Math.atan2(x, z);\r\n    }\r\n\r\n    if (y == \"N\") {\r\n        if (z) {\r\n            result = Math.floor(Math.random() * x);\r\n        } else {\r\n            result = Math.random() * x;\r\n        }\r\n    }\r\n\r\n    if (y == \"R\") {\r\n        result = Math.round(x / z) * z;\r\n    }\r\n\r\n    if (y == \"F\") {\r\n        result = Math.floor(x / z) * z;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction getMaxOrder(str) {\r\n    let order = 0;\r\n\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str[i].order > order) {\r\n            order = str[i].order;\r\n        }\r\n    }\r\n\r\n    return order;\r\n}\r\n\r\nfunction exec(str) {\r\n    let maxOrder = getMaxOrder(str);\r\n\r\n    for (let order = 1; order <= maxOrder; order++) {\r\n        let i = 0;\r\n        let loop = 1;\r\n\r\n        while (loop) {\r\n            loop = 0;\r\n\r\n            let newstr = [];\r\n            let length;\r\n            let saveOrder;\r\n            let index = -1;\r\n\r\n            for (; i < str.length; i++) {\r\n                if (str[i].order == order) {\r\n                    newstr.push(str[i]);\r\n\r\n                    if (index == -1) {\r\n                        index = i;\r\n                    }\r\n                } else if (newstr.length != 0) {\r\n                    loop = 1;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            length = newstr.length;\r\n\r\n            if (length) {\r\n                while (newstr.length != 1) {\r\n                    newstr.splice(0, 3, {\r\n                        chr: calc(newstr[0].chr, newstr[1].chr, newstr[2].chr)\r\n                    });\r\n                }\r\n\r\n                saveOrder = str[index].order;\r\n\r\n                str.splice(index, length, newstr[0]);\r\n                i -= (length - 1);\r\n\r\n                str[index] = {\r\n                    chr: str[index].chr,\r\n                    order: saveOrder + 1\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction replace(str, arr) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        for (let j = 0; j < arr.length; j++) {\r\n            if (str[i] == arr[j].from) {\r\n                str[i] = arr[j].to;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction negativeNumbers(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str[i] == \"-\" && str[i - 1] == \"(\") {\r\n            str.splice(i, 0, \"0\");\r\n        }\r\n    }\r\n}\r\n\r\nfunction simpleGroups(str) {\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str[i - 1] == \"(\" && str[i + 1] == \")\") {\r\n            str.splice(i, 0, \"0\", \"+\");\r\n        }\r\n    }\r\n}\r\n\r\nexport function parse(str, vars) {\r\n    if (str == \"\") {\r\n        str = \"0\";\r\n    }\r\n\r\n    if (str[0] == \"-\") {\r\n        str = \"0\" + str;\r\n    }\r\n\r\n    str = split(str);\r\n    concatNumbers(str);\r\n\r\n    replace(str, [\r\n        {\r\n            from: \"p\",\r\n            to: String(Math.PI)\r\n        },\r\n\r\n        {\r\n            from: \"x\",\r\n            to: String(vars[0])\r\n        },\r\n\r\n        {\r\n            from: \"y\",\r\n            to: String(vars[1])\r\n        },\r\n\r\n        {\r\n            from: \"w\",\r\n            to: String(vars[2])\r\n        },\r\n\r\n        {\r\n            from: \"h\",\r\n            to: String(vars[3])\r\n        },\r\n\r\n        {\r\n            from: \"i\",\r\n            to: String(vars[4])\r\n        }\r\n    ]);\r\n\r\n    try {\r\n        negativeNumbers(str);\r\n        simpleGroups(str);\r\n        convertToObjects(str);\r\n        createGroupOrders(str);\r\n        removeGroupChars(str);\r\n        createOperatorOrders(str);\r\n        createOrders(str);\r\n        replaceOrders(str);\r\n        exec(str);\r\n    } catch {\r\n        return \"error\";\r\n    }\r\n\r\n    return Number(Number(str[0].chr).toFixed(10));\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import { parse as alescriptParse } from \"./alescript.js\"\r\n\r\nlet window = unsafeWindow;\r\nlet isNative;\r\ntry {\r\n    GM_info\r\n    isNative = true\r\n    window[\"nativeALEIRunning\"] = true;\r\n} catch {isNative = false};\r\n\r\nif(!isNative && (window[\"nativeALEIRunning\"] == true)) {\r\n    // An ALEI instance is already running, probably ran under tampermonkey so let that run.\r\n    // eslint-disable-next-line\r\n    Hello_IgnoreThisError_ItIsIntentional // hope this is not defined\r\n}\r\n\r\n// Shorthand things\r\nfunction $id(id) {\r\n    return document.getElementById(id);\r\n}\r\nfunction $query(selector) {\r\n    return document.querySelector(selector);\r\n}\r\n\r\nlet ROOT_ELEMENT = document.documentElement;\r\nlet stylesheets = document.styleSheets;\r\nlet VAL_TABLE = {}; // Will be filled later.\r\nlet displayOperationCompleteNotes = true;\r\nlet REGION_EXECUTE_PARAM_ID; // Will be set later.\r\n\r\nconst INFO = 0;\r\nconst DEBUG = 1;\r\nconst DEBUG2 = 2;\r\nconst WARN = -1;\r\n\r\n// Just for styling.\r\nconst ANSI_RESET = \"\\x1B[0m\"\r\nconst ANSI_RED = \"\\x1B[31m\"\r\nconst ANSI_GREY = \"\\x1B[37m\"\r\nconst ANSI_YELLOW = \"\\x1B[93m\"\r\nconst ANSI_GREEN = \"\\x1B[92m\"\r\nconst ANSI_CYAN = \"\\x1B[96m\"\r\n\r\nfunction readStorage(key, defaultValue, func) {\r\n    let val = localStorage[key];\r\n    if (val === undefined) return defaultValue;\r\n    return func(localStorage[key])\r\n}\r\n\r\nif (localStorage['RIGHT_PANEL_WIDTH'] != undefined) {\r\n    localStorage[\"ALEI_RightPanelWidth\"] = localStorage[\"RIGHT_PANEL_WIDTH\"];\r\n    localStorage.removeItem(\"RIGHT_PANEL_WIDTH\");\r\n}\r\n\r\nlet aleiSettings = {\r\n    rightPanelSize:     readStorage(\"ALEI_RightPanelWidth\",   \"30vw\",  (val) => val            ),\r\n    triggerEditTextSize:readStorage(\"ALEI_EditTextSize\",      \"12px\",  (val) => val + \"px\"     ),\r\n    starsImage:         readStorage(\"ALEI_StarImage\",    \"stars2.jpg\", (val) => val            ),\r\n    logLevel:           readStorage(\"ALEI_LogLevel\",             0,     parseInt               ),\r\n    showTriggerIDs:     readStorage(\"ALEI_ShowTriggerIDs\",       false, (val) => val === \"true\"),\r\n    enableTooltips:     readStorage(\"ALEI_ShowTooltips\",         false, (val) => val === \"true\"),\r\n    showSameParameters: readStorage(\"ALEI_ShowSameParameters\",   true , (val) => val === \"true\"),\r\n    rematchUID:         readStorage(\"ALEI_RemapUID\",             false, (val) => val === \"true\"),\r\n    showIDs:            readStorage(\"ALEI_ShowIDs\",              false, (val) => val === \"true\"),\r\n    blackTheme:         readStorage(\"ALEI_BlackTheme\",           false, (val) => val === \"true\"),\r\n    gridBasedOnSnapping:readStorage(\"ALEI_gridBasedOnSnapping\",  true,  (val) => val === \"true\"),\r\n    showZIndex:         readStorage(\"ALEI_ShowZIndex\",           false, (val) => val === \"true\"),\r\n    renderObjectNames:  readStorage(\"ALEI_RenderObjectNames\",    true,  (val) => val === \"true\"),\r\n    textAffectedByZoom: readStorage(\"ALEI_TextAffectedByZoom\",   false, (val) => val === \"true\")\r\n}\r\nwindow.aleiSettings = aleiSettings;\r\n\r\nfunction writeStorage(key, value) {\r\n    try {\r\n        localStorage[key] = value;\r\n    } catch (e) {\r\n        NewNote(\"ALEI: There was some issue trying to save into storage. You might need to clear your datas.\", note_bad);\r\n        console.error(e);\r\n    }\r\n}\r\n\r\nlet levelToNameMap = {\r\n    0: `${ANSI_CYAN}INFO${ANSI_RESET}`,\r\n    1: `${ANSI_GREEN}DEBUG${ANSI_RESET}`,\r\n    2: `${ANSI_GREEN}DEBUG2${ANSI_RESET}`\r\n}\r\n\r\nfunction aleiLog(level, text) {\r\n    if (level === WARN) {\r\n        console.warn(`[ALEI:WARNING]: ${text}`);\r\n        NewNote(`ALEI: Please check console.`, \"#FFFF00\");\r\n    }else if (level <= aleiSettings.logLevel)\r\n        console.log(`[${ANSI_GREEN}ALEI:${levelToNameMap[level]}]: ${text}`)\r\n}\r\naleiLog(INFO, \"Starting up...\");\r\n\r\n// Original functions, globally saved here if needed\r\n// JS_ prefix for JavaScript ones, ALE_ for ALE ones\r\nlet JS_setTimeout = window.setTimeout;\r\nlet JS_eval = window.eval;\r\nlet ALE_Render;\r\n\r\nlet aleiSessionID = null; // ID of this session\r\nlet aleiSessionList = []; // Set of known session IDs\r\n\r\nfunction updateParameters() {\r\n    // Does things to parameters depending on purpose.\r\n    function add(key, type, name, objType) {\r\n        param_type[param_type.length] = [key, type, name, \"\", objType];\r\n    }\r\n    // Adding parameters that the game accepts but ALE does not have.\r\n    add(\"moving\", \"bool\", \"Is Moving?\", \"door\");\r\n    add(\"tarx\", \"value\", \"Target X\", \"door\");\r\n    add(\"tary\", \"value\", \"Target Y\", \"door\");\r\n    // Adding our own parameter.\r\n    add(\"__id\", \"value\", \"ID\", \"*\");\r\n    add(\"__zIndex\", \"value\", \"Z-Index\", \"*\");\r\n    add(\"execute\", \"bool\", \"Executes directly?\", \"trigger\");\r\n    add(\"uses_timer\", \"bool\", \"Calls timer?\", \"region\");\r\n    add(\"text\", \"string\", \"Placeholder text\", \"decor\");\r\n    add(\"attach\", \"door+none\", \"Attach to\", \"water\");\r\n    // Patching parameters\r\n    param_type[0] = ['uid', 'string', 'Name', 'Object Name', '*'];\r\n\r\n    // Setting global variables for future use\r\n    for(let i = 0; i < param_type.length; i++) {\r\n        let param = param_type[i];\r\n        let key = param[0];\r\n        let selector = param[4];\r\n\r\n        if((key == \"use_target\") && (selector == \"region\")) {\r\n            REGION_EXECUTE_PARAM_ID = i;\r\n        }\r\n    }\r\n    VAL_TABLE[\"timer+none\"] = new Array();\r\n    VAL_TABLE[\"timer+none\"][-1] = \"- No timer -\";\r\n    VAL_TABLE[\"timer+none\"][\"[listof]\"] = \"timer\"; // Somebody save me.\r\n}\r\n\r\nfunction updateSounds() {\r\n    // Adds sounds that exist in game but not in ALE\r\n    let SVTS = VAL_TABLE[\"sound\"];\r\n    SVTS['am_base'] = 'Indoor Ambience';\r\n    SVTS['am_wind'] = 'Outdoor Ambience';\r\n    SVTS['android2_die'] = 'DT-148 - Death';\r\n    SVTS['android2_hurt'] = 'DT-148 - Hurt';\r\n    SVTS['android2_welcome2'] = 'DT-148 - Alerted';\r\n    SVTS['arrin_death1'] = 'Arrin - Death';\r\n    SVTS['arrin_dying'] = 'Arrin - Dying';\r\n    SVTS['arrin_hurt1'] = 'Arrin - Hurt 1';\r\n    SVTS['arrin_hurt2'] = 'Arrin - Hurt 2';\r\n    SVTS['arrin_welcome1'] = 'Arrin - Alerted 1';\r\n    SVTS['arrin_welcome2'] = 'Arrin - Alerted 2';\r\n    SVTS['arrin_welcome3'] = 'Arrin - Alerted 3';\r\n    SVTS['bounce_bullet'] = 'Falkonian PSI Cutter - Shot Bounce';\r\n    SVTS['dart4'] = 'Medic Pistol';\r\n    SVTS['exp_event_stop'] = 'EXP - Stop';\r\n    SVTS['exp_level'] = 'EXP - Level Up';\r\n    SVTS['exp_tick'] = 'EXP - Gain';\r\n    SVTS['gameplay_song'] = 'Katharsys - Erges';\r\n    SVTS['gravitator2'] = 'Floor gravitator noice';\r\n    SVTS['helm_proxy_alert_over_hereB'] = 'Proxy - Over here!';\r\n    SVTS['helm_proxy_alert_take_coverB'] = 'Proxy - Take cover!';\r\n    SVTS['helm_proxy_alert_up_thereA'] = 'Proxy - Up there!';\r\n    SVTS['helm_proxy_death3'] = 'Proxy - Death 1';\r\n    SVTS['helm_proxy_death4'] = 'Proxy - Death 2';\r\n    SVTS['helm_proxy_death5'] = 'Proxy - Death 3';\r\n    SVTS['helm_proxy_death6'] = 'Proxy - Death 4';\r\n    SVTS['helm_proxy_dyingC'] = 'Proxy - Help! 1';\r\n    SVTS['helm_proxy_dyingF'] = 'Proxy - Help! 2';\r\n    SVTS['helm_proxy_enemy_down_fantasticA'] = 'Proxy - Fantastic.';\r\n    SVTS['helm_proxy_enemy_down_got_oneD'] = 'Proxy - Got one.';\r\n    SVTS['helm_proxy_enemy_down_niceA'] = 'Proxy - Nice. 1';\r\n    SVTS['helm_proxy_enemy_down_niceC'] = 'Proxy - Nice. 2';\r\n    SVTS['helm_proxy_hurt11'] = 'Proxy - Hurt 1';\r\n    SVTS['helm_proxy_hurt12'] = 'Proxy - Hurt 2';\r\n    SVTS['helm_proxy_hurt13'] = 'Proxy - Hurt 3';\r\n    SVTS['helm_proxy_hurt14'] = 'Proxy - Hurt 4';\r\n    SVTS['helm_proxy_hurt15'] = 'Proxy - Hurt 5';\r\n    SVTS['helm_proxy_hurt17'] = 'Proxy - Hurt 6';\r\n    SVTS['helm_proxy_hurt4'] = 'Proxy - Hurt 7';\r\n    SVTS['helm_proxy_hurt5'] = 'Proxy - Hurt 8';\r\n    SVTS['helm_proxy_hurt8'] = 'Proxy - Hurt 9';\r\n    SVTS['helm_proxy_hurt9'] = 'Proxy - Hurt 10';\r\n    SVTS['hexagon_death1'] = 'Hexagon - Death 1';\r\n    SVTS['hexagon_death2'] = 'Hexagon - Death 2';\r\n    SVTS['hexagon_pain1'] = 'Hexagon - Hurt 1';\r\n    SVTS['hexagon_pain2'] = 'Hexagon - Hurt 2';\r\n    SVTS['hexagon_pain3'] = 'Hexagon - Hurt 3';\r\n    SVTS['hexagon_pain4'] = 'Hexagon - Hurt 4';\r\n    SVTS['hexagon_welcome1'] = 'Hexagon - Alerted 1';\r\n    SVTS['hexagon_welcome2'] = 'Hexagon - Alerted 2';\r\n    SVTS['hexagon_welcome3'] = 'Hexagon - Alerted 3';\r\n    SVTS['main_song'] = 'NPhonix - Antigravity';\r\n    SVTS['orakin_death1'] = 'Orakin - Death 1';\r\n    SVTS['orakin_death2'] = 'Orakin - Death 2';\r\n    SVTS['orakin_hurt'] = 'Orakin - Hurt';\r\n    SVTS['orakin_welcome'] = 'Orakin - Alerted';\r\n    SVTS['proxy_alert_over_hereB'] = 'No Helm Proxy - Over here!';\r\n    SVTS['proxy_alert_take_coverB'] = 'No Helm Proxy - Take cover!';\r\n    SVTS['proxy_alert_up_thereA'] = 'No Helm Proxy - Up there!';\r\n    SVTS['proxy_death3'] = 'No Helm Proxy - Death 1';\r\n    SVTS['proxy_death4'] = 'No Helm Proxy - Death 2';\r\n    SVTS['proxy_death5'] = 'No Helm Proxy - Death 3';\r\n    SVTS['proxy_death6'] = 'No Helm Proxy - Death 4';\r\n    SVTS['proxy_dyingC'] = 'No Helm Proxy - Help! 1';\r\n    SVTS['proxy_dyingF'] = 'No Helm Proxy - Help! 2 ';\r\n    SVTS['proxy_enemy_down_fantasticA'] = 'No Helm Proxy - Fantastic.';\r\n    SVTS['proxy_enemy_down_got_oneD'] = 'No Helm Proxy - Got one.';\r\n    SVTS['proxy_enemy_down_niceA'] = 'No Helm Proxy - Nice. 1';\r\n    SVTS['proxy_enemy_down_niceC'] = 'No Helm Proxy - Nice. 2';\r\n    SVTS['proxy_hurt11'] = 'No Helm Proxy - Hurt 1';\r\n    SVTS['proxy_hurt12'] = 'No Helm Proxy - Hurt 2';\r\n    SVTS['proxy_hurt13'] = 'No Helm Proxy - Hurt 3';\r\n    SVTS['proxy_hurt14'] = 'No Helm Proxy - Hurt 4';\r\n    SVTS['proxy_hurt15'] = 'No Helm Proxy - Hurt 5';\r\n    SVTS['proxy_hurt17'] = 'No Helm Proxy - Hurt 6';\r\n    SVTS['proxy_hurt4'] = 'No Helm Proxy - Hurt 7';\r\n    SVTS['proxy_hurt5'] = 'No Helm Proxy - Hurt 8';\r\n    SVTS['proxy_hurt8'] = 'No Helm Proxy - Hurt 9';\r\n    SVTS['proxy_hurt9'] = 'No Helm Proxy - Hurt 10';\r\n    SVTS['silk_alert_contactA'] = 'Silk - Contact!';\r\n    SVTS['silk_alert_i_see_oneA'] = 'Silk - I see one.';\r\n    SVTS['silk_alert_there_is_oneA'] = 'Silk - There is one...!';\r\n    SVTS['silk_death1B'] = 'Silk - Death 1';\r\n    SVTS['silk_death2B'] = 'Silk - Death 2';\r\n    SVTS['silk_dyingB'] = 'Silk - Not good...';\r\n    SVTS['silk_enemy_down_brilliantC'] = 'Silk - Brilliant.';\r\n    SVTS['silk_enemy_down_eliminatedB'] = 'Silk - Eliminated.';\r\n    SVTS['silk_enemy_down_hell_yeahB'] = 'Silk - Hell yeah!';\r\n    SVTS['silk_enemy_down_ive_got_oneB'] = 'Silk - I got one!';\r\n    SVTS['silk_enemy_down_minus_oneB'] = 'Silk - -1.';\r\n    SVTS['silk_enemy_down_no_kicking_for_youB'] = 'Silk - No kicking for you.';\r\n    SVTS['silk_hurt1B'] = 'Silk - Hurt 1';\r\n    SVTS['silk_hurt2B'] = 'Silk - Hurt 2';\r\n    SVTS['silk_hurt5'] = 'Silk - Hurt 3';\r\n    SVTS['silk_hurt6'] = 'Silk - Hurt 4';\r\n    SVTS['silk_hurt9B'] = 'Silk - Hurt 5';\r\n    SVTS['wea_crossfire2'] = 'Crossfire CR-145 Vortex';\r\n    SVTS['wea_ditzy_cs_ik'] = 'Assault Rifle CS-IK';\r\n    SVTS['wea_glhf'] = 'Grenade Launcher CS-GLHF';\r\n    SVTS['wea_incompetence_archetype_27xx_fire'] = 'Archetype 27XX';\r\n    SVTS['wea_lazyrain_gravy_rl'] = 'Falkonian Anti-Grav Rocket Launcher';\r\n    SVTS['wea_m202'] = 'Rocket Launcher CS-Barrage';\r\n    SVTS['wea_moonhawk_railgun'] = 'Crossfire CR-34 Marauder';\r\n    SVTS['wea_ph01'] = 'Crossfire CR-54 Viper';\r\n    SVTS['wea_plasma_shotgun'] = 'Plasma Shotgun';\r\n    SVTS['wea_rail_alt2'] = 'Falkonian PSI Cutter';\r\n    SVTS['wea_thetoppestkek_shotgun_nxs25'] = 'Shotgun NXS-25';\r\n    SVTS['xin_celebrate'] = 'Xin - Celebrating';\r\n    SVTS['xin_death'] = 'Xin - Death';\r\n    SVTS['xin_enemy_spotted'] = 'Xin - Alerted';\r\n    SVTS['xin_hit'] = 'Xin - Hurt';\r\n    let voices = {\r\n        Grosk: [\r\n            \"Grosk\",\r\n            [\"death\", \"Death\", 2],\r\n            [\"dying\", \"Dying\", 2],\r\n            [\"edown\", \"Celebrating\", 3],\r\n            [\"welcome\", \"Alerted\", 5],\r\n            [\"hurt\", \"Hurt\", 3]\r\n        ],\r\n        drohnentroop: [\r\n            \"Drohnen Trooper\",\r\n            [\"welcome\", \"Alerted\", 3],\r\n            [\"hurt\", \"Hurt\", 3],\r\n            [\"edown\", \"Celebrating\", 3],\r\n            [\"dying\", \"Dying\", 1],\r\n            [\"death\", \"Death\", 3]\r\n        ],\r\n        drohnenfem: [\r\n            \"Drohnen Female\",\r\n            [\"welcome\", \"Alerted\", 3],\r\n            [\"hurt\", \"Hurt\", 3],\r\n            [\"edown\", \"Celebrating\", 3],\r\n            [\"dying\", \"Dying\", 1],\r\n            [\"death\", \"Death\", 3]\r\n        ],\r\n        elurra: [\r\n            \"Elurra\",\r\n            [\"welcome\", \"Alerted\", 3],\r\n            [\"hurt\", \"Hurt\", 2],\r\n            [\"edown\", \"Celebrating\", 2],\r\n            [\"dying\", \"Dying\", 1],\r\n            [\"death\", \"Death\", 1]\r\n        ],\r\n        ferro: [\r\n            \"Lt. Ferro\",\r\n            [\"welcome\", \"Alerted\", 3],\r\n            [\"hurt\", \"Hurt\", 2],\r\n            [\"edown\", \"Celebrating\", 3],\r\n            [\"death\", \"Death\", 2]\r\n        ],\r\n        serkova: [\r\n            \"Serkova\",\r\n            [\"welcome\", \"Alerted\", 3],\r\n            [\"hurt\", \"Hurt\", 1],\r\n            [\"edown\", \"Celebrating\", 2],\r\n            [\"death\", \"Death\", 1]\r\n        ],\r\n        phantom: [\r\n            \"Phantom\",\r\n            [\"edown\", \"Celebrating\", 1],\r\n            [\"welcome\", \"Alerted\", 2],\r\n            [\"death\", \"Death\", 1]\r\n        ]\r\n    };\r\n    for (let entry of Object.entries(voices)) {\r\n        let character = entry[0];\r\n        let charVoices = entry[1];\r\n        let charName = charVoices[0];\r\n\r\n        for (let i = 1; i < charVoices.length; i++) {\r\n            let voice = charVoices[i];\r\n            for (let j = 1; j <= voice[2]; j++) {\r\n                SVTS[`${character}_${voice[0]}${j}`] = `${charName} - ${voice[1]} ${j}`\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction updateVoicePresets() {\r\n    // Adds voice presets that exist in game but not in ALE\r\n    let VP = VAL_TABLE['voice_preset'];\r\n    VP['proxy_helmetless'] = 'Proxy (helmetless)';\r\n    VP['silk'] = 'Silk';\r\n    VP['orakin'] = 'Orakin';\r\n    VP['arrin'] = 'Arrin';\r\n    VP['civilian_male'] = 'Civilian Male';\r\n    VP['vulture'] = 'Vulture';\r\n    VP['crossfire_sentinel'] = 'Crossfire Sentinel';\r\n    VP['xin'] = 'Xin';\r\n    VP[\"grosk\"] = \"Grosk\";\r\n\r\n    VP[\"elurra\"] = \"Elurra\";\r\n    VP[\"drohnenfem\"] = \"Drohnen Female\";\r\n    VP[\"serkova\"] = \"Serkova\";\r\n    VP[\"ferro\"] = \"Lt. Ferro\";\r\n    VP[\"drohnentroop\"] = \"Drohnen Trooper\";\r\n    VP[\"phantom\"] = \"Phantom\";\r\n}\r\n\r\nfunction updateStyles() {\r\n    // Changes some stylesheets to open up to things like resizable right panel.\r\n    for(let i1 = 0; i1 < stylesheets.length; i1++) {\r\n        let styleSheet = stylesheets[i1];\r\n        for (let i2 = 0; i2 < styleSheet.rules.length; i2++) {\r\n            let rule = styleSheet.rules[i2];\r\n            switch(rule.selectorText) {\r\n                case \".p_i\":\r\n                    rule.style.setProperty(\"display\", \"flex\");\r\n                    break;\r\n                case \".rightui\":\r\n                    rule.style.setProperty(\"width\", aleiSettings.rightPanelSize);\r\n                    break;\r\n                case \".pa1\":\r\n                    rule.style.setProperty(\"flex-grow\", 0);\r\n                    rule.style.setProperty(\"flex-shrink\", 0);\r\n                    break;\r\n                case \".pa2\":\r\n                    rule.style.setProperty(\"width\", \"100%\");\r\n                    break;\r\n                case \".opcode_field\":\r\n                    rule.style.setProperty(\"font-size\", aleiSettings.triggerEditTextSize);\r\n                    break;\r\n                case \"#rparams\":\r\n                    rule.style.setProperty(\"height\", \"var(--ALEI_RPARAMS_HEIGHT)\");\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    $id(\"stars\").style.setProperty(\"background-image\", `url(${aleiSettings.starsImage})`)\r\n    let _th = THEME;\r\n    ThemeSet(THEME_BLUE);\r\n    ThemeSet(_th);\r\n}\r\n\r\nfunction updateSkins() {\r\n    // Adds skins that exist in game but not in ALE.\r\n    let charlists = [\r\n        [10, \"Head Gib\"],\r\n        [20, \"Arm Gib\"],\r\n        [30, \"Leg Gib\"],\r\n        [50, \"Heavy Hero (Only Head and Arms)\"],\r\n        [60, \"Proxy (Only Head and Arms)\"],\r\n        [62, \"Proxy (No Limbs)\"],\r\n\r\n        [38, \"GoldenKnife Noir Lime\"],\r\n        [39, \"RootZ Noir Lime\"],\r\n\r\n        [151, \"Purple Xin\"],\r\n        [152, \"Golden Xin\"],\r\n        [153, \"Blue Xin\"],\r\n        [154, \"Red Xin\"],\r\n        [155, \"Amber Xin\"],\r\n\r\n        [156, \"Nirvana Noir Lime\"],\r\n\r\n        [157, \"Purple Gallynew\"],\r\n        [158, \"Golden Gallynew\"],\r\n        [159, \"Blue Gallynew\"],\r\n        [160, \"Red Gallynew\"],\r\n        [161, \"Amber Gallynew\"],\r\n\r\n        [162, \"Pinkine\"],\r\n        [163, \"Raider (by Serpent)\"],\r\n        [164, \"Blue Heavy Hero\"],\r\n        [165, \"Red Heavy Hero\"],\r\n        [166, \"Orakin\"],\r\n        [167, \"Husk\"],\r\n        [168, \"Hex\"],\r\n        [169, \"Arrin\"],\r\n        [170, \"Heavy Usurpation Soldier\"],\r\n\r\n        [171, \"Cyber Grub by S1lk\"],\r\n        [172, \"Grosk\"],\r\n        [173, \"Futuristic Knight\"],\r\n        [174, \"Uncivil Proxy\"],\r\n\r\n        [175, \"Serkova Insertion Unit\"],\r\n        [176, \"Xenos Scout\"],\r\n\r\n        [177, \"Armored Trooper\"],\r\n\r\n        [178, \"Newgen Marine\"],\r\n        [179, \"Elurra (by Lin)\"],\r\n        [180, \"Phantom Proxy (Unofficial Name)\"],\r\n        [181, \"Huntsman (Night)\"],\r\n        [182, \"Huntsman (Swamp)\"],\r\n        [183, \"Lt. Ferro (by Serpent)\"],\r\n        [184, \"Xenos Titan\"],\r\n        [185, \"Elurra (Masked) (by Lin)\"],\r\n        [186, \"Drohnen Heavy (by Ark633)\"],\r\n        [187, \"Cromastakan\"],\r\n        [188, \"Sgt. Davais\"],\r\n        [189, \"Maroon (by Francis localhost)\"],\r\n        [190, \"Drohnen Skirmisher (by Ark633)\"],\r\n        [191, \"Serkova Recon Unit\"],\r\n        [192, \"Drohnen Drifter (by Ark633)\"],\r\n        [193, \"Xenos Marine\"],\r\n        [194, \"Phantom Android SLC-56 (Unofficial Name)\"],\r\n        [195, \"Wraith (by Ark633)\"],\r\n        [196, \"Serkova Armored Unit\"],\r\n        [197, \"Phantom\"],\r\n        [198, \"Blue Civil Security Heavy\"],\r\n        [199, \"Red Civil Security Heavy\"],\r\n        [200, \"Xenos Welder\"],\r\n        [201, \"Xenos Engineer\"],\r\n        [202, \"Serkova Assault Unit\"],\r\n        [203, \"Serkova Gunner Unit\"],\r\n        [204, \"Serkova Grenader Unit\"],\r\n        [205, \"Serkova Team Leader\"],\r\n        [206, \"Serkova Resource Unit\"],\r\n        [207, \"Serkova Technician Unit\"],\r\n        [208, \"Serkova Grub\"],\r\n        [209, \"Serkova Reinforced Grub\"],\r\n        [210, \"Serkova Devastator Grub\"],\r\n        [211, \"XBT-117 Android\"],\r\n        [212, \"Teneguilae\"],\r\n        [213, \"Walker (by Serpent)\"],\r\n        [214, \"Space Grub (by Broforce1)\"],\r\n        [215, \"Phantom (Blue)\"],\r\n        [216, \"Phantom (Red)\"]\r\n    ]\r\n    for(let li = 0; li < charlists.length; li++) {\r\n        let charID = charlists[li][0];\r\n        let paddedCharID = charID.toString().padStart(4, \"0\")\r\n        let charName = charlists[li][1];\r\n        let src = \"https://www.plazmaburst2.com/level_editor/chars_full/char\" + paddedCharID + \".png\"\r\n        VAL_TABLE['char'][charID] = _turnLinkIntoSkinSpan(src, charName);\r\n        img_chars_full[charID] = new Image();\r\n        img_chars_full[charID].src = 'chars_full/char' + paddedCharID + '.png';\r\n    }\r\n\r\n    let ids = Object.keys(VAL_TABLE[\"char\"]);\r\n    ids = ids.map(str => parseInt(str));\r\n    let fromID = Math.max(...ids) + 1;\r\n    fetchSkinsFrom(fromID);\r\n}\r\n\r\nfunction _turnLinkIntoSkinSpan(src, charName) {\r\n    return '<span style=\\'background:url(' + src + '); width: 16px; height: 16px; display: inline-block; background-position: center; background-position-x: 30%; background-position-y: 26%; background-size: 67px;vertical-align: -4px;\\'></span> ' + charName;\r\n}\r\n\r\nasync function fetchSkinsFrom(startingID) {\r\n    if(!isNative) {\r\n        NewNote(`ALEI: Will not check for any undetected skins as the function requires tampermonkey-specific function.`, `#FFFF00`);\r\n        return;\r\n    }\r\n    const requestsAtOnce = 5;\r\n    let requestsRunning = true;\r\n    let skinsAdded = [];\r\n\r\n    async function requestSkin(id) {\r\n        let paddedCharID = id.toString().padStart(4, \"0\");\r\n        let src = \"https://www.plazmaburst2.com/level_editor/chars_full/char\" + paddedCharID + \".png\"\r\n        let response = await GM.xmlHttpRequest({ url: src }).catch(e => console.error(e));\r\n        if(response.status == 404) {\r\n            requestsRunning = false;\r\n            return;\r\n        }\r\n        VAL_TABLE[\"char\"][id] = _turnLinkIntoSkinSpan(src, `Unknown Skin #${id}`);\r\n        skinsAdded.push(id);\r\n    }\r\n    async function requestBatch(id) {\r\n        let promises = [];\r\n        for (let i = 0; i < requestsAtOnce; i++) {\r\n            promises.push(requestSkin(id + i));\r\n        }\r\n        await Promise.all(promises);\r\n    }\r\n    let fromID = startingID;\r\n    while(requestsRunning) {\r\n        await requestBatch(fromID);\r\n        fromID += requestsAtOnce;\r\n    }\r\n    if(skinsAdded.length > 0) {\r\n        NewNote(`ALEI: There are ${skinsAdded.length} unregistered skins, please inform ALEI developer(s) about this. Check logs for more information`, `#00FFFF`);\r\n        aleiLog(INFO, `Unregistered skins: ${skinsAdded}`);\r\n    }\r\n}\r\n\r\nfunction optimize() {\r\n    // VSync.\r\n    window.setTimeout = (f, ms) => {\r\n        if (f == ani) {window.requestAnimationFrame(ani)}\r\n        else return JS_setTimeout(f, ms);\r\n    }\r\n    let _browseImages = window.BrowseImages;\r\n    let ogImageLists = {};\r\n    // Image caching.\r\n    window.BrowseImages = function(for_class = 'bg_model', current_value = '', callback = null) {\r\n        // If cache doesn't have the class we are looking for, we will just set default value.\r\n        if (ogImageLists[for_class] == undefined) {\r\n            ogImageLists[for_class] = \"[ALEI] Loading...\";\r\n            aleiLog(INFO, `Will cache response of ${for_class}`);\r\n        }\r\n        // Overwrite setTimeout temporarily, as BrowseImages calls setTimeout for ServerRequest which sets the innerHTML of image_list\r\n        let ost = window.setTimeout;\r\n        window.setTimeout = (f, ms) => {\r\n            window.setTimeout = ost; // Assign original setTimeout\r\n            window.ServerRequest = (req, op, callback = null) => {\r\n                window.ServerRequest = ALEI_ServerRequest; // Assign original ServerRequest\r\n                // We made ServerRequest an async function, so we can just register on it\r\n                ServerRequest(req, op, callback).then(() => {\r\n                    ogImageLists[for_class] = image_list.innerHTML;\r\n                });\r\n            };\r\n            f();\r\n        }\r\n        _browseImages(for_class, current_value, callback);\r\n        image_list.innerHTML = ogImageLists[for_class]; // Show what is in cache. (If cache didn't have the class, it will just show the previously set default value)\r\n    }\r\n}\r\n\r\nfunction updateVehicles() {\r\n    // Adding vehicles that exist in game but not in ALE. Currently only veh_hh, which is grabbable ledge.\r\n    let _SVTV = VAL_TABLE[\"vehicle_model\"];\r\n    let vehicles = [\r\n        [\"veh_hh\", \"Grabbable Ledge\", \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACLSURBVEhLYxhxgBFE2M3/r/vvH0MQWISGgImJYd2hRMbLIDbYYpu5/+t/MzEEf2diuALi0wJw/mPQYf3HsPZIMmMjiA+3+BMLg/olIYblID4tgN47hki+Pww3YRYzgUUHAIxaTDcwajHdwKjFdAOjFtMNjFpMNzBqMd3AqMV0AwPbrh6InsQAAQYGAA8CLDKAAcpOAAAAAElFTkSuQmCC\"]\r\n    ]\r\n    for(let i = 0; i < vehicles.length; i++) {\r\n        let vehicle = vehicles[i];\r\n        let model = vehicle[0];\r\n        let name = vehicle[1];\r\n        let image = vehicle[2];\r\n        _SVTV[model] = `<img src='${image}' border=0 height=12 style=vertical-align:middle title='${name}' > ${name}`\r\n        img_vehicles[model] = new Image();\r\n        img_vehicles[model].src = image;\r\n    }\r\n}\r\n\r\nfunction updateGuns() {\r\n    // Adds guns that exist in game but not in ALE. Currently only one isn't visible in ALE, and that is joke weapon: NARL\r\n    let guns = [\r\n        [\"gun_rl0\", \"BETA Rocket Launcher\", \"data:image/png;base64,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\"]\r\n    ];\r\n    for(let i = 0; i < guns.length; i++) {\r\n        let gun = guns[i];\r\n        let gun_model = gun[0];\r\n        let gun_name = gun[1];\r\n        let gun_image = gun[2];\r\n        VAL_TABLE[\"gun_model\"][gun_model] = `<img src='${gun_image}' border=0 width=80 height=20 style=vertical-align:baseline title='${gun_name}'>`\r\n        img_guns[gun_model] = new Image();\r\n        img_guns[gun_model].src = gun_image;\r\n    }\r\n}\r\n\r\nfunction updateDecors() {\r\n    // Adds decors that exist in game, but not in ALE. Currently only hakase easter egg is known.\r\n    window.img_decors = CACHED_DECORS; // For some reason img_decors gets resetted\r\n    let decors = [\r\n        [\"hakase\", \"Hakase\", \"data:image/png;base64,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\"]\r\n    ];\r\n    for(let i = 0; i < decors.length; i++) {\r\n        let decor = decors[i];\r\n        let decor_model = decor[0];\r\n        let decor_name = decor[1];\r\n        let decor_image = decor[2];\r\n        VAL_TABLE[\"decor_model\"][decor_model] = decor_name; // Add to known decors.\r\n        img_decors[decor_model] = new Image();\r\n        img_decors[decor_model].src = decor_image;\r\n        CACHED_DECORS[decor_model] = img_decors[decor_model];\r\n        CUSTOM_IMAGES_APPROVED[decor_model] = true; // Since it's obviously vanilla, and other vanilla decors are approved, it's only natural if we approve added decors too\r\n    }\r\n    window.ALEI_decors = decors;\r\n}\r\n\r\nfunction updateOffsets() {\r\n    // Because hakase decor and grabbable ledge image is made with hand manually and doesn't come from website, and that there is no\r\n    // inbuilt offset, we have to offset those to make sure they show up in ALE correctly.\r\n    let toosc = window.ThinkOfOffsetClass;\r\n    window.ThinkOfOffsetClass = function(tc, esi) {\r\n        if (tc == \"vehicle\" && offsets[esi.pm.model] != undefined) {\r\n            return \"alei_\" + esi.pm.model;\r\n        } else if (tc == \"decor\" && offsets[esi.pm.model] != undefined) {\r\n            return \"alei_\" + esi.pm.model;\r\n        } else return toosc(tc, esi);\r\n    }\r\n    let offsets = {\r\n        veh_hh: {x: -15, y: -15, w: 30, h: 30},\r\n        hakase: {x: -18, y: -57, w: 40, h: 60}\r\n    }\r\n    for (let key in offsets) {\r\n        let off = offsets[key];\r\n        lo_x[\"alei_\" + key] = off.x;\r\n        lo_y[\"alei_\" + key] = off.y;\r\n        lo_w[\"alei_\" + key] = off.w;\r\n        lo_h[\"alei_\" + key] = off.h;\r\n    }\r\n}\r\n\r\nfunction updateTriggers() {\r\n    // This is where we will rename some triggers.\r\n    // For now it's only 378, but we got more triggers like renaming 328\r\n    addTrigger(175, \"Gun &#8250; Change gun 'A' projectile model to 'B'\", \"gun\", \"ALEI_projectileModels\");\r\n    addTrigger(378, \"Gun &#8250; Add hex color 'B' to gun 'A'\", \"gun\", \"string\");\r\n    addTrigger(332, \"Var &#8250; Set variable 'A' to value 1 if Gun 'B' is in owner's active slot, set to value 0 in else case\", \"string\", \"gun\");\r\n}\r\n\r\nfunction updateObjects() {\r\n    // Shorthand for object-related functions as to not clutter console.\r\n    updateGuns();\r\n    updateVehicles();\r\n    updateDecors();\r\n    updateTriggers();\r\n}\r\n\r\nfunction updateButtons() {\r\n    let topPanel = $id(\"top_panel\");\r\n    let childs = topPanel.children;\r\n\r\n    // We redirect the manual page to EaglePB2's.\r\n    childs[16].value = \"Eagle's Manual\";\r\n    childs[16].setAttribute(\"onclick\", \"window.open('https://eaglepb2.gitbook.io/pb2-editor-manual/', '_blank');\")\r\n\r\n    // We dont want our new buttons to appear after \"rights\", so we will store \"rights\" beforehand and remove them, we'll add them back once we are done\r\n    let appendBack = (topPanel.removeChild(childs[childs.length - 1])).outerHTML;\r\n    appendBack = (topPanel.removeChild(childs[childs.length - 1])).outerHTML + appendBack;\r\n\r\n    // Remove pad (we will add our own later).\r\n    topPanel.removeChild(childs[childs.length - 1])\r\n\r\n    window.aleiButtonClicks = {};\r\n\r\n    // Convenience function for doing easy top panel buttons\r\n    function createButton(text, internalName, onClick) {\r\n        let button = document.createElement(\"input\");\r\n        button.setAttribute(\"class\", \"field_btn\");\r\n        button.setAttribute(\"type\", \"button\");\r\n        button.setAttribute(\"value\", text);\r\n        button.setAttribute(\"onclick\", `aleiButtonClicks['${internalName}']()`);\r\n        window.aleiButtonClicks[internalName] = onClick;\r\n\r\n        let pad = document.createElement(\"div\");\r\n        pad.setAttribute(\"class\", \"q\");\r\n\r\n        topPanel.appendChild(button);\r\n        topPanel.appendChild(pad);\r\n    }\r\n    let bigPad = document.createElement(\"div\");\r\n    bigPad.setAttribute(\"class\", \"q3\");\r\n    topPanel.appendChild(bigPad);\r\n\r\n    // \"Download XML\" button.\r\n    createButton(\"Download XML\", \"downloadXMLButton\", exportXML);\r\n    // \"Insert XML\" button.\r\n    createButton(\"Insert XML\", \"insertXMLButton\", () => {\r\n        let file = confirm(\"File (OK) or text (Cancel) ?\");\r\n\r\n        if (file) {\r\n            let fileInput = document.createElement(\"input\");\r\n\r\n            fileInput.type = \"file\";\r\n\r\n            fileInput.onchange = function() {\r\n                if (fileInput.files[0]) {\r\n                    if (fileInput.files[0].name.split(\".\")[1] == \"xml\") {\r\n                        let reader = new FileReader();\r\n\r\n                        reader.onload = function() {\r\n                            insertXML(reader.result);\r\n\r\n                            fileInput.remove();\r\n                        }\r\n\r\n                        reader.readAsText(fileInput.files[0]);\r\n                    } else {\r\n                        alert(\"Invalid file extension.\");\r\n                    }\r\n                }\r\n            }\r\n\r\n            fileInput.click();\r\n        } else {\r\n            let xml = prompt(\"Enter XML:\", \"\");\r\n\r\n            if (xml !== null) {\r\n                insertXML(xml);\r\n            }\r\n        }\r\n    });\r\n    createButton(\"ALEI Settings\", \"openALEISettings\", showSettings);\r\n    // Readd 'rights' back.\r\n    topPanel.innerHTML += appendBack;\r\n    // Update original reference\r\n    window.mapid_field = $id(\"mapid_field\");\r\n    mapid_field.value = mapid; // And update map id field value manually.\r\n}\r\n\r\nfunction addClipboardSync() {\r\n    let clipboard_channel = new BroadcastChannel(\"ale_clipboard\");\r\n\r\n    ///////////////\r\n    // Receiving //\r\n    ///////////////\r\n    clipboard_channel.onmessage = (msg) => {\r\n        let data = msg.data;\r\n        let kind = data.kind;\r\n        if (kind == \"send\") {\r\n            let recipient = data.recipient;\r\n            let clip_name  = data.clip_name;\r\n            let clip_data  = data.clip_data;\r\n\r\n            if (recipient == undefined || recipient == aleiSessionID) {\r\n                aleiLog(DEBUG, '/ale_clipboard/ got data for ' + clip_name);\r\n                sessionStorage[clip_name] = clip_data;\r\n            }\r\n        }\r\n        if (kind == \"get\") {\r\n            if (aleiSessionID > Math.min(...aleiSessionList)) return;\r\n\r\n            let session_id = data.session_id;\r\n            aleiLog(DEBUG, '/ale_clipboard/ syncing to ' + session_id);\r\n            for (let i = 0; i <= 10; i++) {\r\n                let clip_name = \"clipboard\" + (i == 0 ? \"\" : (\"_slot\" + (i-1)));\r\n                let clip_data = sessionStorage[clip_name];\r\n                if (clip_data == undefined) continue;\r\n                clipboard_channel.postMessage({kind: \"send\", recipient: session_id, clip_name, clip_data});\r\n            }\r\n        }\r\n    }\r\n\r\n    // Initial Sync\r\n    aleiLog(DEBUG, '/ale_clipboard/ requesting');\r\n    clipboard_channel.postMessage({kind: \"get\", session_id: aleiSessionID});\r\n\r\n    /////////////\r\n    // Sending //\r\n    /////////////\r\n    let ALE_CopyToClipBoard = window.CopyToClipBoard;\r\n    window.CopyToClipBoard = (clip_name) => {\r\n        ALE_CopyToClipBoard(clip_name);\r\n        let clip_data = sessionStorage[clip_name];\r\n        clipboard_channel.postMessage({kind: \"send\", clip_name, clip_data});\r\n    }\r\n}\r\n\r\nasync function addSessionSync() {\r\n    // This function registers some events, as to talk with other tabs\r\n    // For now, this is useful for clipboard sync, but we probably can have more.\r\n    const PROBE_TIMEOUT_MS = 200;\r\n    let session_channel = new BroadcastChannel(\"ale_session\");\r\n\r\n    // Receive data\r\n    session_channel.onmessage = (msg) => {\r\n        let data = msg.data;\r\n        let kind = data.kind;\r\n        // New ALEI instance started up.\r\n        if (kind == \"start\") {\r\n            if (aleiSessionID == null) return;\r\n            session_channel.postMessage({kind: \"greet\", id: aleiSessionID});\r\n            aleiLog(DEBUG, \"/ale_session/ recieved start\");\r\n        }\r\n        // An ALEI instance responded to new ALEI instance, registering the ALEI instance\r\n        if (kind == \"greet\") {\r\n            let session_id = data.id;\r\n            if (!aleiSessionList.includes(session_id))\r\n                aleiSessionList.push(session_id);\r\n            aleiLog(DEBUG, \"/ale_session/ received greet by \" + session_id);\r\n        }\r\n        // An ALEI instance is closing\r\n        if (kind == \"close\") {\r\n            let session_id = data.id;\r\n            aleiSessionList.splice(aleiSessionList.indexOf(session_id), 1);\r\n            aleiLog(DEBUG, \"/ale_session/ received close by \" + session_id);\r\n        }\r\n    }\r\n\r\n    // Probe for other sessions\r\n    session_channel.postMessage({kind: \"start\"});\r\n    aleiLog(DEBUG, \"/ale_session/ probing\");\r\n    await new Promise(resolve => {\r\n        JS_setTimeout(resolve, PROBE_TIMEOUT_MS);\r\n    });\r\n\r\n    // Assign own session ID\r\n    if (aleiSessionList.length == 0)\r\n        aleiSessionID = 0;\r\n    else\r\n        aleiSessionID = Math.max(...aleiSessionList) + 1;\r\n\r\n    aleiLog(DEBUG, \"/ale_session/ session ID \" + aleiSessionID);\r\n\r\n    // Tell other sessions that this one is done\r\n    window.addEventListener('beforeunload', (event) => {\r\n        session_channel.postMessage({kind: \"close\", id: aleiSessionID});\r\n    });\r\n\r\n    addClipboardSync();\r\n}\r\n\r\nfunction addPropertyPanelResize() {\r\n    // Gives right panel ability to be resized.\r\n\r\n    let splitter_is_down = false;\r\n    const splitter = document.createElement(\"div\");\r\n    const root = document.documentElement;\r\n\r\n    splitter.style.position = \"absolute\";\r\n    splitter.style.width = \"5px\";\r\n    splitter.style.top = \"50px\";\r\n    splitter.style.height = \"100%\";\r\n    splitter.style.cursor = \"w-resize\";\r\n    // splitter.style[\"background-color\"] = \"black\";\r\n    $id('floattag').appendChild(splitter);\r\n\r\n    function splitter_resize(e) {\r\n        let new_width = Math.min(root.clientWidth - 100, Math.max(100, root.clientWidth - e.clientX));\r\n        right_panel.style.width = new_width + 'px';\r\n        splitter.style.right = new_width + 'px';\r\n        ROOT_ELEMENT.style.setProperty(\"--param_panel_size\", splitter.style.right);\r\n        updateBoxSplitterSize();\r\n    }\r\n\r\n    splitter.addEventListener('mousedown', (e) => {\r\n        splitter_is_down = true;\r\n    });\r\n\r\n    root.addEventListener('mouseup', (e) => {\r\n        splitter_is_down = false;\r\n        writeStorage('ALEI_RightPanelWidth', right_panel.clientWidth + 'px');\r\n    });\r\n\r\n    root.addEventListener('mousemove', (e) => {\r\n        if (splitter_is_down) splitter_resize(e);\r\n    });\r\n\r\n    splitter.style.right = aleiSettings.rightPanelSize;\r\n    ROOT_ELEMENT.style.setProperty(\"--param_panel_size\", splitter.style.right);\r\n    window.splitter = splitter;\r\n}\r\n\r\nfunction addTriggerIDs() {\r\n    if (!aleiSettings.showTriggerIDs) return;\r\n\r\n    let SVTTP = VAL_TABLE['trigger_type'];\r\n    for (let i in SVTTP) {\r\n        SVTTP[i] = i + \" \" + SVTTP[i];\r\n    }\r\n}\r\n\r\nfunction patchShowHideButton() {\r\n    let og = window.ShowHideObjectBox;\r\n    window.ShowHideObjectBox = function() {\r\n        og();\r\n        let rparams = $id(\"rparams\");\r\n        let heightOffset = {true: 270, false: 155}[ObjectBox_visible];\r\n        if (rparams != null) {\r\n            heightOffset = Math.round(rparams.getBoundingClientRect().top + 13);\r\n        }\r\n        // We then set variable and call original function.\r\n        document.documentElement.style.setProperty(\"--ALEI_RPARAMS_HEIGHT\", `calc(100vh - ${heightOffset}px)`);\r\n        //og();\r\n    }\r\n    ShowHideObjectBox();\r\n    ShowHideObjectBox(); // Hacky way to fix bug\r\n}\r\n\r\nwindow.ALEI_CustomSnapping = () => {\r\n    let snapping = prompt(\"Enter snapping:\", \"\");\r\n\r\n    if(!snapping) return;\r\n    if(isNaN(Number(snapping))) {NewNote(\"Invalid snapping.\", \"#FF0000\"); return};\r\n\r\n    if (snapping < 0.1) {\r\n        snapping = 0.1;\r\n        NewNote(\"ALEI: Snapping can't be less than 0.1\", \"#FF0000\");\r\n        return;\r\n    }\r\n\r\n    if (snapping > 100) {\r\n        snapping = 100;\r\n        NewNote(\"ALEI: Snapping can't be greater than 100\", \"#FF0000\");\r\n        return;\r\n    }\r\n\r\n    GridSnappingSet(Math.round(snapping * 10));\r\n}\r\n\r\nfunction addSnappingOptions_helper() {\r\n    // Remove default snapping options except for \"1\", we will replace it them later\r\n    $query(`a[onmousedown=\"GridSnappingSet(50);\"]`).remove();\r\n    $query(`a[onmousedown=\"GridSnappingSet(100);\"]`).remove();\r\n\r\n    let newHTML = \"\"\r\n    let snappingOptions = [\r\n        1, 2, 5,\r\n        10, 20, 40,\r\n        50, 100, \"C\"\r\n    ];\r\n\r\n    for (let snappingIndex in snappingOptions) {\r\n        let snapping = snappingOptions[snappingIndex];\r\n\r\n        if ((snappingIndex % 3 == 0) && (snappingIndex != 0)) {\r\n            // We have to break into new row.\r\n            newHTML += \"<br>\";\r\n        }\r\n\r\n        let element = document.createElement(\"a\");\r\n        // Set relevant attributes.\r\n\r\n        if (snapping != \"C\") {\r\n            element.innerHTML = snapping / 10;\r\n        } else {\r\n            element.innerHTML = \"C\";\r\n        }\r\n\r\n        let toolClass = \"tool_btn\";\r\n        if (GRID_SNAPPING == snapping) {\r\n            toolClass = \"tool_btn2\";\r\n        }\r\n\r\n        if (!snappingOptions.includes(GRID_SNAPPING) && snapping == \"C\") {\r\n            toolClass = \"tool_btn2\";\r\n        }\r\n\r\n        element.setAttribute(\"class\", `${toolClass} tool_wid`);\r\n        element.setAttribute(\"style\", \"width: 21px;\");\r\n\r\n        if (snapping != \"C\") {\r\n            element.setAttribute(\"onmousedown\", `GridSnappingSet(${snapping}); Render();`);\r\n        } else {\r\n            element.setAttribute(\"onmousedown\", \"ALEI_CustomSnapping(); Render();\");\r\n        }\r\n\r\n        newHTML += element.outerHTML;\r\n        // Add to main HTML.\r\n    }\r\n    // Replace original `1` snapping with new HTML.\r\n    $query(`a[onmousedown=\"GridSnappingSet(10);\"]`).outerHTML = newHTML;\r\n}\r\n\r\nwindow.ALEI_UpdateRematchUIDSetting = function(value) {\r\n\r\n    aleiSettings.rematchUID = value;\r\n    writeStorage(\"ALEI_RemapUID\", value);\r\n    UpdateTools();\r\n}\r\n\r\nfunction addRematchUIOptions_helper() {\r\n    $query(`a[onmousedown=\"EvalSet('param_panel_size',800);SaveBrowserSettings();UpdateCSS();\"]`).remove();\r\n\r\n    let result = document.evaluate(\"//span[contains(., 'Param')]\", left_panel, null, XPathResult.ANY_TYPE, null);\r\n    result.iterateNext();\r\n    result.iterateNext().innerHTML = \"Remap UID\";\r\n\r\n    for (let value of [[true, \"Yes\", 0], [false, \"No\", 200]]) {\r\n        let element = document.createElement(\"a\");\r\n        element.innerHTML = value[1];\r\n\r\n        let toolClass = \"tool_btn\";\r\n        if(aleiSettings.rematchUID == value[0]) toolClass = \"tool_btn2\";\r\n\r\n        element.setAttribute(\"class\", `${toolClass} tool_wid`);\r\n        element.setAttribute(\"style\", \"width: 64px;\");\r\n        element.setAttribute(\"onmousedown\", `ALEI_UpdateRematchUIDSetting(${value[0]})`);\r\n\r\n        $query(`a[onmousedown=\"EvalSet('param_panel_size',${value[2]});SaveBrowserSettings();UpdateCSS();\"]`).outerHTML = element.outerHTML;\r\n    }\r\n\r\n}\r\n\r\nwindow.ALEI_UpdateNameRenderSetting = function(status) { // TODO: we should have mixin function lol, check: <#1245454955477729382>\r\n    /*if(!status) {\r\n        let code = ALE_Render.toString().replace(\"if (es[i].pm.uid != undefined)\", \"if (false)\");\r\n        eval(code);\r\n        window.Render = Render;\r\n        aleiSettings.renderObjectNames = false;\r\n        writeStorage(\"ALEI_RenderObjectNames\", false);\r\n    } else {\r\n        window.Render = ALE_Render;\r\n        aleiSettings.renderObjectNames = true;\r\n        writeStorage(\"ALEI_RenderObjectNames\", true);\r\n    }*/\r\n    ENABLE_TEXT = status;\r\n    aleiSettings.renderObjectNames = status;\r\n    writeStorage(\"ALEI_RenderObjectNames\", status);\r\n    UpdateTools();\r\n    need_redraw = 1;\r\n}\r\nfunction addPreviewNamesOptions_helper() {\r\n    let prevElement = $query(`a[onmousedown=\"ShowTexturesSet(true);\"]`);\r\n\r\n    function space() {\r\n        let spacer = document.createElement(\"div\");\r\n        spacer.setAttribute(\"class\", \"q\");\r\n        prevElement.outerHTML += spacer.outerHTML;\r\n    }\r\n\r\n    let headerText = document.createElement(\"span\");\r\n    headerText.setAttribute(\"class\", \"gui_sel_info\");\r\n    headerText.innerHTML = \"Object Names\";\r\n\r\n    let buttonHTML = \"\";\r\n\r\n    function addButton(text, status) {\r\n        let button = document.createElement(\"a\");\r\n        let _class = \"tool_btn\";\r\n\r\n        if(status == aleiSettings.renderObjectNames) _class = \"tool_btn2\";\r\n\r\n        button.setAttribute(\"class\", `tool_wid ${_class}`);\r\n        button.setAttribute(\"style\", \"width: 32px\");\r\n        button.setAttribute(\"onmousedown\", `ALEI_UpdateNameRenderSetting(${status});`);\r\n        button.innerHTML = text;\r\n        buttonHTML += button.outerHTML;\r\n    }\r\n\r\n    addButton(\"Show\", true);\r\n    addButton(\"Hide\", false);\r\n\r\n    prevElement.outerHTML += `<br><div class=\"q\"></div><br>` + headerText.outerHTML + \"<br>\" + buttonHTML;\r\n\r\n}\r\n\r\nfunction onToolUpdate() {\r\n    addSnappingOptions_helper();\r\n    addRematchUIOptions_helper();\r\n    addPreviewNamesOptions_helper();\r\n}\r\n\r\nfunction patchUpdateTools() {\r\n    let ut = UpdateTools;\r\n    window.UpdateTools = function() {\r\n        ut();\r\n        onToolUpdate();\r\n    }\r\n    UpdateTools();\r\n    aleiLog(DEBUG, \"Patched updateTools.\");\r\n}\r\n\r\nfunction tryToNumber(x) {\r\n    if (!isNaN(Number(x))) {\r\n        return Number(x);\r\n    } else {\r\n        return x;\r\n    }\r\n}\r\n\r\nfunction insertXML(xml) {\r\n    xml = \"<map>\" + xml.replaceAll(\"&\", \"[__Amp]\") + \"</map>\";\r\n\r\n    let parser = new DOMParser();\r\n    let map = parser.parseFromString(xml, \"application/xml\");\r\n    let objects = map.querySelectorAll(\"*\");\r\n\r\n    for (let i = 1; i < objects.length; i++) {\r\n        let object = objects[i];\r\n        if (object.tagName == \"map\") continue;\r\n\r\n        let eo = new E(object.tagName);\r\n        eo.pm = {};\r\n\r\n        for (let j = 0; j < object.attributes.length; j++) {\r\n            let name = object.attributes[j].name;\r\n            let value = object.attributes[j].value;\r\n\r\n            eo.pm[name] = tryToNumber(value.replaceAll(\"[__Amp]\", \"&\"));\r\n        }\r\n\r\n        es.push(eo);\r\n    }\r\n\r\n    need_redraw = 1;\r\n    need_GUIParams_update = 1;\r\n}\r\n\r\nfunction exportXML() {\r\n    let exportSelection = 0;\r\n    let newstr = \"\";\r\n    let download = document.createElement(\"a\");\r\n\r\n    for (let i = 0; i < es.length; i++) {\r\n        if (es[i].selected) {\r\n            exportSelection = 1;\r\n        }\r\n    }\r\n\r\n    if (exportSelection) {\r\n        if(!confirm(\"Only selection will be exported.\")) return;\r\n        for (let i = 0; i < es.length; i++) {\r\n            if (es[i].selected) {\r\n                newstr += compi_obj(i);\r\n            }\r\n        }\r\n\r\n        if (mapid) {\r\n            download.download = mapid + \" (selection).xml\";\r\n        } else {\r\n            download.download = \"newmap (selection).xml\";\r\n        }\r\n    } else {\r\n        for (let i = 0; i < es.length; i++) {\r\n            if (es[i].exists) {\r\n                newstr += compi_obj(i);\r\n            }\r\n        }\r\n\r\n        if (mapid) {\r\n            download.download = mapid + \".xml\";\r\n        } else {\r\n            download.download = \"newmap.xml\";\r\n        }\r\n    }\r\n\r\n    download.href = \"data:text,\" + escape(newstr);\r\n\r\n    if (newstr != \"\") {\r\n        download.href = \"data:text,\" + escape(newstr);\r\n\r\n        download.click();\r\n    } else {\r\n        alert(\"Map is empty.\");\r\n    }\r\n\r\n    download.remove();\r\n}\r\n///////////////////////////////\r\nconst _ignoredKeys = [\r\n    // Numbers obviously cannot have texts.\r\n    \"x\",\r\n    \"y\",\r\n    \"w\",\r\n    \"h\",\r\n    \"maxcalls\",\r\n    \"command\",\r\n    \"upg\",\r\n    \"tox\",\r\n    \"toy\",\r\n    \"stab\",\r\n    \"damage\",\r\n    \"u\",\r\n    \"v\",\r\n    \"sx\",\r\n    \"sy\",\r\n    \"r\",\r\n    \"f\",\r\n    \"power\",\r\n    // Booleans obviously cannot have texts.\r\n    \"enabled\",\r\n    \"flare\",\r\n    // We are obviously not going to change UID\r\n    \"uid\",\r\n    // We are obviously not going to change models\r\n    \"gun_model\",\r\n    \"model\",\r\n];\r\nfunction updateUIDReferences(oldName, newName) {\r\n    aleiLog(DEBUG2, `Updating UID references from ${ANSI_CYAN}${oldName}${ANSI_RESET} to ${ANSI_CYAN}${newName}${ANSI_RESET}`);\r\n    for (let i = 0; i < es.length; i++) {\r\n        let element = es[i];\r\n        if (!element.exists) continue;\r\n        let properties = element.pm;\r\n\r\n        for (let entry of Object.entries(properties)) {\r\n            let key = entry[0];\r\n            let value = entry[1];\r\n\r\n            // Quick elimination\r\n            if (_ignoredKeys.indexOf(key) !== -1) continue;\r\n            if (typeof(value) !== \"string\") continue;\r\n            if (value.indexOf(oldName) === -1) continue;\r\n\r\n            // Actual replacement\r\n            if (value === oldName) { // Fine.\r\n                properties[key] = newName;\r\n                continue;\r\n            }\r\n\r\n            let splt = value.split(\",\");\r\n            for (let i = 0; i < splt.length; i++) {\r\n                let item = splt[i];\r\n                if (item.trim() == oldName) {\r\n                    splt[i] = item.replace(oldName, newName);\r\n                }\r\n            }\r\n            properties[key] = splt.join(\",\");\r\n        }\r\n    }\r\n    window.need_GUIParams_update = true;\r\n}\r\n\r\nfunction UpdatePhysicalParam(paramname, chvalue) {\r\n    lcz();\r\n    var layer_mismatch = false;\r\n    var list_changes = '';\r\n    for (var elems = 0; elems < es.length; elems++)\r\n        if (es[elems].exists && es[elems].selected)\r\n            if (es[elems].pm.hasOwnProperty(paramname)) {\r\n                if (MatchLayer(es[elems])) {\r\n                    if (paramname == \"uid\" && aleiSettings.rematchUID) {\r\n                        updateUIDReferences(es[elems].pm.uid, chvalue);\r\n                    }\r\n\r\n                    var lup = (typeof(paramname) == 'string') ? '\"' + paramname + '\"' : paramname;\r\n                    if (typeof(chvalue) == 'number' || ((chvalue === 0))) {\r\n                        lnd('es[' + elems + '].pm[' + lup + '] = ' + es[elems].pm[paramname] + ';');\r\n                        ldn('es[' + elems + '].pm[' + lup + '] = ' + chvalue + ';');\r\n                        es[elems].pm[paramname] = Number(chvalue);\r\n                    } else if (typeof(chvalue) == 'string') {\r\n                        lnd('es[' + elems + '].pm[' + lup + '] = \"' + es[elems].pm[paramname] + '\";');\r\n                        ldn('es[' + elems + '].pm[' + lup + '] = \"' + chvalue + '\";');\r\n                        es[elems].pm[paramname] = _encodeXMLChars(chvalue);\r\n                    } else {\r\n                        alert('Unknown value type: ' + typeof(chvalue));\r\n                    }\r\n                    list_changes += 'Parameter \"' + paramname + '\" of object \"' + (es[elems].pm.uid != null ? es[elems].pm.uid : es[elems]._class) + '\" was set to \"' + chvalue + '\"<br>';\r\n                    if(paramname == \"uses_timer\") { // I do not have to do this, but i will for convenience\r\n                        if([true, \"true\"].indexOf(es[elems].pm.uses_timer) != -1) {\r\n                            param_type[REGION_EXECUTE_PARAM_ID][1] = \"timer+none\";\r\n                        } else {\r\n                            param_type[REGION_EXECUTE_PARAM_ID][1] = \"trigger+none\";\r\n                        }\r\n                        need_GUIParams_update = true;\r\n                    }\r\n                } else layer_mismatch = true;\r\n            } need_redraw = true;\r\n    NewNote('Operation complete:<br><br>' + list_changes, note_passive);\r\n    if (layer_mismatch) NewNote('Note: Some changes weren\\'t made due to missmatch of active layer and class of selected objects', note_neutral);\r\n    lfz(false);\r\n\r\n    sortObjects();\r\n}\r\n\r\nlet imageContextMap = {};\r\nlet last_element;\r\nlet last_login;\r\nwindow.aleiContextRenameImage = function(id) {\r\n    var v = prompt('New name:', imageContextMap[id]);\r\n    CloseImageContext();\r\n    if ( v !== null ) {\r\n        ServerRequest(`a=get_images&for_class=${last_for_class}&set_title_for=${id}&value=${v}`, \"rename_image\");\r\n    }\r\n}\r\nwindow.aleiContextDeleteImage = function(id) {\r\n    let v = confirm(`Are you sure you want to delete ${imageContextMap[id]} ?`);\r\n    CloseImageContext();\r\n    if ( v ) {\r\n        last_element.style.opacity = '0.5';\r\n        ServerRequest(`a=get_images&for_class=${last_for_class}&delete=${id}`, 'delete_image' );\r\n    }\r\n}\r\n\r\nfunction ImageContext(id, e, old_name, element, moderator_menu, awaiting_approval=false, login='?', approver='?', is_fav_menu = false) {\r\n    imageContextMap[id] = old_name;\r\n    last_element = element;\r\n    last_login = login;\r\n    e.preventDefault();\r\n\r\n    var image_context = document.getElementById('image_context');\r\n\r\n    var str = '';\r\n\r\n    if (moderator_menu) {\r\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&approve_for=${id}', 'approve_image' ); }, 1 );\">Approve <img src=\"../images/ap.png\" width=\"11\" height=\"11\"></div>`;\r\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&reset_status_for=${id}', 'reset_approval_image' ); }, 1 );\">Reset approval status</div>`;\r\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { open_approved_decor_model = true; SaveFiltering(); search_phrase = '*by_login*'+last_login; UpdateImageList(); }, 1 );\">Search for other approved images from &quot;${login}&quot;</div>`;\r\n        str += `<div onclick=\"\" style=\"color:rgba(0,0,0,0.3)\">Last status change by ${approver}</div>`;\r\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&disapprove_for_all='+last_login, 'disapprove_image' ); }, 1 );\">Disapprove all unreviewed from &quot;${login}&quot; <img src=\"../images/noap.png\" width=\"11\" height=\"11\"><img src=\"../images/noap.png\" width=\"11\" height=\"11\"><img src=\"../images/noap.png\" width=\"11\" height=\"11\"></div>`;\r\n        str += `<div onclick=\"CloseImageContext(); setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&disapprove_for=${id}', 'disapprove_image' ); }, 1 );\">Disapprove <img src=\"../images/noap.png\" width=\"11\" height=\"11\"></div>`;\r\n\r\n    } else {\r\n        //console.log( login, curlogin );\r\n\r\n        if (login == curlogin && approver != '!') {\r\n            str += `<div onclick=\"aleiContextRenameImage(${id})\">Rename</div>`; // We overwrite rename action to our own.\r\n\r\n            if (awaiting_approval) {\r\n                str += `<div onclick=\"\" style=\"color:rgba(0,0,0,0.3)\">Request Approval (already done)</div>`;\r\n                str += `<div onclick=\"CloseImageContext();  setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&deawait_approval_for=${id}', 'await_approval_status' ); }, 1 ); \">Exclude from approval review queue</div>`;\r\n            } else {\r\n                if (old_name == 'Untitled') {\r\n                    str += `<div onclick=\"alert('Proper name required for custom image - you will not be available to change name once image is approved.');\" style=\"color:rgba(0,0,0,0.3)\">Request Approval (proper name required)</div>`;\r\n                } else {\r\n                    str += `<div onclick=\"CloseImageContext();  setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&await_approval_for=${id}', 'await_approval_status' ); }, 1 ); \">Request Approval <img src=\"../images/ap.png\" width=\"11\" height=\"11\"></div>`;\r\n                }\r\n                str += `<div onclick=\"\" style=\"color:rgba(0,0,0,0.3)\">Exclude from approval review queue (not in queue)</div>`;\r\n            }\r\n\r\n            str += `<div onclick=\"aleiContextDeleteImage(${id})\">Delete <img src=\"../images/noap.png\" width=\"11\" height=\"11\"></div>`;\r\n        } else {\r\n            str += `<div onclick=\"CloseImageContext(); setTimeout( function() { open_approved_decor_model = true; SaveFiltering(); search_phrase = '*by_login*'+last_login; UpdateImageList(); }, 1 );\">Search for other approved images from &quot;${login}&quot;</div>`;\r\n        }\r\n\r\n        str += `<span style=\"display:block;\">&nbsp;</span>`;\r\n        if (is_fav_menu) {\r\n            str += `<div onclick=\"CloseImageContext();  setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&favorite_del=${id}', 'favorite_status' ); }, 1 ); \">Remove from favorites</div>`;\r\n        } else {\r\n            str += `<div onclick=\"CloseImageContext();  setTimeout( function() { ServerRequest('a=get_images&for_class='+last_for_class+'&favorite_add=${id}', 'favorite_status' ); }, 1 ); \">Add to favorites</div>`;\r\n        }\r\n\r\n    }\r\n\r\n    image_context.innerHTML = str;\r\n\r\n    image_context.style.left = e.clientX;\r\n    image_context.style.top = e.clientY;\r\n    image_context.style.display = 'block';\r\n\r\n    image_context_cancel_pad.style.display = 'block';\r\n\r\n    return false;\r\n}\r\n\r\nfunction findObjects(name) {\r\n    let exact = confirm(\"Exact name?\");\r\n    let notFound = 1;\r\n\r\n    function pred(d) {\r\n        if (exact) {return d == name;}\r\n        else {return d.includes(name)}\r\n    }\r\n\r\n    for (let i = 0; i < es.length; i++) {\r\n        es[i].selected = 0;\r\n\r\n        if (es[i].pm.uid) {\r\n            if (pred(es[i].pm.uid) && MatchLayer(es[i])) {\r\n                es[i].selected = 1;\r\n                notFound = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    need_GUIParams_update = 1;\r\n    need_redraw = 1;\r\n\r\n    return notFound;\r\n}\r\n\r\nfunction rotateObjects() {\r\n    let selected = getSelection();\r\n    let distX = [];\r\n    let distY = [];\r\n    let minX;\r\n    let minY;\r\n\r\n    for (let i = 0; i < selected.length; i++) {\r\n        if (selected[i].pm.w && selected[i].pm.h) {\r\n            let save = selected[i].pm.w;\r\n\r\n            selected[i].pm.w = selected[i].pm.h;\r\n            selected[i].pm.h = save;\r\n        }\r\n\r\n        distX.push(selected[i].pm.x);\r\n        distY.push(selected[i].pm.y);\r\n    }\r\n\r\n    minX = Math.min(...distX);\r\n    minY = Math.min(...distY);\r\n\r\n    for (let i = 0; i < selected.length; i++) {\r\n        distX[i] -= minX;\r\n        distY[i] -= minY;\r\n\r\n        selected[i].pm.x = minX + distY[i];\r\n        selected[i].pm.y = minY + distX[i];\r\n    }\r\n}\r\n\r\nfunction RandomizeName(oldname) {\r\n    var newname = oldname;\r\n    var phrase = \"*\";\r\n    var unoriginal;\r\n    for (let i = 0; i < es.length; i++)\r\n        if (es[i].exists)\r\n            if (es[i].pm.uid != undefined) {\r\n                if (es[i].pm.uid == newname) {\r\n                    unoriginal = true;\r\n                    oldname = newname;\r\n                }\r\n            }\r\n    if (unoriginal) {\r\n        var takes = 0;\r\n        do {\r\n            unoriginal = false;\r\n            var indof = oldname.lastIndexOf(phrase);\r\n            var copysuffix = Math.floor(oldname.substring(indof + 1));\r\n            if (indof == -1 || isNaN(copysuffix)) {\r\n                newname = oldname + phrase + '1';\r\n            } else {\r\n                newname = oldname.substring(0, indof) + phrase + (copysuffix + 1);\r\n            }\r\n            takes += 1;\r\n            for (let i = 0; i < es.length; i++)\r\n                if (es[i].exists)\r\n                    if (es[i].pm.uid != undefined) {\r\n                        if (es[i].pm.uid == newname) {\r\n                            unoriginal = true;\r\n                            oldname = newname;\r\n                        }\r\n                    }\r\n        } while (unoriginal);\r\n    }\r\n    return newname;\r\n}\r\n\r\nfunction patchRandomizeName() {\r\n    window.RandomizeName = RandomizeName;\r\n}\r\n\r\nfunction patchAllowedCharacters() {\r\n    allowed_string_chars += \"<>\";\r\n}\r\n\r\nfunction getRuleBySelector(selector) {\r\n    let rules = document.styleSheets[0].rules;\r\n    let rule;\r\n\r\n    for (let i = 0; i < rules.length; i++) {\r\n        if (rules[i].selectorText == selector) {\r\n            rule = rules[i];\r\n        }\r\n    }\r\n\r\n    return rule;\r\n}\r\n\r\nfunction setStyle(selector, style, value) {\r\n    getRuleBySelector(selector).style[style] = value;\r\n}\r\n\r\nfunction blackTheme() {\r\n    ThemeSet(0);\r\n\r\n    THEME = 4;\r\n\r\n    setStyle(\".topui\", \"backgroundSize\", \"0px\");\r\n    setStyle(\".leftui\", \"backgroundSize\", \"0px\");\r\n    setStyle(\".rightui\", \"backgroundSize\", \"0px\");\r\n    setStyle(\".topui\", \"backgroundColor\", \"#101010\");\r\n    setStyle(\".leftui\", \"backgroundColor\", \"#101010\");\r\n    setStyle(\".rightui\", \"backgroundColor\", \"#101010\");\r\n    setStyle(\".field_btn\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".tool_btn\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".tool_btn\", \"border\", \"\");\r\n    setStyle(\".tool_btn2\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".tool_btn2\", \"border\", \"1px solid #888\");\r\n    setStyle(\".field_btn\", \"color\", \"#CCC\");\r\n    setStyle(\".tool_btn\", \"color\", \"#CCC\");\r\n    setStyle(\".tool_btn2\", \"color\", \"#CCC\");\r\n    setStyle(\".gui_sel_info\", \"color\", \"#CCC\");\r\n    setStyle(\".c\", \"color\", \"#CCC\");\r\n    setStyle(\".pa1\", \"color\", \"#CCC\");\r\n    setStyle(\".pa2\", \"color\", \"#CCC\");\r\n    setStyle(\".field_dis_left\", \"color\", \"#CCC\");\r\n    setStyle(\".field_dis_right\", \"color\", \"#CCC\");\r\n    setStyle(\".p_u1\", \"border\", \"\");\r\n    setStyle(\".p_u2\", \"border\", \"\");\r\n    setStyle(\".pa1\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".pa2\", \"backgroundColor\", \"#000000\");\r\n    setStyle(\".objbox\", \"backgroundColor\", \"#000000\");\r\n    setStyle(\".field_dis_left\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".field_dis_right\", \"backgroundColor\", \"#000000\");\r\n    setStyle(\".selline1\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".tool_btn:hover\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".tool_btn:hover\", \"border\", \"1px solid #888\");\r\n    setStyle(\".tool_btn:hover\", \"color\", \"#CCC\");\r\n    setStyle(\".tool_btn2:hover\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".tool_btn2:hover\", \"border\", \"1px solid #888\");\r\n    setStyle(\".tool_btn2:hover\", \"color\", \"#CCC\");\r\n    setStyle(\".field_btn:hover\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".field_btn:hover\", \"color\", \"#CCC\");\r\n    setStyle(\".tool_btn:active\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".tool_btn:active\", \"border\", \"1px solid #888\");\r\n    setStyle(\".tool_btn:active\", \"color\", \"#CCC\");\r\n    setStyle(\".tool_btn2:active\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".tool_btn2:active\", \"border\", \"1px solid #888\");\r\n    setStyle(\".tool_btn2:active\", \"color\", \"#CCC\");\r\n    setStyle(\".field_btn:active\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".field_btn:active\", \"color\", \"#CCC\");\r\n    setStyle(\"#mrtitle\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\"#mrbox\", \"backgroundColor\", \"#101010\");\r\n    setStyle(\".field_input\", \"backgroundColor\", \"#000\");\r\n    setStyle(\".field_input\", \"color\", \"#CCC\");\r\n    setStyle(\".btn\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".btn\", \"color\", \"#CCC\");\r\n    setStyle(\".btn:hover\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".btn:hover\", \"color\", \"#CCC\");\r\n    setStyle(\".btn:active\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".btn:active\", \"color\", \"#CCC\");\r\n    setStyle(\"closebox\", \"backgroundColor\", \"#101010\");\r\n    setStyle(\"closebox\", \"color\", \"#CCC\");\r\n    setStyle(\".list_group\", \"backgroundColor\", \"#202020\");\r\n    setStyle(\".list_group\", \"borderBottom\", \"\");\r\n    setStyle(\".list_group:hover\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".list_group:active\", \"backgroundColor\", \"#333\");\r\n    setStyle(\".image_list_collapsable\", \"backgroundColor\", \"#101010\");\r\n    setStyle(\".img_option_selected\", \"backgroundColor\", \"#444\");\r\n    setStyle(\".rightui\", \"borderLeft\", \"\");\r\n    setStyle(\".leftui\", \"borderRight\", \"\");\r\n    setStyle(\"::-webkit-scrollbar-thumb\", \"backgroundColor\", \"#888\");\r\n    setStyle(\"#rparams, #gui_objbox, #tools_box, #parambox\", \"scrollbarColor\", \"\");\r\n    setStyle(\"#rparams, #gui_objbox, #tools_box, #parambox\", \"scrollbarWidth\", \"\");\r\n    setStyle(\"#tools_box\", \"overflow-y\", \"hidden\");\r\n    setStyle(\"#tools_box\", \"overflow-y\", \"auto\");\r\n}\r\n\r\nfunction getObjectBox(obj) {\r\n    let x = 0;\r\n    let y = 0;\r\n    let w = obj.pm.w;\r\n    let h = obj.pm.h;\r\n\r\n    if (!\"box door region pushf bg water\".includes(obj._class)) {\r\n        x = bo_x[obj._class];\r\n        y = bo_y[obj._class];\r\n        w = bo_w[obj._class];\r\n        h = bo_h[obj._class];\r\n    }\r\n\r\n    if (\"player enemy\".includes(obj._class)) {\r\n        x = -15;\r\n        y = -81;\r\n        w = 30;\r\n        h = 80;\r\n    }\r\n\r\n    if (obj._class == \"vehicle\") {\r\n        x = bo_x[\"vehicle_\" + obj.pm.model];\r\n        y = bo_y[\"vehicle_\" + obj.pm.model];\r\n        w = bo_w[\"vehicle_\" + obj.pm.model];\r\n        h = bo_h[\"vehicle_\" + obj.pm.model];\r\n\r\n        if (obj.pm.model == \"veh_hh\") {\r\n            x = lo_x[\"alei_veh_hh\"];\r\n            y = lo_y[\"alei_veh_hh\"];\r\n            w = lo_w[\"alei_veh_hh\"];\r\n            h = lo_h[\"alei_veh_hh\"];\r\n        }\r\n    }\r\n\r\n    return {\r\n        x: x,\r\n        y: y,\r\n        w: w,\r\n        h: h\r\n    }\r\n}\r\n\r\nfunction getSelectionImage() {\r\n    let selection = getSelection();\r\n    let arr1 = [];\r\n    let arr2 = [];\r\n    let minX = +Infinity;\r\n    let minY = +Infinity;\r\n    let maxX = -Infinity;\r\n    let maxY = -Infinity;\r\n\r\n    for (let i = 0; i < selection.length; i++) {\r\n        let box = getObjectBox(selection[i]);\r\n        let x = selection[i].pm.x + box.x;\r\n        let y = selection[i].pm.y + box.y;\r\n        let w = box.w;\r\n        let h = box.h;\r\n\r\n        if (x < minX) {\r\n            minX = x;\r\n        }\r\n\r\n        if (x + w > maxX) {\r\n            maxX = x + w;\r\n        }\r\n\r\n        if (y < minY) {\r\n            minY = y;\r\n        }\r\n\r\n        if (y + h > maxY) {\r\n            maxY = y + h;\r\n        }\r\n    }\r\n\r\n    window.es = [];\r\n    for (let e of selection) {\r\n        es.push(e);\r\n    }\r\n\r\n\r\n\r\n    THEME = 4;\r\n    GRID_ALPHA = 0;\r\n    SHOW_CONNECTIONS = 0;\r\n    zoom = 1;\r\n    zoom_validate();\r\n\r\n    let sw = dis_to_x - dis_from_x;\r\n    let sh = dis_to_y - dis_from_y;\r\n\r\n    dis_from_x = minX - 10;\r\n    dis_from_y = minY - 10;\r\n    dis_to_x = minX + sw - 10;\r\n    dis_to_y = minY + sh - 10;\r\n\r\n    ConsoleTraceMessages = [];\r\n\r\n    Render();\r\n\r\n    let w = maxX - minX + 20;\r\n    let h = maxY - minY + 20;\r\n\r\n    aleiLog(DEBUG2, \"Before GID\");\r\n    let data = ctx.getImageData(0, 0, w, h);\r\n    aleiLog(DEBUG2, \"After GID\");\r\n\r\n    let canvas = document.createElement(\"canvas\");\r\n    let ctx2 = canvas.getContext(\"2d\");\r\n\r\n    let canvas2 = document.createElement(\"canvas\");\r\n    let ctx3 = canvas2.getContext(\"2d\");\r\n\r\n    canvas.width = w;\r\n    canvas.height = h;\r\n\r\n    ctx2.beginPath();\r\n    ctx2.putImageData(data, 0, 0);\r\n    ctx2.closePath();\r\n\r\n    let prevW = w;\r\n    let prevH = h;\r\n\r\n    if (w > 100 || h > 100) {\r\n        let divide = w / h;\r\n\r\n        if (divide >= 1) {\r\n            w = 100;\r\n            h = w / divide;\r\n        } else {\r\n            h = 100;\r\n            w = h * divide;\r\n        }\r\n    }\r\n\r\n    canvas2.width = w;\r\n    canvas2.height = h;\r\n\r\n    ctx3.beginPath();\r\n    ctx3.scale(w / prevW, h / prevH);\r\n    ctx3.drawImage(canvas, 0, 0);\r\n    ctx3.closePath();\r\n\r\n    let result = canvas2.toDataURL();\r\n\r\n    canvas.remove();\r\n    canvas = undefined;\r\n\r\n    return result;\r\n}\r\n\r\nfunction createClipboardDiv() {\r\n    let clipboardDiv = document.createElement(\"div\");\r\n    let mrdimlights = document.getElementById(\"mrdimlights\");\r\n\r\n    clipboardDiv.id = \"clipboardDiv\";\r\n    clipboardDiv.className = \"mrpopup\";\r\n    clipboardDiv.style = \"width: calc(100% - 280px); height: 100%; margin: 0px; padding: 0px; top: 50%; transform: translate(0px, -50%); display: none;\";\r\n\r\n    clipboardDiv.addEventListener(\"contextmenu\", e => {\r\n        e.preventDefault();\r\n    });\r\n\r\n    mrdimlights.addEventListener(\"click\", e => {\r\n        clipboardDiv.style.display = \"none\";\r\n    });\r\n\r\n    document.body.append(clipboardDiv);\r\n}\r\n\r\nfunction clipboardItemAction(i) {\r\n    let items = JSON.parse(localStorage.clipboardItems);\r\n    let action = confirm(\"Rename (OK) or delete (Cancel) ?\");\r\n\r\n    if (action) {\r\n        let name = prompt(\"Enter name:\", items[i].name);\r\n\r\n        if (name) {\r\n            items[i].name = name;\r\n\r\n            localStorage.clipboardItems = JSON.stringify(items);\r\n\r\n            updateClipboardDiv();\r\n        }\r\n    } else {\r\n        if (confirm(\"Are you sure you want to delete?\")) {\r\n            items.splice(i, 1);\r\n\r\n            localStorage.clipboardItems = JSON.stringify(items);\r\n\r\n            updateClipboardDiv();\r\n        }\r\n    }\r\n}\r\n\r\nfunction registerClipboardItemAction() {\r\n    window.clipboardItemAction = clipboardItemAction;\r\n    aleiLog(DEBUG, \"Registered Clipboard Item Action\");\r\n}\r\n\r\nfunction updateClipboardDiv() {\r\n    if (!localStorage.clipboardItems) {\r\n        localStorage.clipboardItems = \"[]\";\r\n    }\r\n\r\n    let items = JSON.parse(localStorage.clipboardItems);\r\n    let clipboardDiv = document.getElementById(\"clipboardDiv\");\r\n    let mrdimlights = document.getElementById(\"mrdimlights\");\r\n\r\n    clipboardDiv.style.display = \"block\";\r\n    mrdimlights.style.display = \"block\";\r\n\r\n    let html = `\r\n\t\t<div id=\"mrtitle\">\r\n\t\t\t<span>Object clipboard</span>\r\n\t\t\t<closebox onclick=\"document.getElementById('clipboardDiv').style.display = 'none'; document.getElementById('mrdimlights').style.display = 'none';\">x</closebox>\r\n\t\t</div>\r\n\r\n\t\t<div id=\"mrbox\" class=\"objbox\" style=\"height: calc(100% - 32px); box-sizing: border-box;\">\r\n\t`;\r\n\r\n    let originalES = window.es;\r\n    let cs = {} // CS: Current Settings, because we will change settings for rendering images\r\n    cs.theme = THEME;\r\n    cs.grid_opacity = GRID_ALPHA;\r\n    cs.showConnections = SHOW_CONNECTIONS;\r\n    //\r\n    cs.dtx = dis_to_x;\r\n    cs.dty = dis_to_y;\r\n    //\r\n    cs.dfx = dis_from_x;\r\n    cs.dfy = dis_from_y;\r\n    //\r\n    cs.ctm = ConsoleTraceMessages;\r\n    cs.zoom = zoom;\r\n\r\n    window.es = [];\r\n    for (let i = 0; i < items.length; i++) {\r\n        __pasteObjectClipboard(items[i]);\r\n        html += `\r\n\t\t\t<div class=\"img_option\" style=\"width: auto;\" oncontextmenu=\"clipboardItemAction(` + i + `)\" onclick=\"pasteFromPermanentClipboard(` + i + `);\">\r\n\t\t\t\t<img src=\"` + getSelectionImage() + `\" style=\"max-width: 100px; max-height: 100px;\">\r\n\t\t\t\t<div>` + items[i].name + `</div>\r\n\t\t\t</div>\r\n\t\t`;\r\n    }\r\n\r\n    clipboardDiv.innerHTML = html + \"</div>\";\r\n    window.es = originalES;\r\n    THEME = cs.theme;\r\n    GRID_ALPHA = cs.grid_opacity;\r\n    SHOW_CONNECTIONS = cs.showConnections;\r\n    dis_to_x = cs.dtx;\r\n    dis_to_y = cs.dty;\r\n    dis_from_x = cs.dfx;\r\n    dis_from_y = cs.dfy;\r\n    ConsoleTraceMessages = cs.ctm;\r\n    zoom = cs.zoom;\r\n    need_redraw = 1;\r\n    zoom_validate();\r\n}\r\n\r\nfunction __pasteObjectClipboard(item) {\r\n    sessionStorage.permanent_clipboard = item.data;\r\n    PasteFromClipBoard(\"permanent_clipboard\");\r\n}\r\n\r\nfunction pasteFromPermanentClipboard(i) {\r\n    let items = JSON.parse(localStorage.clipboardItems);\r\n\r\n    sessionStorage.permanent_clipboard = items[i].data;\r\n\r\n    PasteFromClipBoard(\"permanent_clipboard\");\r\n\r\n    let clipboardDiv = document.getElementById(\"clipboardDiv\");\r\n    let mrdimlights = document.getElementById(\"mrdimlights\");\r\n\r\n    clipboardDiv.style.display = \"none\";\r\n    mrdimlights.style.display = \"none\";\r\n\r\n    NewNote(\"Objects pasted from permanent clipboard.\", note_passive);\r\n}\r\n\r\nfunction copyToPermanentClipboard() {\r\n    try {\r\n        let selection = getSelection();\r\n\r\n        if (selection.length != 0) {\r\n            CopyToClipBoard(\"permanent_clipboard\");\r\n\r\n            let items = JSON.parse(localStorage.clipboardItems);\r\n\r\n            items.push({\r\n                name: \"Selection\",\r\n                data: sessionStorage.permanent_clipboard\r\n            });\r\n\r\n            localStorage.clipboardItems = JSON.stringify(items);\r\n\r\n            NewNote(\"Objects copied to permanent clipboard.\", note_passive);\r\n        } else {\r\n            updateClipboardDiv();\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        NewNote(\"Can't copy objects to permanent clipboard.<br>LocalStorage error?\", note_bad);\r\n    }\r\n}\r\n\r\nfunction changeTopRightText() {\r\n    let containerElem = document.getElementById(\"version_rights\");\r\n    let elem = containerElem.childNodes[0];\r\n\r\n    containerElem.style.width = \"170px\";\r\n    elem.style.width = \"160px\";\r\n\r\n    elem.innerHTML = \"Plazma Burst 2 Level Editor v1.4<br>ALE Improvements v\" + GM_info.script.version;\r\n}\r\n\r\nfunction sortObjects() {\r\n    es.sort((a, b) => a.pm.__zIndex - b.pm.__zIndex);\r\n}\r\n\r\nfunction addDecorButtons() {\r\n    let rparams = document.getElementById(\"rparams\");\r\n    let selection = getSelection();\r\n\r\n    if (rparams && selection.length == 1) {\r\n        let getImageSize_button = '<a onclick=\"getImageSize();\" class=\"tool_btn tool_wid\" style=\"display: block; width: 100%; margin-top: 4px;\">Get image size</a>';\r\n        let centerDecorationX_button = '<a onclick=\"centerImageX();\" class=\"tool_btn tool_wid\" style=\"display: block; width: 100%; margin-top: 4px;\">Center decoration X</a>';\r\n        let centerDecorationY_button = '<a onclick=\"centerImageY();\" class=\"tool_btn tool_wid\" style=\"display: block; width: 100%; margin-top: 4px;\">Center decoration Y</a>';\r\n\r\n        if (selection[0]._class == \"bg\") {\r\n            rparams.innerHTML += getImageSize_button;\r\n        }\r\n\r\n        if (selection[0]._class == \"decor\") {\r\n            rparams.innerHTML += getImageSize_button;\r\n            rparams.innerHTML += centerDecorationX_button;\r\n            rparams.innerHTML += centerDecorationY_button;\r\n        }\r\n    }\r\n}\r\n\r\nfunction getImageSize() {\r\n    let selection = getSelection();\r\n    let id;\r\n\r\n    if (selection[0]._class == \"bg\") {\r\n        id = selection[0].pm.m;\r\n    }\r\n\r\n    if (selection[0]._class == \"decor\") {\r\n        id = selection[0].pm.model;\r\n    }\r\n\r\n    if (typeof id == \"string\") {\r\n        let img = document.createElement(\"img\");\r\n\r\n        img.onload = function() {\r\n            let w = img.width;\r\n            let h = img.height;\r\n\r\n            img.remove();\r\n\r\n            alert(\"W: \" + w + \"\\nH: \" + h);\r\n        }\r\n\r\n        img.onerror = function() {\r\n            img.remove();\r\n\r\n            alert(\"Image not found.\");\r\n        }\r\n\r\n        img.src = \"https://www.plazmaburst2.com/mimage_cache.php?image_id=\" + id.slice(1);\r\n    } else {\r\n        alert(\"Image not found.\");\r\n    }\r\n}\r\n\r\nfunction getImageData() {\r\n    return new Promise((res, err) => {\r\n        let selection = getSelection();\r\n        let id;\r\n\r\n        if (selection[0]._class == \"bg\") {\r\n            id = selection[0].pm.m;\r\n        }\r\n\r\n        if (selection[0]._class == \"decor\") {\r\n            id = selection[0].pm.model;\r\n        }\r\n\r\n        if (typeof id == \"string\") {\r\n            let img = document.createElement(\"img\");\r\n\r\n            img.onload = function() {\r\n                let w = img.width;\r\n                let h = img.height;\r\n\r\n                let canvas = document.createElement(\"canvas\");\r\n                let ctx = canvas.getContext(\"2d\");\r\n\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                ctx.beginPath();\r\n                ctx.drawImage(img, 0, 0);\r\n                ctx.closePath();\r\n\r\n                res([ctx.getImageData(0, 0, w, h).data, w]);\r\n            }\r\n\r\n            img.onerror = function() {\r\n                img.remove();\r\n\r\n                alert(\"Image not found.\");\r\n\r\n                res(1);\r\n            }\r\n\r\n            img.src = \"https://www.plazmaburst2.com/mimage_cache.php?image_id=\" + id.slice(1);\r\n        } else {\r\n            alert(\"Image not found.\");\r\n\r\n            res(1);\r\n        }\r\n    });\r\n}\r\n\r\nfunction arrMin(arr) {\r\n    let min = Infinity;\r\n\r\n    for (let i = 0; i < arr.length; i++) {\r\n        if (arr[i] < min) {\r\n            min = arr[i];\r\n        }\r\n    }\r\n\r\n    return min;\r\n}\r\n\r\nfunction arrMax(arr) {\r\n    let max = -Infinity;\r\n\r\n    for (let i = 0; i < arr.length; i++) {\r\n        if (arr[i] > max) {\r\n            max = arr[i];\r\n        }\r\n    }\r\n\r\n    return max;\r\n}\r\n\r\nfunction getImagePosition(data, w) {\r\n    let arrX = [];\r\n    let arrY = [];\r\n\r\n    let minX;\r\n    let minY;\r\n    let maxX;\r\n    let maxY;\r\n\r\n    let centerX = 0;\r\n    let centerY = 0;\r\n\r\n    if (data != 1) {\r\n        for (let i = 0; i < data.length; i += 4) {\r\n            if (data[i + 3] >= 3) {\r\n                let x = (i / 4) % w;\r\n                let y = Math.floor(i / 4 / w);\r\n\r\n                arrX.push(x);\r\n                arrY.push(y);\r\n            }\r\n        }\r\n\r\n        minX = arrMin(arrX);\r\n        minY = arrMin(arrY);\r\n        maxX = arrMax(arrX);\r\n        maxY = arrMax(arrY);\r\n\r\n        centerX = (minX + maxX) / 2;\r\n        centerY = (minY + maxY) / 2;\r\n    }\r\n\r\n    return {\r\n        x: centerX,\r\n        y: centerY\r\n    }\r\n}\r\n\r\nfunction setDecorOffset(x, y) {\r\n    let selection = getSelection();\r\n\r\n    selection[0].pm.u = x;\r\n    selection[0].pm.v = y;\r\n}\r\n\r\nfunction centerImageX() {\r\n    let selection = getSelection();\r\n\r\n    if (selection.length == 1) {\r\n        if (selection[0]._class == \"decor\") {\r\n            getImageData().then(res => {\r\n                if (res != 1) {\r\n                    let center = getImagePosition(res[0], res[1]);\r\n                    let x = center.x;\r\n\r\n                    setDecorOffset(-x, selection[0].pm.v);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    need_redraw = 1;\r\n    need_GUIParams_update = 1;\r\n}\r\n\r\nfunction centerImageY() {\r\n    let selection = getSelection();\r\n\r\n    if (selection.length == 1) {\r\n        if (selection[0]._class == \"decor\") {\r\n            getImageData().then(res => {\r\n                if (res != 1) {\r\n                    let center = getImagePosition(res[0], res[1]);\r\n                    let y = center.y;\r\n\r\n                    setDecorOffset(selection[0].pm.u, -y);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    need_redraw = 1;\r\n    need_GUIParams_update = 1;\r\n}\r\n\r\nfunction imageFunctions() {\r\n    window.getImageSize = getImageSize;\r\n    window.centerImageX = centerImageX;\r\n    window.centerImageY = centerImageY;\r\n}\r\n\r\nlet newUpdate = 0;\r\n\r\nlet targetElement;\r\n\r\ndocument.addEventListener(\"mousedown\", e => {\r\n    targetElement = e.target;\r\n});\r\n\r\ndocument.addEventListener(\"keydown\", e => {\r\n    if (e.ctrlKey && e.code == \"KeyS\") {\r\n        e.preventDefault();\r\n        document.getElementsByClassName(\"field_btn\")[0].click();\r\n    }\r\n\r\n    if (e.ctrlKey && e.code == \"KeyF\") {\r\n        e.preventDefault();\r\n\r\n        let name = prompt(\"Find objects:\", \"\");\r\n\r\n        if (name !== null && name !== \"\") {\r\n            let notFound = findObjects(name);\r\n\r\n            if (notFound) {\r\n                alert(\"Nothing found.\");\r\n            }\r\n        }\r\n    }\r\n\r\n    if (e.code == \"KeyR\" && targetElement != \"[object HTMLInputElement]\" && targetElement.id != \"opcode_field\") {\r\n        if (!isOnlyTriggerSelected()) {\r\n            rotateObjects();\r\n        }\r\n    }\r\n\r\n    if (e.ctrlKey && e.code == \"KeyR\") {\r\n        if (isOnlyTriggerSelected() && !isNothingSelected()) {\r\n            e.preventDefault();\r\n\r\n            reverseTriggerActions();\r\n            unselectTriggerActions();\r\n        }\r\n    }\r\n\r\n    if ((e.code == \"Minus\" || e.code == \"NumpadSubtract\") && e.ctrlKey && canvas_focus) {\r\n        e.preventDefault();\r\n\r\n        zoom *= 2;\r\n        zoom_validate();\r\n        need_redraw = 1;\r\n    }\r\n\r\n    if ((e.code == \"Equal\" || e.code == \"NumpadAdd\") && e.ctrlKey && canvas_focus) {\r\n        e.preventDefault();\r\n\r\n        zoom *= 0.5;\r\n        zoom_validate();\r\n        need_redraw = 1;\r\n    }\r\n\r\n    if (e.ctrlKey && e.altKey) {\r\n        e.preventDefault();\r\n\r\n        zoom = 1;\r\n        zoom_validate();\r\n        need_redraw = 1;\r\n    }\r\n\r\n    if (e.code == \"KeyH\" && e.ctrlKey) {\r\n        e.preventDefault();\r\n\r\n        if (targetElement.id === \"opcode_field\") {\r\n            let value = targetElement.value;\r\n\r\n            let str1 = prompt(\"Enter string to replace from:\", \"\");\r\n            if (!str1) return;\r\n\r\n            let str2 = prompt(\"Enter string to replace to:\", str1);\r\n            if (!str2) return;\r\n\r\n            targetElement.value = value.replaceAll(str1, str2);\r\n        }\r\n    }\r\n\r\n    if (e.code == \"Enter\" && targetElement != \"[object HTMLInputElement]\" && targetElement.id != \"opcode_field\" && canvas_focus) {\r\n        let selected = getSelection();\r\n\r\n        if (selected.length != 0) {\r\n            let param = prompt(\"Enter parameter name:\", \"\");\r\n\r\n            if (param) {\r\n                let expression = prompt(\"Enter expression:\", \"\");\r\n\r\n                if (expression) {\r\n                    param = param.toLowerCase().replace(\"width\", \"w\").replace(\"height\", \"h\");\r\n\r\n                    for (let i = 0; i < selected.length; i++) {\r\n                        let x = selected[i].pm.x;\r\n                        let y = selected[i].pm.y;\r\n                        let w = selected[i].pm.w;\r\n                        let h = selected[i].pm.h;\r\n\r\n                        if (x === undefined) {\r\n                            x = 0;\r\n                        }\r\n\r\n                        if (y === undefined) {\r\n                            y = 0;\r\n                        }\r\n\r\n                        if (w === undefined) {\r\n                            w = 0;\r\n                        }\r\n\r\n                        if (h === undefined) {\r\n                            h = 0;\r\n                        }\r\n\r\n                        if (selected[i].pm[param] !== undefined) {\r\n                            let parsed = alescriptParse(expression, [x, y, w, h, i]);\r\n\r\n                            if (typeof parsed == \"number\") {\r\n                                for (let j = 0; j < selected.length; j++) {\r\n                                    selected[j].selected = 0;\r\n                                }\r\n\r\n                                selected[i].selected = 1;\r\n\r\n                                UpdatePhysicalParam(param, parsed);\r\n                            }\r\n\r\n                            for (let j = 0; j < selected.length; j++) {\r\n                                selected[j].selected = 1;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    need_GUIParams_update = 1;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if (e.altKey) {\r\n        e.preventDefault();\r\n    }\r\n\r\n    if (e.altKey && targetElement == \"[object HTMLInputElement]\") {\r\n        let selected = getSelection();\r\n\r\n        if (selected.length == 1) {\r\n            let x = selected[0].pm.x;\r\n            let y = selected[0].pm.y;\r\n            let w = selected[0].pm.w;\r\n            let h = selected[0].pm.h;\r\n\r\n            if (x === undefined) {\r\n                x = 0;\r\n            }\r\n\r\n            if (y === undefined) {\r\n                y = 0;\r\n            }\r\n\r\n            if (w === undefined) {\r\n                w = 0;\r\n            }\r\n\r\n            if (h === undefined) {\r\n                h = 0;\r\n            }\r\n\r\n            // i is undefined and i'm pretty sure it's not supposed to be like that. so this definitely doesn't work how it should.\r\n            // i'll just leave it cuz idk how it's supposed to be and it doesn't throw an error because of some implicit globals from vanilla ale\r\n            let parsed = alescriptParse(targetElement.value, [x, y, w, h, i]);\r\n\r\n            if (typeof parsed == \"number\") {\r\n                targetElement.value = parsed;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (e.ctrlKey && e.code == \"KeyP\") {\r\n        e.preventDefault();\r\n\r\n        copyToPermanentClipboard();\r\n    }\r\n\r\n    if (e.ctrlKey && e.shiftKey) {\r\n        if (newUpdate) {\r\n            let wnd = new Object();\r\n\r\n            window.onblur = function() {\r\n                setTimeout(() => {\r\n                    wnd.close();\r\n                }, 1000);\r\n            }\r\n\r\n            window.onfocus = function() {\r\n                location.reload();\r\n            }\r\n\r\n            wnd = window.open(\"https://github.com/LisABC/ALEI/raw/main/alei.user.js\");\r\n        }\r\n    }\r\n});\r\n\r\nfunction doTooltip() {\r\n    let tooltip = document.createElement(\"p\");\r\n\r\n    tooltip.style.fontSize = \"16px\";\r\n    tooltip.style.fontFamily = \"monospace\";\r\n    tooltip.style.color = \"#eee\";\r\n    tooltip.style.backgroundColor = \"#000\";\r\n    tooltip.style.padding = \"10px\";\r\n    tooltip.style.width = \"fit-content\";\r\n    tooltip.style.borderRadius = \"4px\";\r\n    tooltip.style.wordBreak = \"break-all\";\r\n    tooltip.style.position = \"absolute\";\r\n    tooltip.style.left = \"100px\";\r\n    tooltip.style.top = \"-100px\";\r\n\r\n    document.body.append(tooltip);\r\n\r\n    document.addEventListener(\"mousemove\", e => {\r\n        if (e.target.title) {\r\n            e.target.dataset.title = e.target.title;\r\n            e.target.title = \"\";\r\n        }\r\n\r\n        if (e.target.parentElement.title) {\r\n            e.target.parentElement.dataset.title = e.target.parentElement.title;\r\n            e.target.parentElement.title = \"\";\r\n        }\r\n        let leftOffset = 150\r\n\r\n        if (e.target.dataset.title) {\r\n            let to = e.target.dataset.title.length\r\n            tooltip.style.left = to + leftOffset + e.clientX + 20 + \"px\";\r\n            tooltip.innerHTML = e.target.dataset.title;\r\n\r\n            if (tooltip.getBoundingClientRect().height != 31) {\r\n                tooltip.style.left = to + leftOffset + e.clientX - 20 - tooltip.getBoundingClientRect().width + \"px\";\r\n            }\r\n        } else if (e.target.parentElement.dataset.title) {\r\n            let to = e.target.parentElement.dataset.title.length\r\n            tooltip.style.left = to + leftOffset + e.clientX + 20 + \"px\";\r\n            tooltip.style.top = e.clientY + \"px\";\r\n            tooltip.innerHTML = e.target.parentElement.dataset.title;\r\n\r\n            if (tooltip.getBoundingClientRect().height != 31) {\r\n                tooltip.style.left = to + leftOffset + e.clientX - 20 - tooltip.getBoundingClientRect().width + \"px\";\r\n            }\r\n        } else {\r\n            tooltip.style.left = -100 + leftOffset + \"px\";\r\n            tooltip.style.top = \"-100px\";\r\n        }\r\n    });\r\n    aleiLog(DEBUG, \"Added tooltip.\")\r\n}\r\n\r\nfunction patchDecorUpload() {\r\n    // Allows for multiple uploads.\r\n    let imageLoader = $id(\"imageLoader\");\r\n    // First we make it allow multiple files and remove original event listener.\r\n    imageLoader.setAttribute(\"multiple\", true);\r\n    imageLoader.removeEventListener(\"change\", handleImage);\r\n    // Then we register our own.\r\n    imageLoader.addEventListener(\"change\", function(e) {\r\n        let files = e.target.files;\r\n        NewNote(`ALEI: Will upload ${files.length} bg/decor(s).`, \"#2595FF\");\r\n        for (let file of files) {\r\n            let arg = {target: {files: [file]}};\r\n            handleImage(arg); // Call original function\r\n        }\r\n    }, false)\r\n}\r\n\r\nfunction setParameter(index, value) {\r\n    let rightParams = document.getElementById(\"rparams\");\r\n\r\n    if (index < rightParams.childNodes.length) {\r\n        rightParams.childNodes[index].childNodes[1].innerHTML = value;\r\n    }\r\n}\r\n\r\nfunction getSelection() {\r\n    let objects = [];\r\n\r\n    for (let i = 0; i < es.length; i++) {\r\n        if (es[i].selected && es[i].exists) {\r\n            objects.push(es[i]);\r\n        }\r\n    }\r\n\r\n    return objects;\r\n}\r\n\r\nfunction areObjectsOfSameType(objects) {\r\n    let same = 1;\r\n\r\n    for (let i = 0; i < objects.length; i++) {\r\n        if (objects[i]._class != objects[0]._class) {\r\n            same = 0;\r\n        }\r\n    }\r\n\r\n    return same;\r\n}\r\n\r\nfunction removeSameItems(array) {\r\n    return Array.from(new Set(array));\r\n}\r\n\r\nfunction removeItems(array, items) {\r\n    let copy = JSON.parse(JSON.stringify(array));\r\n\r\n    for (let i = 0; i < items.length; i++) {\r\n        copy.splice(copy.indexOf(items[i]), 1);\r\n    }\r\n\r\n    return copy;\r\n}\r\n\r\nfunction parameterNamesToIndexes(parameters, objectParameters) {\r\n    let indexes = [];\r\n\r\n    for (let i = 0; i < parameters.length; i++) {\r\n        indexes.push(objectParameters.indexOf(parameters[i]));\r\n    }\r\n\r\n    return indexes;\r\n}\r\n\r\nfunction getSameParameters(objects) {\r\n    let differentParameters = [];\r\n    let parameters = Object.keys(objects[0].pm);\r\n\r\n    for (let i = 0; i < objects.length; i++) {\r\n        for (let j = 0; j < parameters.length; j++) {\r\n            if (objects[i].pm[parameters[j]] != objects[0].pm[parameters[j]]) {\r\n                differentParameters.push(parameters[j]);\r\n            }\r\n        }\r\n    }\r\n\r\n    differentParameters = removeSameItems(differentParameters);\r\n    differentParameters = removeItems(parameters, differentParameters);\r\n\r\n    return parameterNamesToIndexes(differentParameters, parameters);\r\n}\r\n\r\nfunction toBoolean(str) {\r\n    if (isNaN(Number(str))) {\r\n        return str == \"true\";\r\n    } else {\r\n        return Boolean(str);\r\n    }\r\n}\r\n\r\nfunction fixIndex(index, objectType) {\r\n    let fixedIndex = index;\r\n\r\n    if (objectType == \"trigger\") {\r\n        if (index > 4) {\r\n            fixedIndex = index + Math.floor((index - 2) / 3);\r\n        }\r\n    }\r\n\r\n    return fixedIndex;\r\n}\r\n\r\nconst parameterMap = {\r\n    \"box\": {\"m\": \"box_model\"},\r\n    \"door\": {\r\n        \"moving\": \"bool\",\r\n        \"vis\": \"bool\"\r\n    },\r\n    \"region\": {\"use_on\": \"region_activation\"},\r\n    \"decor\": {\r\n        \"f\": \"draw_in_front\",\r\n        \"model\": \"decor_model\"\r\n    },\r\n    \"bg\": {\r\n        \"s\": \"bool\",\r\n        \"f\": \"draw_in_front\",\r\n        \"m\": \"bg_model\"\r\n    },\r\n    \"water\": {\"friction\": \"bool\"},\r\n    \"trigger\": {\"enabled\": \"bool\"},\r\n    \"timer\": {\"enabled\": \"bool\"},\r\n    \"gun\": {\r\n        \"command\": \"team+any\",\r\n        \"upg\": \"gun_upgrade\",\r\n        \"model\": \"gun_model\"\r\n    },\r\n    \"barrel\": {\"model\": \"barrel_model\"},\r\n    \"lamp\": {\"flare\": \"bool\"},\r\n    \"vehicle\": {\"model\": \"vehicle_model\"}\r\n}\r\n\r\nfunction fixParameterValue(name, value, objectType) {\r\n    let fixedValue;\r\n\r\n    if (VAL_TABLE[name]) {\r\n        fixedValue = VAL_TABLE[name][value];\r\n    } else {\r\n        if (parameterMap[objectType] && parameterMap[objectType][name]) {\r\n            fixedValue = VAL_TABLE[ parameterMap[objectType][name] ][value];\r\n        }else if (name.slice(0, 8) == \"actions_\" && name.slice(-5) == \"_type\") {\r\n            fixedValue = VAL_TABLE[\"trigger_type\"][value];\r\n        }else {\r\n            fixedValue = value;\r\n        }\r\n    }\r\n\r\n    return fixedValue;\r\n}\r\n\r\nfunction setSameParameters() {\r\n    let objects = getSelection();\r\n\r\n    if (areObjectsOfSameType(objects) && objects.length >= 2) {\r\n        let indexes = getSameParameters(objects);\r\n        let parameters = Object.keys(objects[0].pm);\r\n\r\n        for (let i = 0; i < indexes.length; i++) {\r\n            let name = parameters[indexes[i]];\r\n            let value = objects[0].pm[parameters[indexes[i]]];\r\n            let objectType = objects[0]._class;\r\n\r\n            setParameter(fixIndex(indexes[i], objectType), fixParameterValue(name, value, objectType));\r\n        }\r\n    }\r\n}\r\n\r\nfunction assignObjectIDs() {\r\n    if (!aleiSettings.showIDs) return;\r\n    let idmap = {};\r\n    for (let element of es) {\r\n        if (!element.exists) continue;\r\n        if (idmap[element._class] === undefined) idmap[element._class] = -1;\r\n\r\n        idmap[element._class] += 1;\r\n        element.aleiID = idmap[element._class];\r\n    }\r\n}\r\n\r\nfunction assignZIndex() {\r\n    for (let i = 0; i < es.length; i++) {\r\n        if (es[i].pm.__zIndex === undefined) {\r\n            es[i].pm.__zIndex = 1;\r\n        }\r\n    }\r\n}\r\n\r\nfunction patchANI() {\r\n    let oldAni = ani;\r\n    window.ani = function() {\r\n        let ngpu = need_GUIParams_update;\r\n        oldAni();\r\n        if (ngpu) {\r\n            assignObjectIDs();\r\n            assignZIndex();\r\n            if (aleiSettings.showSameParameters) {\r\n                setSameParameters();;\r\n            }\r\n        }\r\n    }\r\n    aleiLog(DEBUG, \"Patched ANI\");\r\n}\r\n\r\n///////////////////////////////\r\n\r\nfunction updateBoxSplitterSize() {\r\n    let obj = $id(\"gui_objbox\");\r\n    let rect = obj.getBoundingClientRect();\r\n    let style = splitter2.style;\r\n    style.setProperty(\"width\", rect.width);\r\n    style.setProperty(\"left\", rect.x);\r\n    style.setProperty(\"top\", rect.bottom);\r\n}\r\n\r\nfunction addObjBoxResize() {\r\n    let obj = $id(\"gui_objbox\");\r\n    let splitter = document.createElement(\"div\");\r\n    window.splitter2 = splitter;\r\n    let style = splitter.style;\r\n    $id(\"floattag\").appendChild(splitter);\r\n\r\n    style.setProperty(\"position\", \"absolute\");\r\n    style.setProperty(\"height\", \"5px\");\r\n    style.setProperty(\"cursor\", \"s-resize\");\r\n\r\n    updateBoxSplitterSize();\r\n\r\n    let splitterClicking = false;\r\n    splitter.onmousedown = ((e) => {splitterClicking = true});\r\n    ROOT_ELEMENT.addEventListener(\"mouseup\", (e) => {splitterClicking = false});\r\n    ROOT_ELEMENT.addEventListener(\"mousemove\", (e) => {\r\n        if (!splitterClicking) return;\r\n\r\n        let new_height = e.clientY - 90;\r\n        obj.style.height = new_height;\r\n        updateBoxSplitterSize();\r\n        ShowHideObjectBox();\r\n        ShowHideObjectBox();\r\n    });\r\n    aleiLog(DEBUG, \"Added splitter for object box.\");\r\n}\r\n\r\nfunction patch_m_down() {\r\n    let og_mdown = window.m_down;\r\n    window.m_down = function(e) {\r\n        let previousEsLength = es.length;\r\n        og_mdown(e);\r\n        if (es.length > previousEsLength) { // New element is made.\r\n            assignObjectIDs();\r\n            assignZIndex();\r\n            sortObjects();\r\n            let element = es[es.length - 1];\r\n            if (!(\"x\" in element.pm)) return;\r\n            // We now have to do job of fixPos, we cannot set fixPos to have it argument-based directly because of scoping\r\n            // So we have to do it ourselves.\r\n            let pm = element.pm;\r\n            let round = function(num) {\r\n                return Math.round(num / GRID_SNAPPING) * GRID_SNAPPING\r\n            }\r\n            pm.x = round(pm.x);\r\n            pm.y = round(pm.y);\r\n            if (element._isresizable) {\r\n                pm.w = round(pm.w);\r\n                pm.h = round(pm.h);\r\n            }\r\n            // Now we just update.\r\n            window.need_GUIParams_update = true;\r\n            UpdateGUIObjectsList();\r\n        }\r\n    }\r\n}\r\n\r\nfunction patchEntityClass() {\r\n    let og_E = E;\r\n    window.E = function(_class) {\r\n        let result = new og_E(_class);\r\n        // Adding property.\r\n        if(_class == \"water\") result.pm.attach = -1;\r\n        else if(_class == \"decor\") result.pm.text = \"Hello World!\";\r\n        else if(_class == \"trigger\") {\r\n            let entries = Object.entries(result.pm);\r\n            entries.splice(5, 0, [\"execute\", false]);\r\n            result.pm = Object.fromEntries(entries);\r\n        }\r\n        else if(_class == \"region\") result.pm.uses_timer = false;\r\n\r\n        result.fixPos = function() {}; // For proper snapping.\r\n        return result;\r\n    }\r\n    aleiLog(DEBUG, \"Patched entity.\");\r\n}\r\n\r\nfunction PasteFromClipBoard(ClipName) {\r\n    var clipboard = new Object();\r\n    if (sessionStorage[ClipName] == undefined) {\r\n        return false;\r\n    }\r\n    clipboard = unserialize(sessionStorage[ClipName]);\r\n    lcz();\r\n    for (let i = 0; i < es.length; i++)\r\n        if (es[i].exists) {\r\n            if (es[i].selected) {\r\n                ldn('es[' + i + '].selected=false;');\r\n                lnd('es[' + i + '].selected=true;');\r\n                es[i].selected = false;\r\n            }\r\n        } var min_x = 0;\r\n    var max_x = 0;\r\n    var min_y = 0;\r\n    var max_y = 0;\r\n    let i = 0;\r\n    var from_obj = es.length;\r\n    while (typeof(clipboard[i]) !== 'undefined') {\r\n        var newparam = es.length;\r\n        ldn('es[' + newparam + '].exists=true;');\r\n        lnd('es[' + newparam + '].exists=false;');\r\n        es[newparam] = new E(clipboard[i]._class);\r\n        for (let param in clipboard[i]) {\r\n            es[newparam][param] = clipboard[i][param];\r\n        }\r\n        if (typeof(es[newparam].pm.x) !== 'undefined')\r\n            if (typeof(es[newparam].pm.y) !== 'undefined') {\r\n                if (i == 0) {\r\n                    min_x = es[newparam].pm.x;\r\n                    min_y = es[newparam].pm.y;\r\n                    max_x = es[newparam].pm.x;\r\n                    max_y = es[newparam].pm.y;\r\n                    if (typeof(es[newparam].pm.w) !== 'undefined')\r\n                        if (typeof(es[newparam].pm.h) !== 'undefined') {\r\n                            min_x += es[newparam].pm.w / 2;\r\n                            max_x += es[newparam].pm.w / 2;\r\n                            min_y += es[newparam].pm.h / 2;\r\n                            max_y += es[newparam].pm.h / 2;\r\n                        }\r\n                } else {\r\n                    min_x = Math.min(min_x, es[newparam].pm.x);\r\n                    min_y = Math.min(min_y, es[newparam].pm.y);\r\n                    max_x = Math.max(max_x, es[newparam].pm.x);\r\n                    max_y = Math.max(max_y, es[newparam].pm.y);\r\n                    if (typeof(es[newparam].pm.w) !== 'undefined')\r\n                        if (typeof(es[newparam].pm.h) !== 'undefined') {\r\n                            max_x = Math.max(max_x, es[newparam].pm.x + es[newparam].pm.w);\r\n                            max_y = Math.max(max_y, es[newparam].pm.y + es[newparam].pm.h);\r\n                        }\r\n                }\r\n            } i++;\r\n    }\r\n    ldn('m_drag_selected=true;');\r\n    ldn('paint_draw_mode=true;');\r\n    ldn('quick_pick_ignore_one_click=true;');\r\n    lnd('m_drag_selected=false;');\r\n    lnd('paint_draw_mode=false;');\r\n    lnd('quick_pick_ignore_one_click=false;');\r\n    ldis = true;\r\n    paint_draw_mode = true;\r\n    quick_pick_ignore_one_click = true;\r\n    lmdrwa = lmwa;\r\n    lmdrwb = lmwb;\r\n    // Original code by Prosu\r\n    let m_pos_x = lmwa;\r\n    let m_pos_y = lmwb;\r\n\r\n    m_drag_x = mouse_x;\r\n    m_drag_y = mouse_y;\r\n    let m_down_x = m_pos_x;\r\n    let m_down_y = m_pos_y;\r\n    var x1 = Math.round((m_pos_x) / GRID_SNAPPING) * GRID_SNAPPING;\r\n    var y1 = Math.round((m_pos_y) / GRID_SNAPPING) * GRID_SNAPPING;\r\n    var lo_x = Math.round((x1 - (min_x + max_x) / 2) / GRID_SNAPPING) * GRID_SNAPPING;\r\n    var lo_y = Math.round((y1 - (min_y + max_y) / 2) / GRID_SNAPPING) * GRID_SNAPPING;\r\n\r\n    for (var i2 = from_obj; i2 < es.length; i2++) {\r\n        if (typeof(es[i2].pm.uid) !== 'undefined') {\r\n            var old_uid = es[i2].pm.uid;\r\n            es[i2].exists = false;\r\n            es[i2].pm.uid = RandomizeName(es[i2].pm.uid);\r\n            es[i2].exists = true;\r\n            for (var i3 = from_obj; i3 < es.length; i3++) {\r\n                for (let param in es[i3].pm) {\r\n                    if (typeof(es[i3].pm[param]) == 'string') {\r\n                        if (es[i3].pm[param] == old_uid) {\r\n                            es[i3].pm[param] = es[i2].pm.uid;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (typeof(es[i2].pm.x) !== 'undefined')\r\n            if (typeof(es[i2].pm.y) !== 'undefined') {\r\n                lnd('es[' + i2 + '].pm.x=' + es[i2].pm.x + ';');\r\n                lnd('es[' + i2 + '].pm.y=' + es[i2].pm.y + ';');\r\n                es[i2].pm.x += lo_x;\r\n                es[i2].pm.y += lo_y;\r\n                es[i2].fixPos();\r\n                ldn('es[' + i2 + '].pm.x=' + es[i2].pm.x + ';');\r\n                ldn('es[' + i2 + '].pm.y=' + es[i2].pm.y + ';');\r\n            }\r\n    }\r\n    // Again by Prosu\r\n    x1 = Math.round((m_pos_x - m_down_x) / GRID_SNAPPING) * GRID_SNAPPING;\r\n    y1 = Math.round((m_pos_y - m_down_y) / GRID_SNAPPING) * GRID_SNAPPING;\r\n    for (let i = 0; i < es.length; i++) {\r\n        if (es[i]._isphysical && es[i].exists && es[i].selected && (MatchLayer(es[i]) || paint_draw_mode)) {\r\n            es[i].pm.x += x1;\r\n            es[i].pm.y += y1;\r\n        }\r\n    }\r\n    m_down_x += x1;\r\n    m_down_y += y1;\r\n    lfz(false);\r\n    return true;\r\n}\r\n\r\nfunction ServerRequest_handleMapData(mapCode) {\r\n    // Branch of patchServerRequest\r\n    // Made to deal with map source related things.\r\n    aleiLog(DEBUG, \"Parsing map source now.\");\r\n\r\n    const objectKeyValueRegex = /(\\w+)=((-?\\d+(\\.\\d+)?)|(\"[ -~]*\")|true|false)/;\r\n    const objectCreationRegex = /q=es\\[\\d+\\]=new E\\(\"(\\w+)\"\\)/;\r\n\r\n    let expressions = mapCode.split(\";\\n\");\r\n\r\n    let currentElement = null;\r\n\r\n    window.es = new Array(); // clear.\r\n    let index = 2; // We skip var q; and es = new Array();\r\n    for (;index < expressions.length; index++) {\r\n        let expression = expressions[index];\r\n\r\n        // Skip if it's just only tab or newlines\r\n        if(expression.replaceAll(\"\\n\", \"\").replaceAll(\"\\t\", \"\").length == 0) {continue};\r\n\r\n        // Map ID related stuff.\r\n        if (expression.indexOf(\"mapid = '\") != -1) {\r\n            window.mapid = expression.split(\" = \")[1].slice(1, -1);\r\n            mapid_field.value = mapid;\r\n            continue;\r\n        }\r\n        else if (expression == \"\\t\\tmapid_field.value = mapid\") {continue;}\r\n        else if (expression.indexOf(\"maprights.innerHTML='\") != -1) {\r\n            let rights = expression.split(\";\")[0].split(\".innerHTML=\")[1].slice(1, -1);\r\n            maprights.value = rights;\r\n            NewNote(`Map '${mapid}' has been successfully loaded.`, note_good);\r\n            assignZIndex();\r\n            sortObjects();\r\n            continue\r\n        }\r\n        // Actual mapdata.\r\n        if(expression.indexOf(\";q=q.pm;\") != -1) { // Creation which is q=es[...]=new E(...);q=q.pm;q.(...)=(...);\r\n            let creation = objectCreationRegex.exec(expression);\r\n            currentElement = new E(creation[1]);\r\n            es[es.length] = currentElement;\r\n\r\n            let splt = expression.split(\";\");\r\n            if (splt.length > 3) {\r\n                // There is supposed to be only 3 ;'s\r\n                // initializing;setting;firstProperty\r\n                // Assuming that server only gives first property and does not send more than 1 in creation line\r\n                aleiLog(WARN, `Expected 3 items, got ${splt.length} - ${splt}`);\r\n                continue;\r\n            }\r\n            expression = splt[2];\r\n        };\r\n        // Key value\r\n        // In format of q.(___)=(___);\r\n        let matchKeyValue = objectKeyValueRegex.exec(expression);\r\n\r\n        if (matchKeyValue === null) {\r\n            aleiLog(WARN, `Unable to figure out what kind of code is \"${expression}\", you MIGHT have issues.`);\r\n            continue;\r\n        }\r\n        let key = matchKeyValue[1];\r\n        let value = matchKeyValue[2].replaceAll(\"\\\\/\", \"/\");\r\n        if (value[0] != '\"') { // Not a string.\r\n            if (value == \"true\") value = true;\r\n            else if(value == \"false\") value = false;\r\n            else if(value.indexOf(\".\") != -1) value = parseFloat(value);\r\n            else value = parseInt(value);\r\n        } else {\r\n            // Is a string. We just strip quotation marks and fix apostrophes.\r\n            value = value.slice(1, -1).replaceAll(\"\\\\'\", \"'\");\r\n        }\r\n        currentElement.pm[key] = value;\r\n\r\n    }\r\n}\r\n\r\nfunction handleServerRequestResponse(request, operation, response) {\r\n    if (response.indexOf(\"var es = new Array();\") != -1) {\r\n        ServerRequest_handleMapData(response);\r\n    }else if (response.indexOf(\"knownmaps = [\") !== -1) {\r\n        window.knownmaps = [];\r\n        for (let map of response.match(/\"(.*?)\"/g)) {\r\n            knownmaps.push(map.slice(1, -1))\r\n        }\r\n        aleiLog(DEBUG, `Updated knownmaps with ${knownmaps.length} maps`);\r\n    }else {\r\n        aleiLog(DEBUG2, `Evaling for request ${ANSI_YELLOW}\"${request}\"${ANSI_RESET} with operation of ${ANSI_YELLOW}\"${operation}\"${ANSI_RESET}: ${response}`)\r\n        try {JS_eval(response);}\r\n        catch(e) {NewNote(\"Eval error!\", note_bad); console.error(e); aleiLog(INFO, `Eval Error from ${request}, for op ${operation} whose response is ${response}`)}\r\n    };\r\n}\r\n\r\nfunction makeRequest(method, url, data) {\r\n    return new Promise(function (resolve, reject) {\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.open(method, url);\r\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n        xhr.onload = function () {\r\n            if (this.status >= 200 && this.status < 300) {\r\n                resolve({status: 200, response: xhr.response});\r\n            } else {\r\n                reject({\r\n                    status: this.status,\r\n                    statusText: xhr.statusText\r\n                });\r\n            }\r\n        };\r\n        xhr.onerror = function () {\r\n            reject({\r\n                status: this.status,\r\n                statusText: xhr.statusText\r\n            });\r\n        };\r\n        xhr.send(data);\r\n    });\r\n}\r\n\r\nfunction updateDecorList() {\r\n    try {\r\n        let list_native = $id(\"list_native\");\r\n        for(let i = 0; i < ALEI_decors.length; i++) {\r\n            let decor = ALEI_decors[i];\r\n            let decor_model = decor[0];\r\n            let decor_name = decor[1];\r\n            let decor_image = decor[2];\r\n            list_native.innerHTML += `\r\n                    <div class=\"img_option\" onClick=\"CustomImageSelected('${decor_model}', '${decor_name}' )\">\r\n                       <div class=\"imgdiv\" style=\"background:url(${decor_image})\"></div>\r\n                       <div>\r\n                         ${decor_name}\r\n                       </div>\r\n                    </div>\r\n                    `\r\n        }\r\n        aleiLog(DEBUG, \"Updated decor list.\");\r\n    }\r\n    catch(e) {} // We assume we are not in decor list yet.\r\n}\r\n\r\nasync function ALEI_ServerRequest(request, operation, callback = null) {\r\n    let response = await makeRequest(\"POST\", `e_server.php?a=${request_a}`, request);\r\n    if (response.status != 200) {\r\n        if (operation == 'save') NewNote('Oops! Error occoured during saving. Usually it may be happening due to connection problems. Map will be temporary saved to your computer\\'s LocalStorage', note_bad);\r\n        else if (operation == 'load') NewNote('Oops! Error occoured durning loading. Usually it may be happening due to connection problems.', note_bad)\r\n        return;\r\n    }\r\n    try {\r\n        handleServerRequestResponse(request, operation, response.response);\r\n        if (request.indexOf(\"a=get_images\") != -1 && request.indexOf(\"for_class=decor_model\") != -1) {\r\n            updateDecorList();\r\n        }\r\n        window.ImageContext = ImageContext;\r\n        if (operation == 'save' || operation == 'load') {\r\n            changes_made = false;\r\n            if (operation == 'load') {\r\n                need_redraw = true;\r\n                need_GUIParams_update = true;\r\n                ClearUndos();\r\n            }\r\n        }\r\n    } catch (e) {\r\n        console.error(e);\r\n        NewNote('Server responds with unclear message. Looks like one of recent actions wasn\\'t successful.', note_bad);\r\n        debugger;\r\n    }\r\n    if (callback != null) {\r\n        callback();\r\n    }\r\n}\r\n\r\nlet _serverRequestPatched = false;\r\nfunction patchServerRequest() {\r\n    // This code just exists to prevent logging more than once\r\n    if (_serverRequestPatched) return;\r\n    _serverRequestPatched = true;\r\n    // Patches ServerRequest function.\r\n    // vanilla ServerRequest function literally eval()'s every single thing that server sends.\r\n    // Which opens up to expected vulnerabilities.\r\n    // Hopefully in future, ALEI will completely get rid of eval.\r\n    window.ServerRequest = ALEI_ServerRequest;\r\n    aleiLog(DEBUG, \"Patched ServerRequest\");\r\n}\r\n\r\nwindow.eval = function(code) { // Temporarily overriding eval so we can patch ServerRequest as early as possible\r\n    if (window.ServerRequest !== undefined) { // ServerRequest is defined.\r\n        handleServerRequestResponse(null, null, code);\r\n        patchServerRequest();\r\n        // We are pretty much done, we have patched ServerRequest, so just roll with old eval.\r\n        // Oh and a note for myself incase i confuse myself: vanilla ServerRequest is synchronous\r\n        window.eval = JS_eval;\r\n    } else {\r\n        // Is not defined.\r\n        // Is this even possible in normal circumstances?\r\n        console.log(code);\r\n        debugger;\r\n    }\r\n};\r\n\r\nfunction patchUpdateGUIParams() {\r\n    let code = window.UpdateGUIParams.toString().replace(\"if ( i >= 4 && (i-4) % 3 == 0 ) {\", \"if (shouldAddSeparatorInGUIParams(i)) {\");\r\n    code = \"(\" + code + \")\"; //putting it in parentheses to make it a function expression. the function can then be assigned directly from eval\r\n    let origUGP = eval(code);\r\n    let origGPV = window.GenParamVal;\r\n\r\n    window.GenParamValEscapeDoubleQuotes = false;\r\n\r\n    // replaces GenParamVal behaviour of when base == \"nochange\". only difference is that it escapes double quotes.\r\n    // also it only escapes double quotes when it's used within UpdateGUIParams.\r\n    // the original function would return value if FORCE_TEXT_OPTIONS == true even if base == \"nochange\". so this works slightly differently, not sure if that's intentional\r\n    window.GenParamVal = function(base, value) {\r\n        if (GenParamValEscapeDoubleQuotes && base == \"nochange\") {\r\n            let valueWithQuotesEscaped = `${value}`.replaceAll('\"', \"&quot;\");\r\n            return `<pvalue real=\"${valueWithQuotesEscaped}\">- not used -</pvalue>`;\r\n        }\r\n        return origGPV(base, value);\r\n    }\r\n\r\n    window.shouldAddSeparatorInGUIParams = function(i) {\r\n        let selected = getSelection();\r\n        let shouldDisplayID = (selected.length == 1) && aleiSettings.showIDs;\r\n        let startSeparatorFrom = 5;\r\n        if (shouldDisplayID) {\r\n            startSeparatorFrom = 6;\r\n        }\r\n        return i >= startSeparatorFrom && (i - startSeparatorFrom) % 3 == 0\r\n    }\r\n\r\n    window.UpdateGUIParams = function() {\r\n        GenParamValEscapeDoubleQuotes = true;\r\n        let zIndexSave = [];\r\n        \r\n        let selected = getSelection();\r\n        let shouldDisplayID = (selected.length == 1) && aleiSettings.showIDs;\r\n        let shouldDisplayZIndex = (selected.length >= 1) && aleiSettings.showZIndex;\r\n        \r\n        for (let i = 0; i < selected.length; i++) {\r\n            if (selected[i]._class == \"trigger\") {\r\n                shouldDisplayZIndex = 0;\r\n            }\r\n        }\r\n        \r\n        if (shouldDisplayID) {\r\n            let entries = Object.entries(selected[0].pm);\r\n            entries.splice(0, 0, [\"__id\",  selected[0].aleiID ]);\r\n            selected[0].pm = Object.fromEntries(entries);\r\n        }\r\n        \r\n        if (!shouldDisplayZIndex) {\r\n            for (let i = 0; i < selected.length; i++) {\r\n                zIndexSave.push(selected[i].pm.__zIndex);\r\n\r\n                delete selected[i].pm.__zIndex;\r\n            }\r\n        }\r\n\r\n        if((selected.length == 1) && (selected[0]._class == \"region\")) {\r\n            if([true, \"true\"].indexOf(selected[0].pm.uses_timer) != -1) {\r\n                param_type[REGION_EXECUTE_PARAM_ID][1] = \"timer+none\";\r\n            } else {\r\n                param_type[REGION_EXECUTE_PARAM_ID][1] = \"trigger+none\";\r\n            }\r\n        }\r\n\r\n        origUGP();\r\n\r\n        if (shouldDisplayID) delete selected[0].pm.__id;\r\n\r\n        if (!shouldDisplayZIndex) {\r\n            for (let i = 0; i < selected.length; i++) {\r\n                selected[i].pm.__zIndex = zIndexSave.shift();\r\n            }\r\n        }\r\n\r\n        addDecorButtons();\r\n\r\n        GenParamValEscapeDoubleQuotes = false;\r\n    }\r\n    aleiLog(DEBUG, \"Patched UpdateGUIParams\");\r\n}\r\n\r\nfunction patchEvalSet() {\r\n    window.EvalSet = function(key, value) {\r\n        // No evaling. Death to eval! (except for when i want to use it...)\r\n        window[key] = value;\r\n        UpdateTools();\r\n    }\r\n    aleiLog(DEBUG, \"Patched EvalSet\");\r\n}\r\n\r\nwindow.ALEI_settingsMenu = undefined;\r\n\r\n\r\n/*\r\nTODO: Text field for those.\r\nlet aleiSettings = {\r\n    triggerEditTextSize:readStorage(\"ALEI_EditTextSize\",      \"12px\",  (val) => val + \"px\"  ),\r\n    starsImage:         readStorage(\"ALEI_StarImage\",    \"stars2.jpg\", (val) => val         ),\r\n}\r\n*/\r\n\r\nfunction createALEISettingsMenu() {\r\n    let mainWindow = document.createElement(\"div\");\r\n    mainWindow.setAttribute(\"class\", \"mrpopup\");\r\n\r\n    let title = document.createElement(\"div\");\r\n    title.innerHTML = \"ALEI Setting\";\r\n    title.setAttribute(\"id\", \"mrtitle\"); // Eric, what is this crap ?\r\n    mainWindow.appendChild(title);\r\n\r\n\r\n    let box = document.createElement(\"div\");\r\n    box.setAttribute(\"id\", \"mrbox\");\r\n    mainWindow.appendChild(box);\r\n\r\n    // Style class.\r\n    let aleiStyles = document.createElement(\"style\");\r\n    aleiStyles.innerHTML = `\r\n    .ALEI_settingMenuText {\r\n        font-size: 14px;\r\n        width: 150px;\r\n        height: 20px;\r\n        background-color: #476082;\r\n        color: #bfcad9;\r\n        border-radius: 4px;\r\n        text-align: center;\r\n        display: inline-block;\r\n    }\r\n    .ALEI_settingsMenuButton {\r\n        background-color: #26354a;\r\n        color: #c1c9d3;\r\n        border-radius: 5px;\r\n        border: 1px solid #26354a;\r\n        width: 70px;\r\n        height: 20px;\r\n        font-size: 14px;\r\n        text-align: center;\r\n        display: inline-block;\r\n        margin-right: 4px;\r\n    }\r\n    .ALEI_settingsMenuButton:hover {\r\n        background-color: #596a83;\r\n        color: #f5faff;\r\n    }\r\n    .ALEI_settingMenuButtonClicked {\r\n        background-color: #91a5c1;\r\n        color: #fbfbfb;\r\n    }\r\n    `\r\n    document.head.appendChild(aleiStyles);\r\n\r\n    // Convenience functions.\r\n    function addText(text, requiresRestart = false) {\r\n        let div = document.createElement(\"div\");\r\n        div.innerHTML = text;\r\n        if (requiresRestart) {\r\n            div.style.setProperty(\"color\", \"#FFFF00\");\r\n        }\r\n        div.setAttribute(\"class\", \"ALEI_settingMenuText\");\r\n        box.innerHTML += \"<br>\";\r\n        box.innerHTML += div.outerHTML;\r\n    }\r\n    function registerButton(general, values, key) {\r\n        aleiSettingButtonsMap[general] = [values, key];\r\n    }\r\n    function addButton(display, identifier, callback, style = \"\") {\r\n        aleiButtonClicks[\"setting_\" + identifier] = callback;\r\n\r\n        let button = document.createElement(\"input\");\r\n        button.setAttribute(\"type\", \"button\");\r\n        button.setAttribute(\"id\", \"ALEI_\" + identifier);\r\n        button.setAttribute(\"value\", display);\r\n        button.setAttribute(\"onclick\", `aleiButtonClicks['setting_${identifier}'](); ALEI_settingUpdateButtons(); triggerActionsPreventError();`);\r\n        button.setAttribute(\"class\", \"ALEI_settingsMenuButton\");\r\n        button.setAttribute(\"style\", style);\r\n\r\n        box.innerHTML += button.outerHTML;\r\n    }\r\n    function addBinaryOption(truthyVal, falsyVal, storage, key, internalName, callback = () => {}) {\r\n        function _apply(val) {\r\n            writeStorage(storage, val);\r\n            aleiSettings[key] = val;\r\n        }\r\n        addButton(truthyVal, `${internalName}_true`, () => {_apply(true); callback(true)});\r\n        addButton(falsyVal, `${internalName}_false`, () => {_apply(false); callback(false)});\r\n    }\r\n\r\n    // Log level.\r\n    function logApply(val) {\r\n        writeStorage(\"ALEI_LogLevel\", val);\r\n        aleiSettings.logLevel = val;\r\n    }\r\n    box.innerHTML += \"NOTE: Settings in yellow text requires page refresh to be applied.<br>\";\r\n    addButton(\"Clear Backup\", \"clearMapBackups\", () => {\r\n        let removed = [];\r\n        for (let key of Object.keys(localStorage)) {\r\n            if(!(key.slice(0, \"pb2_map\".length) == \"pb2_map\")) continue;\r\n            removed.push(key);\r\n            localStorage.removeItem(key);\r\n        }\r\n        NewNote(`ALEI: Cleared backup, removed total ${removed.length} backups.`, \"#00FFFF\");\r\n        aleiLog(DEBUG2, `Removed backup of: ${removed}`);\r\n    }, \"width: 100px\");\r\n    box.innerHTML += \"<br>\";\r\n\r\n    registerButton(\"log\", [0, 1, 2], \"logLevel\");\r\n    addText(\"Log Level:\");\r\n    addButton(\"INFO\", \"log_0\", () => logApply(0));\r\n    addButton(\"DEBUG\", \"log_1\", () => logApply(1));\r\n    addButton(\"DEBUG2\", \"log_2\", () => logApply(2));\r\n\r\n    // Action IDs.\r\n    registerButton(\"actionid\", [true, false], \"showTriggerIDs\");\r\n    addText(\"Action IDs:\", true)\r\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowTriggerIDs\", \"showTriggerIDs\", \"actionid\")\r\n\r\n    // Tooltips.\r\n    registerButton(\"tooltip\", [true, false], \"enableTooltips\");\r\n    addText(\"Tooltips:\")\r\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowTooltips\", \"enableTooltips\", \"tooltip\")\r\n\r\n    // Object ID.\r\n    registerButton(\"showids\", [true, false], \"showIDs\");\r\n    addText(\"Object IDs:\")\r\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowIDs\", \"showIDs\", \"showids\")\r\n\r\n    // Z-Index.\r\n    registerButton(\"showzindex\", [true, false], \"showZIndex\");\r\n    addText(\"Object z-index:\");\r\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowZIndex\", \"showZIndex\", \"showzindex\")\r\n\r\n    // Show same parameters.\r\n    registerButton(\"sameparams\", [true, false], \"showSameParameters\");\r\n    addText(\"Same Parameters:\");\r\n    addBinaryOption(\"Show\", \"Hide\", \"ALEI_ShowSameParameters\", \"showSameParameters\", \"sameparams\");\r\n\r\n    // Black theme.\r\n    registerButton(\"blackTheme\", [true, false], \"blackTheme\");\r\n    addText(\"Black theme:\", true);\r\n    addBinaryOption(\"Yes\", \"No\", \"ALEI_BlackTheme\", \"blackTheme\", \"blackTheme\");\r\n\r\n    // Change grid based on snapping\r\n    registerButton(\"changeGridBasedOnSnapping\", [true, false], \"gridBasedOnSnapping\");\r\n    addText(\"Grid by Snap:\");\r\n    addBinaryOption(\"Yes\", \"No\", \"ALEI_gridBasedOnSnapping\", \"gridBasedOnSnapping\", \"changeGridBasedOnSnapping\");\r\n\r\n    // Render object names\r\n    registerButton(\"showObjectNames\", [true, false], \"renderObjectNames\");\r\n    addText(\"Show object names: \");\r\n    addBinaryOption(\"Yes\", \"No\", \"ALEI_RenderObjectNames\", \"renderObjectNames\", \"showObjectNames\", (status) => ALEI_UpdateNameRenderSetting(status));\r\n\r\n    // Remap UID\r\n    registerButton(\"remapUID\", [true, false], \"rematchUID\");\r\n    addText(\"Remap UID: \");\r\n    addBinaryOption(\"Enabled\", \"Disabled\", \"ALEI_RemapUID\", \"rematchUID\", \"remapUID\", (status) => ALEI_UpdateRematchUIDSetting(status));\r\n\r\n    // Text affected by zoom\r\n    registerButton(\"textAffectedByZoomOption\", [true, false], \"textAffectedByZoom\");\r\n    addText(\"Text affected by zoom:\");\r\n    addBinaryOption(\"Yes\", \"No\", \"ALEI_TextAffectedByZoom\", \"textAffectedByZoom\", \"textAffectedByZoomOption\");\r\n    // TODO: Shorten those...\r\n\r\n    window.ALEI_settingsMenu = mainWindow;\r\n    document.body.appendChild(mainWindow);\r\n    ALEI_settingUpdateButtons();\r\n    aleiLog(DEBUG, \"Created settings window.\");\r\n}\r\n\r\nlet aleiSettingButtonsMap = {}\r\n\r\nwindow.ALEI_settingUpdateButtons = () => {\r\n    let defaultClass = \"ALEI_settingsMenuButton\";\r\n    let clickedClass = \"ALEI_settingsMenuButton ALEI_settingMenuButtonClicked\";\r\n\r\n    for (let entry of Object.entries(aleiSettingButtonsMap)) {\r\n        let identity = entry[0];\r\n        let values = entry[1][0];\r\n        let key = entry[1][1];\r\n\r\n        let currentVal = aleiSettings[key];\r\n        for (let value of values) {\r\n            $query(`#ALEI_${identity}_${value}`).setAttribute(\"class\", defaultClass);\r\n        }\r\n        $query(`#ALEI_${identity}_${currentVal}`).setAttribute(\"class\", clickedClass);\r\n    }\r\n}\r\n\r\n\r\nfunction showSettings() {\r\n    if (ALEI_settingsMenu === undefined) createALEISettingsMenu();\r\n\r\n    mrdimlights.style.display = 'block';\r\n    ALEI_settingsMenu.style.display = 'block';\r\n    dim_undo = \"ALEI_settingsMenu.style.display = 'none'\";\r\n};\r\n\r\nfunction patchTeamList() {\r\n    for (let entry of Object.entries(VAL_TABLE[\"team\"])) {\r\n        let teamID = parseInt(entry[0]);\r\n        let teamName = entry[1];\r\n\r\n        if (teamID < 0) {\r\n            teamName = teamName.replace(\"(no friendly fire)\", \"(No collision, Yes friendly fire)\")\r\n            VAL_TABLE[\"team\"][teamID] = teamName;\r\n        }\r\n\r\n        if (teamID === -1) continue;\r\n        VAL_TABLE[\"team+any\"][teamID] = teamName;\r\n    }\r\n    aleiLog(DEBUG, \"Edited team list..\");\r\n}\r\n\r\nfunction addProjectileModels() {\r\n    let projectileModels = VAL_TABLE[\"ALEI_projectileModels\"] = {\r\n        1: \"https://static.miraheze.org/plazmaburstwiki/6/6a/Lazer_1.png\",\r\n        2: \"https://static.miraheze.org/plazmaburstwiki/a/ae/Lazer_2.png\",\r\n        3: \"https://static.miraheze.org/plazmaburstwiki/0/06/Lazer_3.png\",\r\n        4: \"https://static.miraheze.org/plazmaburstwiki/d/de/Lazer_4.png\",\r\n        5: \"https://static.miraheze.org/plazmaburstwiki/8/8f/Lazer_5.png\",\r\n        6: \"https://static.miraheze.org/plazmaburstwiki/a/a0/Lazer_6.png\",\r\n        7: \"https://static.miraheze.org/plazmaburstwiki/7/71/Lazer_7.png\",\r\n        8: \"https://static.miraheze.org/plazmaburstwiki/c/c6/Lazer_8.png\",\r\n        9: \"https://static.miraheze.org/plazmaburstwiki/d/d2/Lazer_9.png\",\r\n        10: \"https://static.miraheze.org/plazmaburstwiki/5/5b/Lazer_10.png\",\r\n        11: \"https://static.miraheze.org/plazmaburstwiki/d/d2/Lazer_11.png\",\r\n        12: \"https://static.miraheze.org/plazmaburstwiki/2/2d/Lazer_12.png\",\r\n        13: \"https://static.miraheze.org/plazmaburstwiki/b/be/Lazer_13.png\",\r\n        14: \"https://static.miraheze.org/plazmaburstwiki/1/14/Lazer_14.png\",\r\n        15: \"\", // Empty projectile.\r\n        16: \"https://static.miraheze.org/plazmaburstwiki/7/7f/Lazer_16.png\",\r\n        17: \"https://static.miraheze.org/plazmaburstwiki/3/31/Lazer_17.png\",\r\n        18: \"https://static.miraheze.org/plazmaburstwiki/8/89/Lazer_18.png\",\r\n        19: \"https://static.miraheze.org/plazmaburstwiki/f/fe/Lazer_19.png\",\r\n        20: \"https://static.miraheze.org/plazmaburstwiki/1/1a/Lazer_20.png\",\r\n        21: \"https://static.miraheze.org/plazmaburstwiki/4/42/Lazer_21.png\",\r\n        22: \"https://static.miraheze.org/plazmaburstwiki/c/c0/Lazer_22.png\",\r\n        23: \"https://static.miraheze.org/plazmaburstwiki/d/d9/Lazer_23.png\",\r\n        24: \"https://static.miraheze.org/plazmaburstwiki/f/f5/Lazer_24.png\",\r\n        25: \"https://static.miraheze.org/plazmaburstwiki/7/7c/Lazer_25.png\",\r\n        26: \"https://static.miraheze.org/plazmaburstwiki/a/a7/Lazer_26.png\",\r\n        27: \"https://static.miraheze.org/plazmaburstwiki/3/30/Lazer_27.png\",\r\n        28: \"https://static.miraheze.org/plazmaburstwiki/3/3a/Lazer_28.png\",\r\n        29: \"https://static.miraheze.org/plazmaburstwiki/9/90/Lazer_29.png\",\r\n        30: \"https://static.miraheze.org/plazmaburstwiki/2/23/Lazer_30.png\",\r\n        31: \"https://static.miraheze.org/plazmaburstwiki/3/3a/Lazer_31.png\",\r\n        32: \"https://static.miraheze.org/plazmaburstwiki/f/f0/Lazer_32.png\",\r\n        33: \"https://static.miraheze.org/plazmaburstwiki/0/0d/Lazer_33.png\",\r\n        34: \"https://static.miraheze.org/plazmaburstwiki/c/c8/Lazer_34.png\",\r\n        35: \"https://static.miraheze.org/plazmaburstwiki/3/38/Lazer_35.png\",\r\n        36: \"https://static.miraheze.org/plazmaburstwiki/6/6d/Lazer_36.png\",\r\n        37: \"https://static.miraheze.org/plazmaburstwiki/a/a9/Lazer_37.png\",\r\n        38: \"https://static.miraheze.org/plazmaburstwiki/e/e7/Lazer_38.png\",\r\n        39: \"https://static.miraheze.org/plazmaburstwiki/6/6c/Lazer_39.png\",\r\n        40: \"https://static.miraheze.org/plazmaburstwiki/d/d4/Lazer_40.png\",\r\n        41: \"https://static.miraheze.org/plazmaburstwiki/5/5d/Lazer_41.png\",\r\n        42: \"https://static.miraheze.org/plazmaburstwiki/9/9d/Lazer_42.png\",\r\n        43: \"https://static.miraheze.org/plazmaburstwiki/7/79/Lazer_43.png\",\r\n        44: \"https://static.miraheze.org/plazmaburstwiki/6/6d/Lazer_44.png\",\r\n        45: \"https://static.miraheze.org/plazmaburstwiki/4/44/Lazer_45.png\",\r\n        46: \"https://static.miraheze.org/plazmaburstwiki/3/3b/Lazer_46.png\",\r\n        47: \"https://static.miraheze.org/plazmaburstwiki/8/84/Lazer_47.png\",\r\n        48: \"https://static.miraheze.org/plazmaburstwiki/7/75/Lazer_48.png\",\r\n        49: \"https://static.miraheze.org/plazmaburstwiki/0/08/Lazer_49.png\",\r\n        50: \"https://static.miraheze.org/plazmaburstwiki/4/41/Lazer_50.png\",\r\n        51: \"https://static.miraheze.org/plazmaburstwiki/9/92/Lazer_51.png\",\r\n        52: \"https://static.miraheze.org/plazmaburstwiki/9/92/Lazer_52.png\",\r\n        53: \"https://static.miraheze.org/plazmaburstwiki/7/70/Lazer_53.png\",\r\n        54: \"https://static.miraheze.org/plazmaburstwiki/e/ee/Lazer_54.png\",\r\n        55: \"https://static.miraheze.org/plazmaburstwiki/d/d1/Lazer_55.png\"\r\n    };\r\n    for (let i = 1; i < 56; i++) {\r\n        projectileModels[i] = `<img src='${projectileModels[i]}' style='width: 60px; height: 20px'/>`;\r\n    }\r\n    aleiLog(DEBUG, \"Loaded projectile models.\");\r\n}\r\n\r\nfunction patchSpecialValue() {\r\n    let _OG = window.special_value;\r\n    window.special_value = (base, value) => {\r\n        if ([\"ALEI_projectileModels\"].indexOf(base) !== -1) {\r\n            let returning = VAL_TABLE[base][value];\r\n            if (returning === undefined) return ERROR_VALUE;\r\n            else return returning;\r\n        } else if(base == \"trigger+none\") { // I actually do not have to do this, but i will do it to get rid of annoyance\r\n            if(value == -1) return VAL_TABLE[\"trigger+none\"][-1];\r\n            return special_value(\"trigger\", value);\r\n        }else if(base == \"timer+none\") {\r\n            if(value == -1) return VAL_TABLE[\"timer+none\"][-1];\r\n            return special_value(\"timer\", value);\r\n        }else return _OG(base, value);\r\n    }\r\n    aleiLog(DEBUG, \"Patched SpecialValue\");\r\n}\r\n\r\nfunction notifyUpdate(version) {\r\n    newUpdate = 1;\r\n\r\n    aleiLog(INFO, `New update: ${version}`);\r\n    NewNote(`ALEI: There is new update: ${version}, you are currently in ${GM_info.script.version}<br>Press Ctrl + Shift to update`, \"#FFFFFF\");\r\n}\r\n\r\nfunction notifyIfTheresUpdate(script) {\r\n    let lines = script.split(\"\\n\");\r\n    let version;\r\n    for(let i = 0; i < lines.length; i++) {\r\n        let line = lines[i];\r\n        if(line.indexOf(\"@version\") == -1) continue;\r\n\r\n        let parts = line.split(\" \");\r\n        version = parts[parts.length - 1];\r\n        break;\r\n    }\r\n\r\n    let verParts = version.split(\".\");\r\n    let currentVerParts = GM_info.script.version.split(\".\");\r\n\r\n    // x.y.z > x.y(.0)\r\n    if(verParts.length > currentVerParts.length) return notifyUpdate(version);\r\n\r\n    let smallestLength = Math.min(verParts.length , currentVerParts.length)\r\n    for (let i = 0; i < smallestLength; i++) {\r\n        let verPart = parseInt(verParts[i]);\r\n        let currentVerPart = parseInt(currentVerParts[i]);\r\n\r\n        if(verPart > currentVerPart) return notifyUpdate(version);\r\n    }\r\n    aleiLog(INFO, \"No update detected.\");\r\n}\r\n\r\nasync function checkForUpdates() {\r\n    let resp = await GM.xmlHttpRequest({  url: GM_info.script.updateURL  }).catch(e => console.error(e));\r\n    notifyIfTheresUpdate(resp.responseText);\r\n}\r\n\r\nfunction ALEI_DoWorldScale() {\r\n    var newscale = prompt('Multiply selection size by % (percents)', 100);\r\n    if (!(newscale == null || newscale == 100)) {\r\n        var factor = Math.floor(newscale) / 100;\r\n        {\r\n            let snappingScript = `/GRID_SNAPPING)*GRID_SNAPPING;`\r\n            var roundwell = true;\r\n            lcz();\r\n            for (let i = 0; i < es.length; i++)\r\n                if (es[i].exists)\r\n                    if (es[i].selected)\r\n                        if (MatchLayer(es[i])) {\r\n                            if (es[i].pm.w != undefined) {\r\n                                ldn('es[' + i + '].pm.w=Math.round(es[' + i + '].pm.w*' + factor + snappingScript);\r\n                                lnd('es[' + i + '].pm.w=' + es[i].pm.w + ';');\r\n                                if (es[i].pm.w * factor != Math.round(es[i].pm.w * factor / GRID_SNAPPING) * GRID_SNAPPING)\r\n                                    roundwell = false;\r\n                            }\r\n                            if (es[i].pm.h != undefined) {\r\n                                ldn('es[' + i + '].pm.h=Math.round(es[' + i + '].pm.h*' + factor + snappingScript);\r\n                                lnd('es[' + i + '].pm.h=' + es[i].pm.h + ';');\r\n                                if (es[i].pm.h * factor != Math.round(es[i].pm.h * factor / GRID_SNAPPING) * GRID_SNAPPING)\r\n                                    roundwell = false;\r\n                            }\r\n                            if (es[i].pm.x != undefined) {\r\n                                ldn('es[' + i + '].pm.x=Math.round(es[' + i + '].pm.x*' + factor + snappingScript);\r\n                                lnd('es[' + i + '].pm.x=' + es[i].pm.x + ';');\r\n                                if (es[i].pm.x * factor != Math.round(es[i].pm.x * factor / GRID_SNAPPING) * GRID_SNAPPING)\r\n                                    roundwell = false;\r\n                            }\r\n                            if (es[i].pm.y != undefined) {\r\n                                ldn('es[' + i + '].pm.y=Math.round(es[' + i + '].pm.y*' + factor + snappingScript);\r\n                                lnd('es[' + i + '].pm.y=' + es[i].pm.y + ';');\r\n                                if (es[i].pm.y * factor != Math.round(es[i].pm.y * factor / GRID_SNAPPING) * GRID_SNAPPING)\r\n                                    roundwell = false;\r\n                            }\r\n                        }\r\n            lfz(true);\r\n            NewNote('Operation complete:<br><br>Selected objects scaled by ' + factor + ' (' + newscale + '% of original size)', note_passive);\r\n            if (!roundwell)\r\n                NewNote('Note: Position and/or dimensions of some objects were not scaled properly due to Level Editor rounding rules', note_neutral);\r\n            need_GUIParams_update = true;\r\n            need_redraw = true;\r\n            UpdateTools();\r\n        }\r\n    }\r\n}\r\nfunction patchPercentageTool() {\r\n    window.DoWorldScale = ALEI_DoWorldScale;\r\n    aleiLog(DEBUG, \"Patched percentage tool\");\r\n}\r\n\r\nfunction _encodeXMLChars(value) {\r\n    return value.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\").replaceAll('\"', \"&quot;\")\r\n}\r\n\r\nfunction patchCompileTrigger() {\r\n    let _og = window.CompileTrigger;\r\n    window.CompileTrigger = () => {\r\n        let result = _og();\r\n        let selected = getSelection();\r\n        for (let i = 0; i < selected.length; i++) {\r\n            let obj = selected[i];\r\n            let keys = Object.keys(obj.pm);\r\n\r\n            for (let j = 0; j < keys.length; j++) {\r\n                if (typeof obj.pm[keys[j]] == \"string\") {\r\n                    obj.pm[keys[j]] = _encodeXMLChars(obj.pm[keys[j]]);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    aleiLog(DEBUG, \"Patched CompileTrigger\");\r\n}\r\n\r\nfunction addPasteFromPermanentClipboard() {\r\n    window.pasteFromPermanentClipboard = pasteFromPermanentClipboard;\r\n}\r\n\r\nlet selectedTriggerActions = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\nlet hoveredTriggerAction = -1;\r\nlet triggerActionsClipboard = [];\r\n\r\nfunction getTriggerActionElements() {\r\n    let arr = [];\r\n    let elems = document.getElementsByClassName(\"p_i\");\r\n    let i = 6;\r\n\r\n    if (aleiSettings.showIDs) {\r\n        i++;\r\n    }\r\n\r\n    for (; i < elems.length; i++) {\r\n        arr.push(elems[i].childNodes[0]);\r\n    }\r\n\r\n    return arr;\r\n}\r\n\r\nfunction addEventListeners() {\r\n    let elems = getTriggerActionElements();\r\n\r\n    for (let i = 0; i < elems.length; i++) {\r\n        let elem = elems[i];\r\n\r\n        elem.onmousedown = function() {\r\n            selectedTriggerActions[Math.floor(i / 3)] ^= 1;\r\n            updateTriggerActionElements();\r\n        }\r\n\r\n        elem.onmouseenter = function() {\r\n            hoveredTriggerAction = Math.floor(i / 3);\r\n            updateTriggerActionElements();\r\n        }\r\n\r\n        elem.onmouseleave = function() {\r\n            hoveredTriggerAction = -1;\r\n            updateTriggerActionElements();\r\n        }\r\n    }\r\n}\r\n\r\nfunction updateTriggerActionElements() {\r\n    let elems = getTriggerActionElements();\r\n\r\n    // TODO: Make those colors not hardcoded, prolly never will do.\r\n    for (let i = 0; i < 10; i++) {\r\n        // Not selected\r\n        let color = \"\";\r\n\r\n        // Selected.\r\n        if (selectedTriggerActions[i]) {\r\n            color = \"rgb(45, 65, 95)\";\r\n            if (THEME != 0) color = \"rgb(27, 27, 27)\"; // rgb(37, 37, 37)\r\n        }\r\n\r\n        elems[i * 3 + 0].style.backgroundColor = color;\r\n        elems[i * 3 + 1].style.backgroundColor = color;\r\n        elems[i * 3 + 2].style.backgroundColor = color;\r\n    }\r\n\r\n    // Hover.\r\n    if (hoveredTriggerAction != -1) {\r\n        if (!selectedTriggerActions[hoveredTriggerAction]) {\r\n            let color = \"rgb(65, 85, 130)\";\r\n\r\n            if (THEME != 0) color = \"rgb(47, 47, 47)\"\r\n\r\n            elems[hoveredTriggerAction * 3 + 0].style.backgroundColor = color;\r\n            elems[hoveredTriggerAction * 3 + 1].style.backgroundColor = color;\r\n            elems[hoveredTriggerAction * 3 + 2].style.backgroundColor = color;\r\n        }\r\n    }\r\n}\r\n\r\nfunction isOnlyTriggerSelected() {\r\n    let result = 0;\r\n    let selection = getSelection();\r\n\r\n    if (selection.length == 1 && selection[0]._class == \"trigger\") {\r\n        result = 1;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction getTriggerActions() {\r\n    edit_triggers_as_text = 1;\r\n\r\n    UpdateGUIParams();\r\n\r\n    let textarea = document.getElementById(\"opcode_field\");\r\n    let arr = textarea.value.split(\"\\n\").slice(4);\r\n\r\n    while (arr.length < 10) {\r\n        arr.push(\"\");\r\n    }\r\n\r\n    edit_triggers_as_text = 0;\r\n    UpdateGUIParams();\r\n\r\n    return arr;\r\n}\r\n\r\nfunction copyTriggerActions() {\r\n    let actions = getTriggerActions();\r\n\r\n    triggerActionsClipboard = [];\r\n\r\n    for (let i = 0; i < 10; i++) {\r\n        if (selectedTriggerActions[i]) {\r\n            triggerActionsClipboard.push(actions[i]);\r\n        }\r\n    }\r\n}\r\n\r\nfunction isNothingSelected() {\r\n    return !selectedTriggerActions.includes(1);\r\n}\r\n\r\nfunction isOnlyOneTriggerActionSelected() {\r\n    return selectedTriggerActions.indexOf(1) == selectedTriggerActions.lastIndexOf(1) && !isNothingSelected();\r\n}\r\n\r\nfunction getSelectedTriggerAction() {\r\n    return selectedTriggerActions.indexOf(1);\r\n}\r\n\r\nfunction getTriggerInfo() {\r\n    edit_triggers_as_text = 1;\r\n    UpdateGUIParams();\r\n\r\n    let textarea = document.getElementById(\"opcode_field\");\r\n    let arr = textarea.value.split(\"\\n\").slice(0, 3);\r\n\r\n    return arr;\r\n}\r\n\r\nfunction pasteTriggerActions() {\r\n    // TODO: Make this bit more specific\r\n    // As in, if i copy 2 actions, and i select another 2 actions, it should paste to those 2 actions i selected\r\n    // And not add to end of it.\r\n    let actions = getTriggerActions();\r\n    let index = getSelectedTriggerAction();\r\n    let clipboard = triggerActionsClipboard.join(\"\\n\");\r\n    let info = getTriggerInfo();\r\n\r\n    edit_triggers_as_text = 1;\r\n    UpdateGUIParams();\r\n\r\n    if (isNothingSelected()) { // Adds action at end of no action was selected.\r\n        index = actions.length - 1;\r\n        actions[index] = actions[index] + \"\\n\" + clipboard;\r\n    }\r\n\r\n    if (isOnlyOneTriggerActionSelected()) { // Adds action before the action that was selected.\r\n        actions[index] = clipboard + \"\\n\" + actions[index];\r\n    }\r\n\r\n    let textarea = document.getElementById(\"opcode_field\");\r\n\r\n    textarea.value = info.concat(actions).join(\"\\n\");\r\n\r\n    CompileTrigger();\r\n\r\n    edit_triggers_as_text = 0;\r\n    UpdateGUIParams();\r\n}\r\n\r\nfunction deleteTriggerActions() {\r\n    let actions = getTriggerActions();\r\n    let info = getTriggerInfo();\r\n\r\n    edit_triggers_as_text = 1;\r\n    UpdateGUIParams();\r\n\r\n    for (let i = 0; i < 10; i++) {\r\n        if (selectedTriggerActions[i]) {\r\n            actions[i] = \"\";\r\n        }\r\n    }\r\n\r\n    let textarea = document.getElementById(\"opcode_field\");\r\n\r\n    textarea.value = info.concat(actions).join(\"\\n\");\r\n\r\n    CompileTrigger();\r\n\r\n    edit_triggers_as_text = 0;\r\n    UpdateGUIParams();\r\n}\r\n\r\nfunction reverseTriggerActions() {\r\n    let actions1 = getTriggerActions();\r\n    let actions2 = [];\r\n    let indexes = [];\r\n    let info = getTriggerInfo();\r\n\r\n    edit_triggers_as_text = 1;\r\n    UpdateGUIParams();\r\n\r\n    for (let i = 0; i < 10; i++) {\r\n        if (selectedTriggerActions[i]) {\r\n            actions2.push(actions1[i]);\r\n            indexes.push(i);\r\n        }\r\n    }\r\n\r\n    indexes.reverse();\r\n\r\n    for (let i = 0; i < actions2.length; i++) {\r\n        let index = indexes[i];\r\n        let action = actions2[i];\r\n\r\n        actions1[index] = action;\r\n    }\r\n\r\n    let textarea = document.getElementById(\"opcode_field\");\r\n\r\n    textarea.value = info.concat(actions1).join(\"\\n\");\r\n\r\n    displayOperationCompleteNotes = false;\r\n    CompileTrigger();\r\n    displayOperationCompleteNotes = true;\r\n    NewNote(\"Reversed actions.\", \"#FFFFFF\");\r\n\r\n    edit_triggers_as_text = 0;\r\n    UpdateGUIParams();\r\n}\r\n\r\nfunction unselectTriggerActions() {\r\n    selectedTriggerActions = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n    hoveredTriggerAction = -1;\r\n    updateTriggerActionElements();\r\n}\r\n\r\nfunction triggerActionsPreventError() {\r\n    selectedTriggerActions = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n    hoveredTriggerAction = -1;\r\n    UpdateGUIParams();\r\n}\r\n\r\nfunction patchClipboardFunctions() {\r\n    let old_CopyToClipBoard = CopyToClipBoard;\r\n    let old_PasteFromClipBoard = PasteFromClipBoard;\r\n    let old_DeleteSelection = DeleteSelection;\r\n    let old_UpdateGUIParams = UpdateGUIParams;\r\n    let old_DO_UNDO = DO_UNDO;\r\n    let old_DO_REDO = DO_REDO;\r\n\r\n    window.CopyToClipBoard = function(param) {\r\n        if (isNothingSelected()) {\r\n            let result = old_CopyToClipBoard(param);\r\n            triggerActionsClipboard = [];\r\n            return result;\r\n        } else {\r\n            copyTriggerActions();\r\n            unselectTriggerActions();\r\n            return true;\r\n        }\r\n    }\r\n\r\n    window.PasteFromClipBoard = function(param) {\r\n        if (triggerActionsClipboard.length == 0) {\r\n            let result = old_PasteFromClipBoard(param);\r\n            UpdateGUIParams();\r\n            return result;\r\n        } else {\r\n            displayOperationCompleteNotes = false;\r\n            pasteTriggerActions();\r\n            unselectTriggerActions();\r\n            displayOperationCompleteNotes = true;\r\n            return true;\r\n        }\r\n    }\r\n\r\n    window.DeleteSelection = function() {\r\n        if (isNothingSelected()) {\r\n            old_DeleteSelection();\r\n        } else {\r\n            displayOperationCompleteNotes = false;\r\n            deleteTriggerActions();\r\n            unselectTriggerActions();\r\n            NewNote(\"Deleted trigger actions.\", \"#FFFFFF\");\r\n            displayOperationCompleteNotes = true;\r\n        }\r\n    }\r\n\r\n    window.UpdateGUIParams = function() {\r\n        old_UpdateGUIParams();\r\n\r\n        if (!isOnlyTriggerSelected()) {\r\n            selectedTriggerActions = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n            hoveredTriggerAction = -1;\r\n        } else if (!edit_triggers_as_text) {\r\n            addEventListeners();\r\n            updateTriggerActionElements();\r\n        }\r\n    }\r\n\r\n    window.DO_UNDO = function() {\r\n        try {\r\n            old_DO_UNDO();\r\n        } catch (err) {\r\n            NewNote(\"Can't undo action.\", note_bad);\r\n        }\r\n    }\r\n\r\n    window.DO_REDO = function() {\r\n        try {\r\n            old_DO_REDO();\r\n        } catch (err) {\r\n            NewNote(\"Can't redo action.\", note_bad);\r\n        }\r\n    }\r\n\r\n    window.triggerActionsPreventError = triggerActionsPreventError;\r\n    aleiLog(DEBUG, \"Patched clipboard related functions.\");\r\n}\r\n\r\nfunction patchDrawGrid() {\r\n    let old_lg = lg;\r\n\r\n    window.lg = function(param1, param2) {\r\n        if(aleiSettings.gridBasedOnSnapping) {\r\n            old_lg(param1 * (GRID_SNAPPING / 10), Math.min(param2 * Math.max(GRID_SNAPPING / 10, 1), 1));\r\n        } else {\r\n            old_lg(param1, param2)\r\n        }\r\n    }\r\n    aleiLog(DEBUG, \"Patched LG\");\r\n}\r\n\r\nfunction patchNewNote() {\r\n    let old = NewNote;\r\n    window.NewNote = (text, color) => {\r\n        if (displayOperationCompleteNotes) return old(text, color);\r\n        if (text.slice(0, \"Operation complete:<br><br>\".length) != \"Operation complete:<br><br>\") return old(text, color);\r\n    }\r\n}\r\n\r\nvar zoomedTextScaleMultiply = 1.4 // TODO: could probs add some way to change this\r\n\r\nfunction ALEI_renderObjectNameText(ctx, text, centerx, centery, dim) { //centerx and centery refer to the text center position on the screen\r\n    if (!aleiSettings.textAffectedByZoom) {\r\n        ctx.fillText(text, centerx - dim.width/2, centery + 3);\r\n    }\r\n    else {\r\n        let textScale = 1 / zoom //inverse cuz smaller zoom means more zoom for some reason\r\n        textScale *= zoomedTextScaleMultiply; // text size would get too small without this\r\n        if (textScale > 1) {\r\n            textScale = 1;\r\n        }\r\n        let target_width_in_world = dim.width\r\n        let width_on_screen = target_width_in_world * textScale;//w2s_w(dim.width);\r\n        let x = centerx - width_on_screen/2;\r\n        let y = centery + 3 * textScale;\r\n        ctx.translate(x, y); // things scale around the origin so this moves the origin to the text position\r\n        ctx.scale(textScale, textScale);\r\n        ctx.fillText(text, 0, 0);\r\n        ctx.scale(1/textScale, 1/textScale);\r\n        ctx.translate(-x, -y);\r\n    }\r\n}\r\n\r\nfunction patchRender() {\r\n    let oldCodeSnippet = \"ctx.fillText(fillText, x3, y3+8 + (dim.height-10)/2);\";\r\n    let newCodeSnippet = \"ALEI_renderObjectNameText(ctx, fillText, capx, capy, dim);\"; //capx and capy represent the text center position\r\n    let code = ALE_Render.toString().replace(oldCodeSnippet, newCodeSnippet);\r\n    //vanilla code would make an implicit global \"property\". this whole patching thing somehow makes Render run in strict mode and it throws an error if it isn't fixed here\r\n    code = code.replace(\"for ( property in es[i].pm )\", \"for (var property in es[i].pm)\")\r\n    code = \"(\" + code + \")\";\r\n    window.Render = eval(code);\r\n    aleiLog(DEBUG, \"Patched Render\");\r\n}\r\n\r\nlet ALE_start = (async function() {\r\n    'use strict';\r\n\r\n    VAL_TABLE = special_values_table;\r\n    ROOT_ELEMENT = document.documentElement;\r\n    stylesheets = document.styleSheets;\r\n    ALE_Render = Render;\r\n    // Handling rest of things\r\n    addPropertyPanelResize();\r\n    addObjBoxResize();\r\n\r\n    updateStyles();\r\n    updateSkins();\r\n    updateSounds();\r\n    updateVoicePresets();\r\n    updateParameters();\r\n    updateOffsets();\r\n    updateObjects();\r\n    updateButtons();\r\n    patch_m_down();\r\n    addSessionSync();\r\n    addTriggerIDs();\r\n    patchShowHideButton();\r\n    optimize();\r\n    patchUpdateTools();\r\n    patchDecorUpload();\r\n    patchEntityClass();\r\n    patchNewNote();\r\n    patchEvalSet();\r\n    // Allowing for spaces in parameters.\r\n    window.UpdatePhysicalParam = UpdatePhysicalParam;\r\n    window.PasteFromClipBoard = PasteFromClipBoard;\r\n    patchANI();\r\n    // Tooltip.\r\n    if(aleiSettings.enableTooltips) {\r\n        doTooltip();\r\n    }\r\n    patchServerRequest();\r\n    patchUpdateGUIParams();\r\n    patchTeamList();\r\n    patchRandomizeName();\r\n    patchAllowedCharacters();\r\n    if (aleiSettings.blackTheme) {\r\n        blackTheme();\r\n    }\r\n    addProjectileModels();\r\n    patchSpecialValue();\r\n    UpdateTools();\r\n    patchPercentageTool();\r\n    patchCompileTrigger();\r\n    createClipboardDiv();\r\n    addPasteFromPermanentClipboard();\r\n    registerClipboardItemAction();\r\n    patchClipboardFunctions();\r\n    patchDrawGrid();\r\n    patchRender();\r\n    imageFunctions();\r\n\r\n    if(isNative) {\r\n        checkForUpdates();\r\n        changeTopRightText();\r\n    }\r\n\r\n    aleiLog(DEBUG2, \"Settings: \" + JSON.stringify(aleiSettings));\r\n    if(aleiSettings.renderObjectName == false) ALEI_UpdateNameRenderSetting(false);\r\n\r\n    NewNote(\"ALEI: Welcome!\", \"#7777FF\");\r\n    aleiLog(INFO, `Welcome!`);\r\n    if(isNative) {\r\n        aleiLog(INFO, `TamperMonkey Version: ${GM_info.version} ALEI Version: ${GM_info.script.version}`);\r\n    } else {\r\n        let message = \"You are running ALEI not under tampermonkey, this is not native ALEI, please load ALEI by tampermonkey when possible.\";\r\n        NewNote(`ALEI: ${message}`, \"#FFFF00\");\r\n        NewNote(`ALEI: Check https://github.com/LisABC/ALEI for more details.`, \"#FFFF00\");\r\n        aleiLog(INFO, message);\r\n    }\r\n});\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => ALE_start());\r\n"],"names":["isNumber","str","number","isNaN","Number","isOperator","includes","isGroup","operatorOrder","order","calc","x","y","z","result","Math","sin","cos","atan2","floor","random","round","parse","vars","num","i","length","splice","concatNumbers","replaceAll","split","arr","j","from","to","replace","String","PI","negativeNumbers","simpleGroups","chr","convertToObjects","groupOrder","createGroupOrders","removeGroupChars","createOperatorOrders","createOrders","orders","push","getOrders","sort","simplifyOrders","replaceOrders","maxOrder","getMaxOrder","loop","saveOrder","newstr","index","exec","toFixed","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","window","unsafeWindow","isNative","GM_info","$id","id","document","getElementById","$query","selector","querySelector","Hello_IgnoreThisError_ItIsIntentional","ROOT_ELEMENT","documentElement","stylesheets","styleSheets","VAL_TABLE","displayOperationCompleteNotes","REGION_EXECUTE_PARAM_ID","INFO","DEBUG","DEBUG2","WARN","ANSI_RESET","ANSI_RED","ANSI_GREY","ANSI_YELLOW","ANSI_GREEN","ANSI_CYAN","readStorage","defaultValue","func","localStorage","removeItem","aleiSettings","rightPanelSize","val","triggerEditTextSize","starsImage","logLevel","parseInt","showTriggerIDs","enableTooltips","showSameParameters","rematchUID","showIDs","blackTheme","gridBasedOnSnapping","showZIndex","renderObjectNames","textAffectedByZoom","writeStorage","value","e","NewNote","note_bad","console","error","levelToNameMap","aleiLog","level","text","warn","log","JS_setTimeout","setTimeout","JS_eval","eval","ALE_Render","aleiSessionID","aleiSessionList","updateParameters","add","type","name","objType","param_type","param","Array","updateSounds","SVTS","voices","Grosk","drohnentroop","drohnenfem","elurra","ferro","serkova","phantom","entry","entries","character","charVoices","charName","voice","updateVoicePresets","VP","updateStyles","i1","styleSheet","i2","rules","rule","selectorText","style","setProperty","_th","THEME","ThemeSet","THEME_BLUE","updateSkins","charlists","li","charID","paddedCharID","toString","padStart","src","_turnLinkIntoSkinSpan","img_chars_full","Image","ids","keys","map","fetchSkinsFrom","max","async","startingID","requestsRunning","skinsAdded","requestSkin","GM","xmlHttpRequest","url","catch","status","requestBatch","promises","Promise","all","fromID","optimize","f","ms","ani","requestAnimationFrame","_browseImages","BrowseImages","ogImageLists","for_class","current_value","callback","ost","ServerRequest","req","op","ALEI_ServerRequest","then","image_list","innerHTML","updateVehicles","_SVTV","vehicles","vehicle","model","image","img_vehicles","updateGuns","guns","gun","gun_model","gun_name","gun_image","img_guns","updateDecors","img_decors","CACHED_DECORS","decors","decor","decor_model","decor_name","decor_image","CUSTOM_IMAGES_APPROVED","ALEI_decors","updateOffsets","toosc","ThinkOfOffsetClass","tc","esi","offsets","pm","veh_hh","w","h","hakase","off","lo_x","lo_y","lo_w","lo_h","updateTriggers","addTrigger","updateObjects","updateButtons","topPanel","childs","children","setAttribute","appendBack","removeChild","outerHTML","createButton","internalName","onClick","button","createElement","aleiButtonClicks","pad","appendChild","bigPad","exportXML","confirm","fileInput","onchange","files","reader","FileReader","onload","insertXML","remove","readAsText","alert","click","xml","prompt","showSettings","mapid_field","mapid","addClipboardSync","clipboard_channel","BroadcastChannel","onmessage","msg","data","kind","recipient","clip_name","clip_data","sessionStorage","min","session_id","postMessage","ALE_CopyToClipBoard","CopyToClipBoard","addSessionSync","session_channel","indexOf","resolve","addEventListener","event","addPropertyPanelResize","splitter_is_down","splitter","root","position","width","top","height","cursor","right_panel","clientWidth","new_width","clientX","right","updateBoxSplitterSize","splitter_resize","addTriggerIDs","SVTTP","patchShowHideButton","og","ShowHideObjectBox","rparams","heightOffset","true","false","ObjectBox_visible","getBoundingClientRect","addSnappingOptions_helper","newHTML","snappingOptions","snappingIndex","snapping","element","toolClass","GRID_SNAPPING","addRematchUIOptions_helper","evaluate","left_panel","XPathResult","ANY_TYPE","iterateNext","addPreviewNamesOptions_helper","prevElement","headerText","buttonHTML","addButton","_class","onToolUpdate","patchUpdateTools","ut","UpdateTools","tryToNumber","objects","DOMParser","parseFromString","querySelectorAll","object","tagName","eo","E","attributes","es","need_redraw","need_GUIParams_update","exportSelection","download","selected","compi_obj","exists","href","escape","ALEI_CustomSnapping","GridSnappingSet","ALEI_UpdateRematchUIDSetting","ALEI_UpdateNameRenderSetting","ENABLE_TEXT","_ignoredKeys","updateUIDReferences","oldName","newName","properties","splt","item","trim","join","UpdatePhysicalParam","paramname","chvalue","lcz","layer_mismatch","list_changes","elems","MatchLayer","uid","lup","lnd","ldn","_encodeXMLChars","uses_timer","note_passive","note_neutral","lfz","sortObjects","imageContextMap","last_element","last_login","ImageContext","old_name","moderator_menu","awaiting_approval","login","approver","is_fav_menu","preventDefault","image_context","curlogin","left","clientY","display","image_context_cancel_pad","findObjects","exact","notFound","rotateObjects","minX","minY","getSelection","distX","distY","save","RandomizeName","oldname","unoriginal","newname","indof","lastIndexOf","copysuffix","substring","patchRandomizeName","patchAllowedCharacters","allowed_string_chars","getRuleBySelector","setStyle","getObjectBox","bo_x","bo_y","bo_w","bo_h","getSelectionImage","selection","maxX","maxY","box","GRID_ALPHA","SHOW_CONNECTIONS","zoom","zoom_validate","sw","dis_to_x","dis_from_x","sh","dis_to_y","dis_from_y","ConsoleTraceMessages","Render","ctx","getImageData","canvas","ctx2","getContext","canvas2","ctx3","beginPath","putImageData","closePath","prevW","prevH","divide","scale","drawImage","toDataURL","createClipboardDiv","clipboardDiv","mrdimlights","className","body","append","clipboardItemAction","items","JSON","clipboardItems","stringify","updateClipboardDiv","registerClipboardItemAction","html","originalES","cs","theme","grid_opacity","showConnections","dtx","dty","dfx","dfy","ctm","__pasteObjectClipboard","permanent_clipboard","PasteFromClipBoard","pasteFromPermanentClipboard","copyToPermanentClipboard","err","changeTopRightText","containerElem","elem","childNodes","script","version","a","b","__zIndex","addDecorButtons","getImageSize_button","centerDecorationX_button","centerDecorationY_button","getImageSize","m","img","onerror","slice","res","arrMin","Infinity","arrMax","getImagePosition","arrX","arrY","centerX","centerY","setDecorOffset","u","v","centerImageX","centerImageY","imageFunctions","aleiContextRenameImage","CloseImageContext","last_for_class","aleiContextDeleteImage","opacity","newUpdate","targetElement","doTooltip","tooltip","fontSize","fontFamily","color","backgroundColor","padding","borderRadius","wordBreak","target","title","dataset","parentElement","leftOffset","patchDecorUpload","imageLoader","removeEventListener","handleImage","file","setParameter","rightParams","areObjectsOfSameType","same","removeSameItems","array","Set","removeItems","copy","parameterNamesToIndexes","parameters","objectParameters","indexes","getSameParameters","differentParameters","toBoolean","Boolean","fixIndex","objectType","fixedIndex","ctrlKey","code","getElementsByClassName","isOnlyTriggerSelected","isNothingSelected","reverseTriggerActions","unselectTriggerActions","canvas_focus","altKey","str1","str2","expression","toLowerCase","parsed","shiftKey","wnd","onblur","close","onfocus","location","reload","open","parameterMap","fixParameterValue","fixedValue","setSameParameters","assignObjectIDs","idmap","aleiID","assignZIndex","patchANI","oldAni","ngpu","rect","splitter2","bottom","addObjBoxResize","splitterClicking","onmousedown","new_height","patch_m_down","og_mdown","m_down","previousEsLength","_isresizable","UpdateGUIObjectsList","patchEntityClass","og_E","attach","fromEntries","fixPos","ClipName","clipboard","unserialize","min_x","max_x","min_y","max_y","from_obj","newparam","ldis","paint_draw_mode","quick_pick_ignore_one_click","lmdrwa","lmwa","lmdrwb","lmwb","m_pos_x","m_pos_y","m_drag_x","mouse_x","m_drag_y","mouse_y","m_down_x","m_down_y","x1","y1","old_uid","i3","_isphysical","ServerRequest_handleMapData","mapCode","objectKeyValueRegex","objectCreationRegex","expressions","currentElement","rights","maprights","note_good","creation","matchKeyValue","parseFloat","handleServerRequestResponse","request","operation","response","knownmaps","match","makeRequest","method","reject","xhr","XMLHttpRequest","setRequestHeader","this","statusText","send","updateDecorList","list_native","request_a","changes_made","ClearUndos","_serverRequestPatched","patchServerRequest","patchUpdateGUIParams","UpdateGUIParams","origUGP","origGPV","GenParamVal","GenParamValEscapeDoubleQuotes","base","shouldAddSeparatorInGUIParams","startSeparatorFrom","zIndexSave","shouldDisplayID","shouldDisplayZIndex","__id","shift","patchEvalSet","EvalSet","createALEISettingsMenu","mainWindow","aleiStyles","addText","requiresRestart","div","registerButton","general","values","aleiSettingButtonsMap","identifier","addBinaryOption","truthyVal","falsyVal","storage","_apply","logApply","head","removed","ALEI_settingsMenu","ALEI_settingUpdateButtons","dim_undo","patchTeamList","teamID","teamName","addProjectileModels","projectileModels","patchSpecialValue","_OG","special_value","returning","ERROR_VALUE","notifyUpdate","notifyIfTheresUpdate","lines","line","parts","verParts","currentVerParts","smallestLength","checkForUpdates","updateURL","responseText","ALEI_DoWorldScale","newscale","factor","snappingScript","roundwell","patchPercentageTool","DoWorldScale","patchCompileTrigger","_og","CompileTrigger","addPasteFromPermanentClipboard","identity","currentVal","selectedTriggerActions","hoveredTriggerAction","triggerActionsClipboard","getTriggerActionElements","addEventListeners","updateTriggerActionElements","onmouseenter","onmouseleave","getTriggerActions","edit_triggers_as_text","copyTriggerActions","actions","isOnlyOneTriggerActionSelected","getSelectedTriggerAction","getTriggerInfo","pasteTriggerActions","info","concat","deleteTriggerActions","actions1","actions2","reverse","action","triggerActionsPreventError","patchClipboardFunctions","old_CopyToClipBoard","old_PasteFromClipBoard","old_DeleteSelection","DeleteSelection","old_UpdateGUIParams","old_DO_UNDO","DO_UNDO","old_DO_REDO","DO_REDO","patchDrawGrid","old_lg","lg","param1","param2","patchNewNote","old","zoomedTextScaleMultiply","ALEI_renderObjectNameText","centerx","centery","dim","textScale","translate","fillText","patchRender","oldCodeSnippet","newCodeSnippet","ALE_start","special_values_table","renderObjectName","message"],"sourceRoot":""}